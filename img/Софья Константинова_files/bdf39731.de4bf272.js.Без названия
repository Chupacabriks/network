"use strict";(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[2276],{551859:(t,e,i)=>{function o(){return{icon:'<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><g id="user_outline_20__Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="user_outline_20__Icons-20/user_outline_20"><g id="user_outline_20__user_outline_20"><path opacity=".1" d="M0 0h20v20H0z"/><path d="M12.5 5a2.5 2.5 0 1 0-5 0 2.5 2.5 0 0 0 5 0ZM14 5a4 4 0 1 1-8 0 4 4 0 0 1 8 0ZM4 15.5c0 .72.36 1 1 1h10c.64 0 1-.28 1-1 0-2.33-2.57-3.5-6-3.5s-6 1.17-6 3.5Zm-1.5 0c0-3.48 3.33-5 7.5-5s7.5 1.52 7.5 5c0 1.63-1.1 2.5-2.5 2.5H5c-1.4 0-2.5-.87-2.5-2.5Z" id="user_outline_20__Icon-Color" fill="currentColor" fill-rule="nonzero"/></g></g></g></svg>',name:"user_outline_20"}}i.d(e,{getIcon20UserOutline:()=>o})},649e3:(t,e,i)=>{function o(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M12.73 11.48a.75.75 0 0 1 .94-.5 7.26 7.26 0 0 1 1.64.71 4.22 4.22 0 0 1 2.15 3.2.75.75 0 0 1-1.49.19 2.72 2.72 0 0 0-1.43-2.1 5.76 5.76 0 0 0-1.3-.56.75.75 0 0 1-.5-.94ZM6 5a4 4 0 1 1 4 4 .75.75 0 0 1 0-1.5A2.5 2.5 0 1 0 7.5 5 .75.75 0 0 1 6 5ZM3.22 17.36c.45.42 1.08.64 1.78.64h9.44l.78.78a.75.75 0 1 0 1.06-1.06L3.78 5.22a.75.75 0 0 0-1.06 1.06l4.48 4.48c-.95.2-1.8.5-2.51.93A4.23 4.23 0 0 0 2.5 15.5c0 .81.27 1.44.72 1.86Zm2.24-4.38A2.74 2.74 0 0 0 4 15.5c0 .46.14.67.25.77.12.11.35.23.75.23h7.94l-4.42-4.42c-1.27.13-2.31.45-3.06.9Z" clip-rule="evenodd"/></svg>',name:"user_slash_outline_20"}}i.d(e,{getIcon20UserSlashOutline:()=>o})},335700:(t,e,i)=>{i.r(e),i.d(e,{UIGallery:()=>h,UI_GALLERY_CLASSNAME:()=>c.UI_GALLERY_CLASSNAME,UI_GALLERY_CONTENT_CLASSNAME:()=>c.UI_GALLERY_CONTENT_CLASSNAME,UI_GALLERY_INNER_CLASSNAME:()=>c.UI_GALLERY_INNER_CLASSNAME,uiGetGallery:()=>d});var o=i(558137),s=i(898848),n=i(939646),l=i(972332),r=i(593159),a=i(754866),c=i(15614);const _=(0,o.makeSharedState)("ui-gallery",(()=>({galleries:{},incIndex:0})),{version:0});function d(t){const e=(0,a.domData)((0,a.ge)(t),"gallery-id");return e&&_().galleries[e]}class h{_checkSizesAndUpdate(){return 0!==this._width&&0!==this._itemWidth||(this._width=Math.round((0,a.getSize)(this._el)[0]),this._itemWidth=(0,a.getSize)(this._items[0])[0],this._itemFullWidth=this._itemWidth+this._itemOffset),!(0===this._width||0===this._itemWidth)}_initScroll(){(this._opts.scrollX||this._opts.scrollY)&&(this._opts.isModernTransitionsEnabled||(0,l.addEvent)(this._innerCont,"DOMMouseScroll wheel",this._onWheelScroll.bind(this)))}_initArrows(){this._opts.noArrows?(0,a.addClass)(this._el,"ui_gallery_no_arrows"):(this._leftArrow=(0,a.geByClass1)("ui_gallery__arrow_left",this._el),this._rightArrow=(0,a.geByClass1)("ui_gallery__arrow_right",this._el),this._arrowWidth=(0,a.getSize)(this._leftArrow)[0],this._opts.isModernTransitionsEnabled?((0,l.addEvent)(this._leftArrow,"click",this._slide.bind(this,-1,void 0,{eventName:"arrow"})),(0,l.addEvent)(this._rightArrow,"click",this._slide.bind(this,1,void 0,{eventName:"arrow"}))):((0,l.addEvent)(this._leftArrow,"click",this._legacySlide.bind(this,-1,void 0,{eventName:"arrow"})),(0,l.addEvent)(this._rightArrow,"click",this._legacySlide.bind(this,1,void 0,{eventName:"arrow"}))),(0,l.addEvent)(this._leftArrow,"mouseover",this._onArrowMouseOver.bind(this,"left")),(0,l.addEvent)(this._leftArrow,"mouseout",this._onArrowMouseOut.bind(this)),(0,l.addEvent)(this._rightArrow,"mouseover",this._onArrowMouseOver.bind(this,"right")),(0,l.addEvent)(this._rightArrow,"mouseout",this._onArrowMouseOut.bind(this)))}_onWheelScroll(t){let e;if("wheel"==t.type)if(Math.abs(t.deltaY)>Math.abs(t.deltaX)){if(!this._opts.scrollY)return;e=-t.deltaY}else{if(!this._opts.scrollX)return;e=-t.deltaX}else if(void 0!==t.wheelDeltaY){if(!this._opts.scrollY)return;e=t.wheelDeltaY}else if(void 0!==t.wheelDelta)e=t.wheelDelta;else{if(!t.detail||1!==t.axis)return;e=-t.detail}e=this._scroll.rtlSame?-e:e,Math.abs(e)>=120&&(e=74*Math.max(-1,Math.min(1,e))),this._innerCont.scrollLeft-=e,this._checkItemsAfterScroll(this._innerCont.scrollLeft),(0,l.cancelEvent)(t)}_getScrollParams(){this._opts.shouldCheckGalleryViewed&&this._checkSizesAndUpdate();const t=this._width-2*this._arrowWidth,e=this._itemFullWidth>t;return{isItemBiggerThanWidth:e,scrollDistance:e?this._itemFullWidth:t}}_legacySlide(t,e,i){const{scrollDistance:o,isItemBiggerThanWidth:s}=this._getScrollParams();let r=this._innerCont.scrollLeft+(this._scroll.rtlSame?-t:t)*o;const c=this._innerCont.scrollWidth-this._width;this._scroll.negative?(r=Math.min(r,0),r=Math.abs(r)):r=Math.max(0,r),r=Math.min(c,r);const _=this._scroll.negative||this._scroll.rtlSame?-t:t;if(_>0&&r<c){r=Math.floor(r/this._itemFullWidth)*this._itemFullWidth}else if(_<0&&r>0){r=(s?Math.ceil(r/this._itemFullWidth):Math.floor(r/this._itemFullWidth))*this._itemFullWidth}if(this._opts.isFullSizeSlide&&(r=(this._visible.left+t)*this._itemFullWidth),0===r||r===c){const e=this._innerCont.scrollWidth;(0,a.addClass)(this._inner,"ui_gallery__inner_shift_instant"),this._onArrowMouseOut(),r&&(r+=t*(this._innerCont.scrollWidth-e))}this._scroll.negative&&(r=-r),(0,n.animate)(this._innerCont,{scrollLeft:r},{duration:Math.abs(this._innerCont.scrollLeft-r)+50,transition:n.Fx.Transitions.easeOutCubic}),this._checkItemsAfterScroll(r),setTimeout((()=>(0,a.removeClass)(this._inner,"ui_gallery__inner_shift_instant")),0),this._opts?.onSlide?.(t,{eventName:i?.eventName}),e&&(0,l.cancelEvent)(e)}_updateShift(t){let e=this._shift+t;const i=this._inner.scrollWidth-this._inner.clientWidth;e>i&&(e=i),e<0&&(e=0),this._shift=e}_slide(t,e,i){const{scrollDistance:o}=this._getScrollParams();this._updateShift(t*o),this._inner.style.transform=`translate3d(${-1*this._shift}px, 0, 0)`,this._checkItemsAfterScroll(this._shift),this._opts?.onSlide?.(t,{eventName:i?.eventName}),e&&(0,l.cancelEvent)(e)}_checkItemsAfterScroll(t,e){if(this._scroll.negative&&(t=Math.abs(t)),(!this._opts.shouldCheckGalleryViewed||this._visible.isGalleryViewed)&&(!this._opts.shouldCheckGalleryViewed||this._checkSizesAndUpdate())){if(this._opts.markOutside||this._opts.onViewItem){const i=this._itemWidth/3,o=(this._scroll.backward?this._inner.scrollWidth-this._width-t:t)-this._scrollOffset,s=t&&Math.floor(o/this._itemFullWidth),n=s*this._itemFullWidth+2*i;let l;l=this._scroll.backward?t+this._width<this._inner.scrollWidth-n:t>n;const c=Math.min(this._items.length-1,Math.floor((o+this._width)/this._itemFullWidth)),_=c*this._itemFullWidth+2*i;let d;if(d=this._scroll.backward?t>this._inner.scrollWidth-_:t+this._width<_,this._opts.onViewItem){const t=l?Math.min(this._items.length-1,s+1):s,i=d?Math.max(0,c-1):c;if(e||t!==this._visible.left||i!==this._visible.right){for(let o=t;o<=i;o++)(this._visible.left<0||e&&!(0,r.inArray)(this._items[o],this._visible.items)||o<this._visible.left||o>this._visible.right)&&this._opts.onViewItem(this._items[o],o);this._visible.left=t,this._visible.right=i,this._visible.items=this._items.slice(t,i+1)}}this._opts.markOutside&&(e?((0,a.geByClass)("ui_gallery_item_outside",this._inner).forEach((t=>{(0,a.removeClass)(t,"ui_gallery_item_outside")})),this._outside.left=-1,this._outside.right=-1):((s!==this._outside.left||!l)&&this._outside.left>=0&&((0,a.removeClass)(this._items[this._outside.left],"ui_gallery_item_outside"),this._outside.left=-1),(c!==this._outside.right||!d)&&this._outside.right>=0&&((0,a.removeClass)(this._items[this._outside.right],"ui_gallery_item_outside"),this._outside.right=-1)),l&&s!==this._outside.left&&((0,a.addClass)(this._items[s],"ui_gallery_item_outside"),this._outside.left=s),d&&c!==this._outside.right&&((0,a.addClass)(this._items[c],"ui_gallery_item_outside"),this._outside.right=c))}if(!this._opts.noArrows){const e=t>0,i=t+this._width<this._inner.scrollWidth;(0,a.toggleClass)(this._leftArrow,"ui_gallery__arrow_visible",this._scroll.rtl&&!this._scroll.backward?i:e),(0,a.toggleClass)(this._rightArrow,"ui_gallery__arrow_visible",this._scroll.rtl&&!this._scroll.backward?e:i)}(!this._scroll.backward&&this._inner.scrollWidth-t-this._width<1e3||this._scroll.backward&&t<1e3)&&this._onLoadMore()}}_onArrowMouseOver(t){this._inner.classList.add(`ui_gallery__inner_shift_${t}`)}_onArrowMouseOut(){this._inner.classList.remove("ui_gallery__inner_shift_left"),this._inner.classList.remove("ui_gallery__inner_shift_right")}_onLoadMore(){!this._opts.onLoadMore||this._loadingMore||this._finised||(this._loadingMore=!0,this._opts.onLoadMore(this._items.length))}addMore(t,e){t=t||[],this.addItems(t),this._finised=!!e||!t.length,this._loadingMore=!1}addItems(t,e){if((t=t||[]).length){const i=e>=0&&e<this._items.length?this._items[e]:null;t.forEach((t=>{i?(0,a.domInsertBefore)(t,i):this._inner.appendChild(t)})),this.refresh()}}destroy(){(0,l.removeEvent)(this._innerCont),(0,l.removeEvent)(this._leftArrow),(0,l.removeEvent)(this._rightArrow),(0,a.domData)(this._el,"gallery-id",null),delete _().galleries[this._id],this._opts.onDestroy&&this._opts.onDestroy(),(0,a.re)(this._el)}removeItem(t){return(0,s.isNumeric)(t)&&(t=this._items[t]),!(!t||!(0,r.inArray)(t,this._items))&&((0,a.re)(t),this.refresh(),this._items.length||this.destroy(),!0)}refresh(){this._width=Math.round((0,a.getSize)(this._el)[0]),this._items=(0,a.geByClass)("ui_gallery_item",this._el),this._checkItemsAfterScroll(this._innerCont.scrollLeft,!0)}scrollToDirection(t){this._opts.isModernTransitionsEnabled?this._slide(t,void 0,{eventName:"bullet"}):this._legacySlide(t,void 0,{eventName:"bullet"})}getItems(){return this._items}getVisibleItems(){return this._visible.items.map(((t,e)=>[t,this._visible.left+e]))}setGalleryViewed(){this._visible.isGalleryViewed=!0,this._checkItemsAfterScroll(this._innerCont.scrollLeft)}constructor(t,e){if(!t)throw new Error("No element was provided for UIGallery");if(!(t=(0,a.ge)(t)).classList.contains(c.UI_GALLERY_CLASSNAME))throw new Error("Provided incorrect element for UIGallery");const i=d(t);if(i)return i;this._opts=(0,r.extend)({markOutside:!1,scrollY:!0,scrollX:!0,noArrows:!1,isFullSizeSlide:!1,isModernTransitionsEnabled:!1},e),this._id=_().incIndex,_().incIndex+=1,this._el=t,this._width=Math.round((0,a.getSize)(this._el)[0]),this._items=(0,a.geByClass)("ui_gallery_item",this._el),this._itemWidth=(0,a.getSize)(this._items[0])[0],this._itemOffset=(0,r.intval)((0,a.getStyle)(this._items[0],vk.rtl?"marginLeft":"marginRight")),this._scrollOffset=(0,r.intval)((0,a.getStyle)(this._items[0],"marginLeft")),this._itemFullWidth=this._itemWidth+this._itemOffset,this._innerCont=(0,a.geByClass1)(c.UI_GALLERY_CONTENT_CLASSNAME,this._el),this._inner=(0,a.geByClass1)(c.UI_GALLERY_INNER_CLASSNAME,this._el),this._opts.isModernTransitionsEnabled&&(this._shift=0,this._inner.classList.add("ui_gallery__inner--withTransitions")),this._scroll=function(){const t={rtl:!1,backward:!1,delta:1,negative:!1,rtlSame:!1};if(!vk.rtl)return t;if(!cur._scrollInfo){const e=(0,a.se)('<div style="position: fixed; left: -1000px; width: 0; overflow: scroll">x</div>'),i=document.querySelector("#content");i?.appendChild(e);const o=e.scrollLeft;t.rtl=vk.rtl,t.backward=o>0,e.scrollLeft=1e3,t.delta=e.scrollLeft===o?-1:1,t.negative=!t.backward&&t.delta<0,t.rtlSame=t.rtl&&!t.backward&&!t.negative,(0,a.re)(e),cur._scrollInfo=t}return cur._scrollInfo}(),this._loadingMore=!1,this._finised=!1,this._visible={left:-1,right:-1,items:[],isGalleryViewed:!1},this._outside={left:-1,right:-1,timer:null},this._initScroll(),this._initArrows(),(0,a.domData)(this._el,"gallery-id",this._id),_().galleries[this._id]=this,this._checkItemsAfterScroll(this._innerCont.scrollLeft,!0)}}},586520:(t,e,i)=>{i.d(e,{EVENT_REPLY_FIELD_IS_NFT_INDEX:()=>r,EVENT_REPLY_FIELD_IS_POST_AUTHOR_INDEX:()=>a,MIN_NFT_IMAGE_SIZE:()=>s,REPLY_IMAGE_DEFAULT_SIZE:()=>n,REPLY_IMAGE_SMALL_SIZE:()=>l,VISIBILITY_ACCESS_OPTIONS:()=>o});const o={PUBLIC:0,ONLY_FRIENDS:1,ONLY_BEST_FRIENDS:2},s=29,n=34,l=24,r=16,a=17},821834:(t,e,i)=>{var o,s,n,l,r,a,c,_,d,h;i.d(e,{AddAttachmentEventType:()=>l,AttachmentType:()=>o,POSTING_STATS_NAMES:()=>u,PostingNavScreen:()=>d,SettingsEventType:()=>r}),function(t){t.GeoPlace="geo_place",t.PhotosList="photos_list",t.Group="group",t.PostedPhoto="posted_photo",t.Goods="goods",t.Mask="mask",t.VideoPlaylist="video_playlist",t.Video="video",t.TextpostPublish="textpost_publish",t.Textpost="textpost",t.Textlive="textlive",t.SituationalTheme="situational_theme",t.PrettyCards="pretty_cards",t.Poll="poll",t.Podcast="podcast",t.Photo="photo",t.Page="page",t.Note="note",t.Narrative="narrative",t.MarketAlbum="market_album",t.Market="market",t.Link="link",t.Graffiti="graffiti",t.Geo="geo",t.DonutLink="donut_link",t.Doc="doc",t.Curator="curator",t.AudioPlaylist="audio_playlist",t.Audio="audio",t.Artist="artist",t.Article="article",t.PhotoAlbum="photo_album",t.OnlineBooking="online_booking"}(o||(o={})),function(t){t.Open="open",t.Close="close",t.ClickToStoryIcon="click_to_story_icon",t.ClickToClipIcon="click_to_clip_icon",t.ClickToLiveIcon="click_to_live_icon",t.ClickToGalleryIcon="click_to_gallery_icon",t.OpenPostingFromPlus="open_posting_from_plus",t.ClosePostingFromPlus="close_posting_from_plus",t.ClickToPlus="click_to_plus",t.ClickToMore="click_to_more",t.ClickToTextlive="click_to_textlive",t.ClickToLive="click_to_live",t.ClickToGallery="click_to_gallery",t.ClickToStory="click_to_story",t.ClickToClip="click_to_clip",t.EditPublishedPost="edit_published_post",t.EditPostponedPost="edit_postponed_post"}(s||(s={})),function(t){t.OpenMusic="open_music",t.OpenMyPhoto="open_my_photo",t.OpenAlbum="open_album",t.OpenMarksAll="open_marks_all",t.OpenMyVideo="open_my_video",t.OpenPlaylists="open_playlists",t.OpenDoc="open_doc",t.OpenPoll="open_poll",t.OpenProduct="open_product",t.OpenPlace="open_place",t.SelectPhotoCard="select_photo_card",t.OpenService="open_service",t.SelectionModeProfile="selection_mode_profile",t.SelectionModeCommunity="selection_mode_community",t.ClickToArticle="click_to_article"}(n||(n={})),function(t){t.DeleteAttach="delete_attach",t.AttachPhoto="attach_photo",t.AttachVideo="attach_video",t.AttachMusic="attach_music",t.AttachMyPhoto="attach_my_photo",t.AttachMyVideo="attach_my_video",t.AttachPlaylists="attach_playlists",t.AttachDoc="attach_doc",t.AttachPoll="attach_poll",t.AttachProduct="attach_product",t.AttachAlbum="attach_album",t.AttachArticle="attach_article",t.AttachPlace="attach_place"}(l||(l={})),function(t){t.Zoom="zoom",t.RatioChange="ratio_change",t.SelectAuthor="select_author",t.ChangeAuthor="change_author",t.ChangePrivacy="change_privacy",t.SelectPostponed="select_postponed",t.ChangePostponed="change_postponed",t.SelectSubjects="select_subjects",t.ChangeSubjects="change_subjects",t.OpenSettings="open_settings",t.CreateCopyright="create_copyright",t.AttachCopyright="attach_copyright",t.TurnOnNotifications="turn_on_notifications",t.TurnOffNotifications="turn_off_notifications",t.AdTurnOn="ad_turn_on",t.AdTurnOff="ad_turn_off",t.ShowDonsOnly="show_dons_only",t.ShowAll="show_all",t.DonsPostLifetimeChange="dons_post_lifetime_change"}(r||(r={})),function(t){t.ClickToMentionSuggest="click_to_mention_suggest"}(a||(a={})),function(t){t.OpenPoster="open_poster",t.ClosePoster="close_poster",t.SelectBackground="select_background",t.OpenPosterCustom="open_poster_custom",t.AddCustomBackground="add_custom_background",t.SelectCustomBackground="select_custom_background",t.SaveCustomBackground="save_custom_background"}(c||(c={})),function(t){t.SelectFriendFromSearch="select_friend_from_search",t.SelectChatFromSearch="select_chat_from_search",t.SelectBestFreinds="select_best_freinds",t.SaveBestFriendsList="save_best_friends_list",t.MoreChats="more_chats",t.EditBestFriendsFromPopup="edit_best_friends_from_popup",t.EditBestFriends="edit_best_friends",t.CreatePostFromPopupFriends="create_post_from_popup_friends",t.CreatePostFromPopupBest="create_post_from_popup_best",t.ClickToLockFriends="click_to_lock_friends",t.ClickToLockBestFriends="click_to_lock_best_friends",t.ClickToBestFriendsEntrypoint="click_to_best_friends_entrypoint",t.Clear="clear",t.AddFriendsFromChat="add_friends_from_chat",t.UpdatePopupSave="update_popup_save",t.UpdatePopupCancel="update_popup_cancel"}(_||(_={})),function(t){t.Profile="profile",t.Feed="feed",t.Community="community",t.Posting="posting",t.PostingAttachPhoto="posting_attach_photo",t.PostingAttachPhotoProfile="posting_attach_photo_profile",t.PostingAttachPhotoCommunity="posting_attach_photo_community",t.PostingAttachMusic="posting_attach_music",t.PostingAttachVideo="posting_attach_video",t.PostingAttachVideoProfile="posting_attach_video_profile",t.PostingAttachVideoCommunity="posting_attach_video_community",t.PostingAttachDocument="posting_attach_document",t.PostingAttachPlace="posting_attach_place",t.PostingAttachPlaylist="posting_attach_playlist",t.PostingAttachPoll="posting_attach_poll",t.PostingAttachGood="posting_attach_good",t.PostingAttachArticle="posting_attach_article",t.PostingAttachArticleProfile="posting_attach_article_profile",t.PostingAttachArticleCommunity="posting_attach_article_community",t.PostingAttachAlbum="posting_attach_album",t.PostingAttachAlbumProfile="posting_attach_album_profile",t.PostingAttachAlbumCommunity="posting_attach_album_community",t.PostingSettings="posting_settings",t.POSTINGTIMEDIALOG="POSTING_TIME_DIALOG",t.PostingCreateCustomPoster="posting_create_custom_poster",t.PostingCloseFriendsSelector="posting_close_friends_selector"}(d||(d={})),function(t){t.GridMode="grid_mode",t.CarouselMode="carousel_mode",t.ChangeAttachOrder="change_attach_order"}(h||(h={}));const u={POSTING_INIT:"posting_init",UPLOAD_VIDEO_BY_LINK:"upload_video_by_link",CLOSE_ADD_PHOTO:"close_add_photo",CLOSE_ADD_VIDEO:"close_add_video",UPLOAD_PHOTO:"upload_photo",ATTACH_PHOTO:"attach_photo",ATTACH_ALBUM:"attach_album",SHOW_ALBUM:"show_albums",UPLOAD_VIDEO:"upload_video",ATTACH_VIDEO:"attach_video",CLOSE_MUSIC:"close_music",OPEN_MY_PHOTO:"open_my_photo",OPEN_MY_VIDEO:"open_my_video",OPEN_MUSIC:"open_music",ATTACH_MUSIC:"attach_music",ADD_ARTICLE:"add_article",ADD_CLIP:"add_clip",ADD_FILE:"add_file",UPLOAD_FILE:"upload_file",ADD_MAP:"add_map",ADD_PRODUCT:"add_product",ADD_SURVEY:"add_survey"}},58752:(t,e,i)=>{i.d(e,{PostingItemStatCollector:()=>n});var o=i(317216),s=i(314309);class n{logEvent(t){const e={type:o.ClickProductionStatEventTypes.TYPE_POSTING_ITEM,[o.ClickProductionStatEventTypes.TYPE_POSTING_ITEM]:t},i={type:o.EventItemType.POST};this.clickStatCollector.logEvent(e,i)}constructor(){this.productStatCollector=new s.ProductionStatCollector,this.clickStatCollector=new s.ClickStatCollector(this.productStatCollector)}}},859103:(t,e,i)=>{i.d(e,{getPrimaryCarouselGallery:()=>s});var o=i(335700);function s(t){const e=t.closest(`.${o.UI_GALLERY_CLASSNAME}`);if(!e)return;const i=(0,o.uiGetGallery)(e);return i||void 0}},157281:(t,e,i)=>{i.d(e,{AttachmentsViewSelector:()=>_});var o=i(318227),s=i(972332),n=i(723294),l=i(587258),r=i(58752),a=i(8520);const c=new r.PostingItemStatCollector;class _{setMediaSelectedValue(t){this.addMedia.setAttachView(t)}createTooltip(){const t=this.selectorEl.querySelector(".post_action_tt_content"),e=this.selectorEl.querySelector(".post_action_btn_layout");if(!t||!e)return;const i=(0,o.createPostTooltip)(n.ACTION_BUTTON_ID,this.linkId,void 0,{customShow:!0})?.toooltip;return i&&((0,s.addEvent)(e,"click",(()=>{this._isEnabled&&i.toggle()})),this.selectorEl.querySelectorAll(".radiobtn").forEach((t=>{(0,s.addEvent)(t,"click",this.handleOptionClick.bind(this))}))),i}handleOptionClick(t){if(!(t.currentTarget instanceof HTMLElement))return;const e=t.currentTarget.getAttribute("data-value");if(this.tooltip?.hide(),e){this.setMediaSelectedValue(e),this.selectOption(e);const t=l.ATTACH_VIEW_EVENTS[e];t&&c.logEvent({primary_mode_event:{primary_mode_event_type:t}})}}updateTooltipRadioBtn(t,e){(0,o.updatePostTooltipActionRadioBtn)(t,e,`post_settings_btn${n.ACTION_BUTTON_ID}${this.linkId}`)}updateActionButtonText(t,e){if(e){const i=(0,a.decodeHTMLEntities)(e);t.innerHTML=i,t.setAttribute("aria-label",i)}}selectOption(t){const e=this.selectorEl.querySelector(`[data-value="${t}"]`),i=this.selectorEl.querySelector(".post_action_btn_text");if(!(e instanceof HTMLElement&&i instanceof HTMLElement))return;this.updateTooltipRadioBtn(e,t);const o=e.getAttribute("aria-label")||"";this.updateActionButtonText(i,o)}isHidden(){return this._isHidden}setVisibility(t){let e=t;this._forceHidden&&(e=!1),this.selectorEl.style.display=e?"":"none",this._isHidden=!t}isEnabled(){return this._isEnabled}setEnabled(t){t?this.selectorEl.classList.remove(n.ACTION_BUTTON_DISABLED):this.selectorEl.classList.add(n.ACTION_BUTTON_DISABLED),this._isEnabled=t}constructor(t,e,i,o,s={isHidden:!0,isEnabled:!1,forceHidden:!1}){this.linkId=e,this.selectorEl=i,this.tooltip=this.createTooltip(),this.addMedia=t,this._forceHidden=s.forceHidden,this.selectOption(o),this.setVisibility(!s.isHidden),this.setEnabled(s.isEnabled),this.setMediaSelectedValue(o)}}},926812:(t,e,i)=>{i.d(e,{initAttachmentsViewSelector:()=>r});var o=i(157281),s=i(644742),n=i(540462),l=i(723294);const r=({linkId:t,postActionsEl:e,addMedia:i,initValue:r,isGridOnly:a,isCarouselOnly:c})=>{if(!(e instanceof HTMLElement))return;const _=(0,s.renderTemplate)("primary_attachments_view_template",{link_id:t});if(!_)return;const d=e.querySelector(".post_postpone")||e.querySelector(".PostDonutDuration")||e.querySelector(".post_available");d?d.parentNode?.insertBefore(_,d.nextSibling):e.insertBefore(_,e.firstChild);const h=new o.AttachmentsViewSelector(i,t,_,r??(0,s.getAttachmentsPrimaryModeDefaultValue)(),{isHidden:!0,isEnabled:!1,forceHidden:Boolean(a||c)}),u=t=>{t?(h.setVisibility(!0),h.setEnabled(!0)):h.setVisibility(!1)};return u(i.getMediaUIViewSelectorAvailable()),i.emitter.on(i.eventTypes.previewUpdate,u),i.emitter.on(i.eventTypes.viewDraw,u),{setOption:t=>{h.selectOption(t)},onClear:()=>{h.setVisibility(!1),(0,n.partConfigEnabled)("attachments_primary_mode_web_carousel_force_default")&&h.selectOption(l.ATTACHMENT_PRIMARY_MODE.carousel)}}}},644742:(t,e,i)=>{i.d(e,{getAttachmentsPrimaryModeDefaultValue:()=>p,getAttachmentsPrimaryModeParam:()=>_,renderTemplate:()=>c,saveAttachmentsPrimaryModeDefaultValue:()=>u});var o=i(723294),s=i(593159),n=i(754866),l=i(469004),r=i(540462),a=i(700230);const c=(t,e)=>{const i=(0,s.getTemplate)(t,e);return i?(0,n.se)(i):null},_=t=>{const e=document.getElementById(`${o.ACTION_BUTTON_ID}${t}`);if(e?.classList.contains(o.ACTION_BUTTON_DISABLED))return;const i=e?.querySelector(".radiobtn.on")?.getAttribute("data-value");return i?{primary_attachments_mode:i}:void 0},d="posting_attachments_primary_mode_default_value",h=()=>`${d}_${window.vk.id}`,u=t=>{(0,r.partConfigEnabled)("content_multiaccount_web_feature")?l.ls.set(h(),t):l.ls.set(d,t)},p=t=>{if((0,r.partConfigEnabled)("attachments_primary_mode_web_carousel_force_default"))return o.ATTACHMENT_PRIMARY_MODE.carousel;if(t?.isCarouselOnly)return o.ATTACHMENT_PRIMARY_MODE.carousel;if(t?.isGridOnly)return o.ATTACHMENT_PRIMARY_MODE.grid;const e=(0,r.partConfigEnabled)("attachments_primary_mode_web_carousel_default_feature")||(0,a.isCarouselCropEnabled)()?o.ATTACHMENT_PRIMARY_MODE.carousel:o.ATTACHMENT_PRIMARY_MODE.grid;let i;return i=(0,r.partConfigEnabled)("content_multiaccount_web_feature")?l.ls.get(h())??l.ls.get(d)??e:l.ls.get(d)??e,o.ATTACHMENT_PRIMARY_MODE[i]??e}},272556:(t,e,i)=>{i.d(e,{getPostTopicSelectorParams:()=>s.getPostTopicSelectorParams,initPostTopicCreatingSelector:()=>c,initPostTopicEditingSelector:()=>_,isPostTopicEditingEnabled:()=>s.isPostTopicEditingEnabled,isPostTopicSettingEnabled:()=>s.isPostTopicSettingEnabled,topicUISelectorHide:()=>r.topicUISelectorHide});var o=i(525179),s=i(359813),n=i(974189),l=i(898e3),r=i(337249);const a=(t,e,i,s)=>{const r=o.TopicUISelector.create(e,{linkId:t,selectTopicId:n.selectTopicId});if(r)return(0,n.initActionsParamsState)(t,r,s),r.selectTopicId(i[l.WallPostParams.topicId]),{clearSelection:()=>{r.clearSelection()},onDestroy:()=>{r.destroy()}}},c=(t,e,i)=>a(t,e,{[l.WallPostParams.topicId]:s.TOPIC_ID_NONE},i),_=(t,e,i,o)=>a(t,e,{[l.WallPostParams.topicId]:i[l.WallPostParams.topicId]??s.TOPIC_ID_NONE},o)},898e3:(t,e,i)=>{var o;i.d(e,{WallPostParams:()=>o}),function(t){t.topicId="topic_id"}(o||(o={}))},974189:(t,e,i)=>{i.d(e,{getActionParams:()=>r,getSelectorRegistry:()=>n,initActionsParamsState:()=>l,selectTopicId:()=>c});var o=i(898e3);let s=new Map;const n=t=>s.get(t),l=(t,e,i)=>((t,e)=>s.set(t,e))(t,{actionParams:void 0,selector:e,onChange:i}),r=t=>s.get(t)?.actionParams,a=(t,e)=>{((t,e)=>{const i=s.get(t);void 0!==i&&s.set(t,e(i))})(t,(t=>(t?.onChange&&t.onChange(e?.topic_id),{...t,actionParams:e})))},c=(t,e)=>{a(t,{[o.WallPostParams.topicId]:e})}},359813:(t,e,i)=>{i.d(e,{TOPIC_ID_NONE:()=>n,getPostTopicSelectorParams:()=>l,isPostTopicEditingEnabled:()=>a,isPostTopicSettingEnabled:()=>r});var o=i(898e3),s=i(974189);const n=-1,l=t=>{const e=(0,s.getActionParams)(t)?.[o.WallPostParams.topicId];return void 0!==e&&e!==n?{[o.WallPostParams.topicId]:e}:void 0},r=t=>!0===t?.wallPostTopicSettingEnabled,a=t=>void 0!==t.topic_options},525179:(t,e,i)=>{i.d(e,{TopicUISelector:()=>d});var o=i(250598),s=i(754866),n=i(972332),l=i(337249),r=i(359813),a=i(898848),c=i(581197),_=i(318227);class d{static create(t,e){const i=(0,l.renderSelector)(t,e.linkId);if(!i)return;const o=this.getSelectorContentEl(i),n=(0,s.domQuery1)(".post_action_btn_layout",i);return o&&n?new d(n,i,e,o):void 0}static getSelectorContentEl(t){return(0,s.domQuery1)(".post_action_tt_content",t)}destroy(){this.tooltip.destroy(),delete window.radioBtns[this.radioBtnId]}tooltipHide(){this.tooltip.hide()}selectTopicId(t){this.options.selectTopicId(this.linkId,t),this.updateViewForSelectedTopic({isTopicSelected:t!==r.TOPIC_ID_NONE,topicId:t})}clearSelection(){this.selectTopicId(r.TOPIC_ID_NONE)}updateViewForSelectedTopic({isTopicSelected:t,topicId:e}){const i=d.getSelectOptionEl(this.containerEl,e),o=i&&(0,c.getJsonDataValue)(i,"data-click-params"),n=(0,s.domQuery1)(".post_action_btn_text",this.containerEl);if(!i||!o||!n)return;const{label:r}=o;(0,_.updatePostTooltipActionRadioBtn)(i,void 0,(0,l.getTooltipId)(this.options.linkId));const h=n.getAttribute("data-empty")||"",u=t?r:h;n.innerHTML=u,n.setAttribute("aria-label",(0,a.replaceEntities)(u)),(0,s.toggleClass)(this.containerEl,"on",t)}static getSelectOptionEl(t,e){return(0,s.domQuery1)(`[data-value="${e}"]`,t)}constructor(t,e,i,r){this.btnEl=t,this.containerEl=e,this.options=i,this.selectorContentEl=r,this.onOptionClickWrapper=(...t)=>{this.tooltip.hide();const e=t[0].currentTarget;if(!(e instanceof HTMLElement))return;const i=(0,c.getJsonDataValue)(e,"data-click-params");i&&this.selectTopicId(i.value)},this.linkId=this.options.linkId,this.radioBtnId=(0,l.getTooltipId)(this.options.linkId),window.radioBtns[this.radioBtnId]={val:!1,els:r.children},this.tooltip=new o.ElementTooltip(t,{appendTo:e,forceSide:"bottom",autoShow:!1,cls:"eltt_fancy eltt_fancy_actions",noOverflow:!1,centerShift:0,offset:[-12*(window.vk.rtl?-1:1),7],content:r,align:"left",onFirstTimeShow:()=>{(0,s.show)(r)}}),(0,s.domQuery)('[data-onclick="togglePostTopic"]',e).forEach((t=>{(0,n.addEvent)(t,"click",this.onOptionClickWrapper)}))}}},337249:(t,e,i)=>{i.d(e,{getTooltipId:()=>l,renderSelector:()=>r,topicUISelectorHide:()=>a});var o=i(754866),s=i(593159),n=i(974189);const l=t=>`post_discover_category_btn${t}`,r=(t,e)=>{const i=(t=>{const e=(0,s.getTemplate)("postCategorySelect",t);return e?(0,o.se)(e):null})({link_id:String(e)});if(t instanceof HTMLElement&&i instanceof HTMLElement)return t.appendChild(i),i},a=t=>{(0,n.getSelectorRegistry)(t)?.selector?.tooltipHide()}},614320:(t,e,i)=>{i.d(e,{checkPostLen:()=>u,getPostAvatarString:()=>p,removeUnseenStories:()=>d,showPostponePostWithVideoInfo:()=>m});var o=i(754866),s=i(593159),n=i(952661),l=i(866467),r=i(15874),a=i(783759),c=i(43899),_=i(586520);function d(t){if(h(document,t),window.wkcur?.pageReplaced)for(let e of window.wkcur.pageReplaced)h(e[0],t)}function h(t,e){const i=t.querySelectorAll(".reply_image_stories_unseen"+e);for(const t of i)t.classList.remove("reply_image_stories_unseen","reply_image_stories_unseen"+e),(0,r.replyUserImageLinkClosest)(t)?.removeAttribute("onclick");(0,a.removeRichAvatarOutlineAtNode)(t,String(e),"stories_unseen");const o=t.querySelectorAll(".post_image_stories_unseen"+e);for(const t of o)t.classList.remove("post_image_stories_unseen","post_image_stories_unseen"+e),t.closest(".post_image, ._post_image")?.removeAttribute("onclick")}function u(t,e,i,r){if(!t)return;const a=window.cur.options?.max_post_full_length;if(!a)return!0;const c=(0,o.ge)(t);if(!c)return;let _=(0,s.trim)(window.Emoji.val(c)).replace(/\n\n\n+/g,"\n\n");if(c.lastLen===_.length&&!r)return c.lastLen<=a;const d=c.lastLen=_.length;if(e=(0,o.ge)(e),d>a-100){const t=d>a;if(e&&(t?(i&&(n.FlatButton.isFlatButton(i)?n.FlatButton.setDisabled(i,!0):(0,o.toggleClass)(i,"button_disabled",!0)),e.innerHTML=l.getLang("text_exceeds_symbol_limit",d-a),(0,o.toggleClass)(e,"post_field_warning_red",!0)):e.innerHTML=l.getLang("text_N_symbols_remain",a-d),(0,o.show)(e)),t)return!1}else e&&(0,o.hide)(e);return e&&(0,o.toggleClass)(e,"post_field_warning_red",!1),i&&(n.FlatButton.isFlatButton(i)?n.FlatButton.setDisabled(i,!1):(0,o.toggleClass)(i,"button_disabled",!1)),!0}const p=(t,e,i=_.REPLY_IMAGE_DEFAULT_SIZE,o=!1,s,n="")=>{const l=[e,"_post_field_image"];return s&&l.push(s),(0,c.renderAvatarToString)(t,i,null,l,null,void 0,!1,void 0,n,!(i<_.MIN_NFT_IMAGE_SIZE)&&o)},m=(t,e,i)=>{const o=document.querySelector(`#${t}`);if(!o)return;let s="",n="";const r=i.filter((t=>"video"===t[0])),a=Number(r.reduceRight(((t,e)=>e[e.length-1]?.publish_date||t),0));if(a)if(e){if(1===r.length&&e===a||0===r.length)return void(o.innerHTML="");r.length>1?(s=l.getLang("wall_post_with_video_different_dates_title"),n=l.getLang("wall_post_with_video_different_dates_info")):e>a?(s=l.getLang("wall_post_with_video_later_title"),n=(0,l.langDate)(1e3*a,l.getLang("wall_post_with_video_later_info"),0,l.getLang("months_of"))):e<a&&(s=l.getLang("wall_post_with_video_earlier_title"),n=(0,l.langDate)(1e3*e,l.getLang("wall_post_with_video_earlier_info"),0,l.getLang("months_of")))}else r.length>1?(s=l.getLang("wall_post_with_video_different_dates_title"),n=l.getLang("wall_post_with_video_different_dates_info")):1===r.length&&(s=l.getLang("wall_post_with_video_publish_together_title"));o.innerHTML=s?`\n      <div class="BannerInfo BannerInfo--warn BannerInfo--hasIcon BannerInfo--noHorizontalMargin BannerInfo--noTopMargin">\n        <div class="media_info_title">${s}</div>\n        ${n?`<div class="media_info_desc">${n}</div>`:""}\n      </div>`:""}},562436:(t,e,i)=>{i.d(e,{CarouselRatioSelector:()=>m});var o=i(318227),s=i(972332),n=i(806917),l=i(866467),r=i(553608),a=i(984745),c=i(632731),_=i(58752),d=i(821834),h=i(935531),u=i(700230);const p=new _.PostingItemStatCollector;class m{checkOriginalRatio(){if(!(0,u.isCarouselCorridorEnabled)())return;const t=this.addMedia.getAutoRatio(),e=t&&!u.ratioValues.includes(t),i=this.selectorEl.querySelector(`.${n.ORIGINAL_RATIO_CLASS_NAME}`);i&&(e?(i.dataset.value=String(t),i.style.display=""):(i.dataset.value="",i.style.display="none"))}setCarouselRatio(t){this.addMedia.setCarouselRatio(t)}createTooltip(){const t=this.selectorEl.querySelector(".post_action_tt_content"),e=this.selectorEl.querySelector(".post_action_btn_layout");if(!t||!e)return;const i=(0,o.createPostTooltip)(n.ACTION_BUTTON_ID,this.linkId,void 0,{customShow:!0,width:n.RATIO_TOOLTIP_WIDTH})?.toooltip;return i&&((0,s.addEvent)(e,"click",(()=>{this._isEnabled&&i.toggle()})),this.selectorEl.querySelectorAll(".radiobtn").forEach((t=>{(0,s.addEvent)(t,"click",this.handleOptionClick.bind(this))}))),i}handleOptionClick(t){if(!(t.currentTarget instanceof HTMLElement))return;const e=t.currentTarget.getAttribute("data-value");this.tooltip?.hide(),e&&(this.setCarouselRatio(Number(e)),this.selectOption(Number(e)),p.logEvent({settings_event:{settings_event_type:d.SettingsEventType.RatioChange}}))}updateTooltipRadioBtn(t,e){(0,o.updatePostTooltipActionRadioBtn)(t,e,`post_settings_btn${n.ACTION_BUTTON_ID}${this.linkId}`)}updateActionButtonText(t,e){e&&(t.innerText=e,t.setAttribute("aria-label",e))}selectOption(t){this.checkOriginalRatio();const e=this.selectorEl.querySelector(`[data-value="${t}"]`),i=this.selectorEl.querySelector(".post_action_btn_text");if(!(e instanceof HTMLElement&&i instanceof HTMLElement))return;this.updateTooltipRadioBtn(e,t);const o=e.getAttribute("aria-label")||"";this.updateActionButtonText(i,o)}isHidden(){return this._isHidden}setVisibility(t){this.checkOriginalRatio();let e=t;this.selectorEl.style.display=e?"":"none",this._isHidden=!t}isEnabled(){return this._isEnabled}setEnabled(t){this.selectorEl.classList.toggle(n.ACTION_BUTTON_DISABLED,!t),this._isEnabled=t}showHintTooltip(t){if((0,a.ensureAccountHelpHintsService)().canShow(c.AvailableHelpHints.ACCOUNT_HINT_POSTING_EDITOR_PHOTO_ATTACHMENTS_CROP)){const e=Number(r.vkLocalStorage.getItem(n.STORAGE_HINT_NAME));e&&e+1>=5?((0,a.ensureAccountHelpHintsService)().hideHelpHint({hintId:c.AvailableHelpHints.ACCOUNT_HINT_POSTING_EDITOR_PHOTO_ATTACHMENTS_CROP}),r.vkLocalStorage.removeItem(n.STORAGE_HINT_NAME)):r.vkLocalStorage.setItem(n.STORAGE_HINT_NAME,e+1),(0,h.renderCarouselRatioSelectorHint)({element:this.selectorEl,text:l.getLang("global_posting_carousel_ratio_hint")+" "+n.RatioShowValue[t]})}}constructor(t,e,i,o,s={isHidden:!0,isEnabled:!1}){this.linkId=e,this.selectorEl=i,this.tooltip=this.createTooltip(),this.addMedia=t,o&&(this.selectOption(o),this.setCarouselRatio(o)),this.setVisibility(!s.isHidden),this.setEnabled(s.isEnabled)}}},935531:(t,e,i)=>{i.d(e,{renderCarouselRatioSelectorHint:()=>d});var o=i(474848),s=i(296540),n=i(578392),l=i(373080),r=i(239808),a=i(205338),c=i(342018);const _=({element:t,text:e,onClose:i})=>{const[a,c]=(0,s.useState)(!0),_=(0,s.useCallback)((()=>{i?.(),c(!1)}),[i,c]);return(0,s.useEffect)((()=>(window.addEventListener("mousedown",_,{once:!0}),()=>window.removeEventListener("mousedown",_))),[_]),(0,o.jsx)(n.TextTooltip,{appearance:"neutral",hideWhenReferenceHidden:!0,placement:"top-end",offsetByMainAxis:0,shown:a,onClose:_,text:(0,o.jsx)(l.InnerHTML,{children:e}),children:(0,o.jsx)(r.ElementPortal,{element:t})})},d=({onClose:t,...e})=>{const i=document.createElement("div");document.body.append(i),e.element.parentElement&&e.element.parentElement.setAttribute("data-onboarding-tooltip-container","true");const s=(0,a.createRoot)(i),n=()=>{s.unmount(),i.remove()};s.render((0,o.jsx)(_,{...e,onClose:()=>{t?.(),n()}})),(0,c.pushNavDestroy)((()=>{i&&n()}))}},94470:(t,e,i)=>{i.d(e,{initCarouselRatioSelector:()=>d});var o=i(562436),s=i(806917),n=i(791947),l=i(600222),r=i(723294),a=i(700230),c=i(866467);const _=({title:t,value:e,icon:i,className:o})=>`<div class="FancyElementTT__item radiobtn ${o??""}" ${e?"":'style="display: none;"'} role="radio" data-value="${e}" aria-label="${t}">\n    ${i}\n  <div class="FancyElementTT__itemLabel">${t}</div>\n</div>`,d=({linkId:t,postActionsEl:e,addMedia:i,initValue:d})=>{if(!(e instanceof HTMLElement))return;let h="";const u=`<span class="FancyElementTT__checkIcon">${(0,n.getIcon16Done)().icon}</span>`,p=(0,a.isCarouselCorridorEnabled)(),m=p&&d&&!a.ratioValues.includes(d),g=c.getLang("global_posting_carousel_ratio_original");if(p){const t=m?u:"";h+=_({title:g,value:String(d||""),icon:t,className:s.ORIGINAL_RATIO_CLASS_NAME})}Object.values(a.ratioValues).forEach((t=>{const e=s.RatioShowValue[t],i=t===d?u:"";h+=_({title:e,value:String(t),icon:i})}));let f=d&&s.RatioShowValue[d]?s.RatioShowValue[d]:"";p&&(f=d?s.RatioShowValue[d]||g:"");const A=document.createElement("div");A.classList.add("post_action_btn"),A.id=s.ACTION_BUTTON_ID+t??"",A.innerHTML=`<div class="post_action_btn_layout">\n    <span class="post_action_btn_text">${f}</span>\n    <span class="post_action_image_btn">${(0,l.getIcon12Dropdown)().icon}</span>\n    <div class="post_action_tt_content">\n      ${h}\n    </div>\n  </div>`;const v=e.querySelector(`#${r.ACTION_BUTTON_ID}`)||e.querySelector(`#${r.ACTION_BUTTON_ID}${t}`);if(!v)return;v.after(A);const T=new o.CarouselRatioSelector(i,t,A,d,{isHidden:!0,isEnabled:!1}),E=(t,e)=>{e?(T.setVisibility(!0),T.setEnabled(!0)):T.setVisibility(!1)};return E(0,i.isRatioSelectorVisible()),i.emitter.on(i.eventTypes.previewUpdate,E),i.emitter.on(i.eventTypes.viewDraw,E),{setOption:t=>{T.selectOption(t)},onClear:()=>{T.setVisibility(!1)},showHintTooltip:t=>{T.showHintTooltip(t)}}}},711373:(t,e,i)=>{i.d(e,{getThumbsCount:()=>p,isCarouselAllowed:()=>m,isGridAllowed:()=>g,makeReactCarouselRenderer:()=>u,mediaDataToAttachments:()=>f,mediaDataToClickHandlers:()=>A,renderCarousel:()=>T});var o=i(26023),s=i(115208),n=i(298077),l=i(859103),r=i(342879),a=i(142278),c=i(8520),_=i(866467),d=i(700230);const h="PrimaryAttachmentCarouselWrapper",u=()=>{let t;return({thumbs:e,onDelete:o,ratio:s,changeRatio:n},l)=>{const r=()=>{t&&t.isMounted()&&t.unmount(),t=void 0;const e=l.querySelector(`.${h}`);e?.remove()};if(!e.length)return r(),()=>{};if(!t?.isMounted()){l.innerHTML=`<div class="${h}"></div>`;if(!l.querySelector(`.${h}`))return()=>{};t||(t=(0,a.createReactLazyInitiator)((()=>(0,c.asyncImportLoader)((()=>Promise.all([i.e(91498),i.e(89631),i.e(762),i.e(69096),i.e(9221),i.e(52781)]).then(i.bind(i,171790)).then((({PrimaryAttachmentsCarousel:t})=>t))))),(()=>l.querySelector(".PrimaryAttachmentCarouselWrapper"))))}return t?.render({thumbs:e,onDelete:o,ratio:s,changeRatio:n}),r}},p=t=>(0,s.getThumbsMediaItems)(t).length,m=(t,{skipClipsCheck:e=!1}={})=>{const i=(0,d.isCarouselCropEnabled)()||p(t)>1,o=e||t?.every((([t,,e])=>!(t===s.THUMB_TYPE_VIDEO&&e?.editable?.is_short_video)));return Boolean(i&&o)},g=(t,e=!1)=>{const i=t?.every((([t,,e])=>t===s.THUMB_TYPE_VIDEO&&e?.editable?.is_short_video));return Boolean((!e||i)&&(!(0,d.isCarouselCropEnabled)()||p(t)>1||i&&1===p(t)))},f=t=>[...new Set((0,s.getThumbsMediaItems)(t).map((([t,e])=>`${t}${e}`)))].join(","),A=t=>t?.reduce(((t,e)=>{if(e[2]&&"editable"in e[2]){const i=e[2]?.editable?.click;t[e[1]]=i??t[e[1]]}return t}),{})??{},v=t=>e=>{if(!t)return;if(!(e.target instanceof HTMLElement))return;const i=function(t){const e=".js-PrimaryAttachment",i=t.closest(e);if(!i)return void(0,n.logError)(new Error("PrimaryAttachment: posting delete handler: missing card"));const o=i.closest(".js-PrimaryAttachmentCarousel");if(!o)return void(0,n.logError)(new Error("PrimaryAttachment: posting delete handler: missing carousel"));const s=o.querySelectorAll(e),r=Array.prototype.indexOf.call(s,i);if(-1===r)return void(0,n.logError)(new Error("PrimaryAttachment: posting delete handler: card not in carousel"));const a=(0,l.getPrimaryCarouselGallery)(i);if(!a)return;return{gallery:a,index:r}}(e.target);if(!i)return void(0,n.logError)(new Error("PrimaryAttachment: posting delete handler: missing gallery instance"));const{gallery:o,index:s}=i;o.removeItem(s),t(s)},T=({oid:t,postId:e,attachments:i,photoClickHandlers:s,onDelete:n,wkView:l=!1},a)=>{a.firstChild||(a.innerHTML='<div class="PrimaryAttachmentCarousel__skeleton"></div>');let c=()=>{},d=!1,h=!1;return{renderCarouselPromise:new Promise(((o,s)=>{const n=window.ajax.post("al_wall.php",{act:"render_carousel",post_id:e,owner_id:t,attachments:i,wk_view:l?1:0},{onDone:o,onFail:()=>(s(),!1)});c=()=>{h||(d=!0,n.abort(),s())}})).catch((()=>({carousel_html:""}))).then((t=>{const e=t?.carousel_html;if(!d&&a&&e){a.innerHTML=`<div class="PrimaryAttachmentCarouselWrapper">${String(e)}</div>`,Object.keys(s).forEach((t=>{const e=a.querySelector(`[data-photo-id="${t}"]`);e?.addEventListener("click",(e=>{e.stopPropagation(),e.preventDefault(),s[t]?.()}))}));const t=a.querySelector(".PrimaryAttachmentCarouselWrapper")??void 0;a.querySelectorAll(".js-PrimaryAttachmentCarousel__close").forEach((e=>{e.addEventListener("mouseover",(()=>{(0,r.showTooltip)(e,{text:_.getLang("dont_attach"),shift:[11,8],black:1,appendEl:t,dir:void 0})}))})),(0,o.default)(a,".js-PrimaryAttachmentCarousel__close","click",v(n))}h=!0})),abort:c}}},300469:(t,e,i)=>{i.d(e,{getFixedReplyField:()=>r,initCommentsHandlers:()=>d,isInlineCommentsEnabled:()=>c,replyBoxOwnerIsNftFromAttr:()=>a});var o=i(338329),s=i(15874),n=i(153663),l=i(540462);const r=()=>window.cur.wallLayer?document.getElementById("wl_reply_form")??void 0:"full"===window.cur.wallType?document.querySelector(`#reply_box_wrap${window.cur.oid}_${window.cur.pid} .reply_box_inner_wrap`)??void 0:void 0,a=t=>"1"===t;function c(){return(0,l.partConfigEnabled)("feed_inline_comments_web")}function _(t,e,i){const o=t.match(/^(-?\d+)_(wall)?(\d+)$/);if(!o)return;const s=(l=e,l?.closest(".reply"));var l;const r=s?.id.split("_")[1],a=(0,n.getTrackCodeFromPost)(e),c=`wall${o[1]}_${o[3]}`;window.Wall.postFull(c,!1,{isPostCommentsDisabled:i.isPostCommentsDisabled,isInlineCommentsEnabled:i.isInlineCommentsEnabled,isInputFocusEnabled:i.isPostCommentsDisabled&&!i.isInputFocusDisabled,reply:i.isInlineCommentsEnabled?r:null,clickSource:i.clickSource,trackCode:a})}function d(){(0,o.tq)().setInteractiveHandler("PostBottomAction/comment",(t=>{const e=t.payload.target;if(!e)return;const i=(0,s.getPostElemByChildEl)(e),o=i?.getAttribute("data-post-id");if(!o||!i)return;const n=e?.classList.contains("replies_next_inline");_(o,e,{isPostCommentsDisabled:"true"===i?.getAttribute("data-post-comments-disabled"),isInlineCommentsEnabled:!1,isInputFocusDisabled:n,clickSource:"comments_button"})})),(0,o.tq)().setInteractiveHandler("FeedReplies/showCommentInLayer",(t=>{if(window.cur.editingPost)return;const e=t.payload.target;if(!e)return;const i=t.payload.event?.target;if(function(t){return t?.closest(".wall_reply_text a")}(i))return;const o=(0,s.getPostElemByChildEl)(e),n=o?.getAttribute("data-post-id");if(!n||!o)return;_(n,e,{isPostCommentsDisabled:!1,isInlineCommentsEnabled:"true"===o?.getAttribute("data-post-inline-comments"),clickSource:"inline_comment"})}))}}}]);try{stManager?.done("dist/web/chunks/bdf39731.de4bf272.js")}catch(t){}