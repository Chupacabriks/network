"use strict";(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[7634],{891281:(e,t,r)=>{r.d(t,{FriendsFriendStatusStatusEnumNames:()=>i});const i={NOT_A_FRIEND:0,OUTCOMING_REQUEST:1,INCOMING_REQUEST:2,IS_FRIEND:3}},52905:(e,t,r)=>{r.d(t,{API_VERSION:()=>i,BRIDGE_STAT_CALL_ARGUMENTS_MAX_LENGTH:()=>y,CLOSE_STATUS:()=>d,ERROR_CODES:()=>o,ERROR_REASONS:()=>n,ERROR_TYPES:()=>c,MAX_COUNT_OF_APP_INIT:()=>T,NFT_APP_ID:()=>u,ONE_TIME_DONUT_APP_ID:()=>m,ORD_APP_ID:()=>p,OZON_APP_ID:()=>v,PLATFORM:()=>s,PMC_PART_CONFIG_KEY_LONG_ID:()=>h,SITPOSTING_APP_ID:()=>f,TEXTLIVE_APPS:()=>_,VKPAY_APPS:()=>l,VKPAY_TRANSACTION_EVENT:()=>a,VK_CONNECT_EVENTS:()=>E,VK_CONNECT_SUPERAPPKIT_EVENT_TYPE:()=>g,VMOJI_CONSTRUCTOR_APP_ID:()=>S});const i="5.95",a="VKWebAppActionDone",s={WEB:"web",MOBILE_WEB:"mobile-web"},o={UNKNOWN:1,MISSING_PARAM:2,OLD_MISSING_PARAM:100,CONNECTION_LOST:3,USER_DENIED:4,INVALID_PARAMS:5,UNSUPPORTED_PLATFORM:6,REQUESTS_LIMIT_REACHED:10,ACCESS_DENIED:11,CUSTOM:13,NO_ADS:20},n={ACCESS_DENIED:"Access denied",UNSUPPORTED_PLATFORM:"Unsupported platform",UNSUPPORTED_ACTION:"Unsupported action",NATIVE_APP_IS_NOT_INSTALLED:"VK client is not installed on device",USER_NOT_A_PRIVATE_GROUP_MEMBER:"User is not a member of the given private group",UNKNOWN_ERROR:"Unknown error",CONNECTION_LOST:"Connection lost",NETWORK_ERROR:"Network error",USER_DENIED:"User denied",INVALID_PARAMS:"Invalid params",NO_ADS:"No ads",ADS_ALREADY_PLAYED:"Ads already played",VK_PAY_DISABLED:"This app can't use VK Pay",SCROLL_SUBSCRIBER_ALREADY_EXIST:"Scroll subscriber already exist",SUBSCRIPTION_IS_ALREADY_CANCELLED:"Subscription is in invalid status: subscription is already cancelled",SURVEY_INIT_IN_PROGRESS:"Survey init in progress",SURVEY_ALREADY_INIT:"Survey already init",SURVEY_NO_MATCH:"Survey no match",SURVEY_USER_CANCEL:"Survey user cancel",ALREADY_IN_PROGRESS:"Already in progress",USER_IS_NOT_GROUP_ADMIN:"Only group admins have access to group tokens",DEVICE_CANT_GET_GEODATA:"Device can't get geodata",USER_DIDNT_ALLOWED_ACTION:"User didn't allowed"},c={CLIENT:"client_error",API:"api_error",AUTH:"auth_error"},d=["success","failed"],l=[6217559,7131443],_=[7512376],p=51707812,u=51459963,f=7644481,S=7929683,m=51528700,v=51903384,E={VKWebAppAddToCommunity:"add_to_community",VKWebAppAddToCommunityPreload:"get_groups_list",VKWebAppAddToFavorites:"add_to_favorites",VKWebAppAddToFavoritesPreload:"already_added_to_favorites",VKWebAppAddToMenu:"add_to_menu",VKWebAppAddToMenuPreload:"is_in_left_menu",VKWebAppGetCommunityToken:"get_community_token",VKWebAppGetCommunityTokenPreload:"get_community_preload_settings",VKWebAppGetAuthToken:"get_auth_token",VKWebAppGetAuthTokenPreload:"get_auth_token_info",VKWebAppGetPhoneNumber:"get_phone_number",VKWebAppGetPhoneNumberPreload:"already_get_phone_number",VKWebAppGetEmail:"get_email",VKWebAppGetEmailPreload:"already_get_email",VKWebAppGetFriends:"get_friends",VKWebAppOpenApp:"open_app",VKWebAppSendPayload:"send_payload",VKWebAppSendToClient:"send_to_client",VKWebAppSendToClientPreload:"get_open_in_native_permission",VKWebAppShowOrderBox:"order",VKWebAppShowSubscriptionBox:"subscription",VKWebAppShowLeaderBoardBox:"show_leader_board",VKWebAppShowLinkCardBox:"show_link_card",VKWebAppShowNftPaymentBox:"show_nft_pay_box",VKWebAppShowInviteBox:"invite_friends",VKWebAppShowStoryBox:"story_box",VKWebAppShowRequestBox:"send_request",VKWebAppShowRequestBoxPreload:"request_box_preload",VKWebAppOpenArticleEditor:"open_article_edit",VKWebAppSubscribeStoryApp:"subscribe_story_app",VKWebAppClose:"close",VKWebAppGetSilentToken:"get_silent_token",VKWebAppOpenPayForm:"open_pay_form",VKWebAppAddToChat:"add_to_chat",VKWebAppTrackEvent:"track_event",VKWebAppCallStart:"call_start",VKWebAppCallJoin:"call_join",VKWebAppCallLeft:"call_left",VKWebAppCallFinished:"call_finished",VKWebAppCallGetStatus:"call_get_status",VKWebAppCallStartSharing:"call_start_sharing",VKWebAppCallStopSharing:"call_stop_sharing"},g="vk-sak-sdk",h="mini_apps_long_id",y=256,T=1},541756:(e,t,r)=>{r.d(t,{saveNavigationStatEvent:()=>n,saveViewerStartTime:()=>d});r(8520);var i=r(809152),a=r(601686);function s(){const{connection:e}=navigator;if(!e)return"";const{effectiveType:t,downlink:r}=e;switch(t){case"slow-2g":return"GPRS";case"2g":return"EDGE";case"3g":return"3G";case"4g":return r>8?"wi-fi":"LTE"}return""}let o=[];function n({storyRawId:e,source:t,action:r}){let s=0,n=0;e&&([s,n]=(0,a.splitStoryRawId)(e)),"reply"===t&&(t="replies_list");const c={e:i.STATS_EVENT_TYPE_STORIES_VIEWER_NAVIGATION,owner_id:s,story_id:n,source:t,action:r};o.push(c)}let c=[];function d({storyRawId:e,source:t,time:r}){const[o,n]=(0,a.splitStoryRawId)(e),d={e:i.STATS_EVENT_TYPE_STORIES_VIEWING_START_TIME,owner_id:o,story_id:n,source:t,time:r,internet_type:s()};c.push(d)}},356812:(e,t,r)=>{r.d(t,{apiAudioToAudioTuple:()=>i.apiAudioToAudioTuple});var i=r(965440)},587952:(e,t,r)=>{r.d(t,{AUDIO_PLAYER_ADAPTER_HASHES_SEPARATOR:()=>i});const i="/"},133326:(e,t,r)=>{r.d(t,{getAudioHashesString:()=>a});var i=r(587952);const a=({addHash:e,editHash:t,actionHash:r,deleteHash:a,replaceHash:s,urlHash:o,restoreHash:n})=>[e||"",t||"",r||"",a||"",s||"",o||"",n||""].join(i.AUDIO_PLAYER_ADAPTER_HASHES_SEPARATOR)},51921:(e,t,r)=>{r.d(t,{connectTrackTmrGroupsJoin:()=>c,groupsJoinAction:()=>d,trackTmrGroupsJoin:()=>o});var i=r(251703),a=r(957994),s=r(32489);const o=()=>(0,i.tmrSendTimespentEvent)(i.MY_TRACKER_COUNT_EVENT_IDS.COMMUNITY_SUBSCRIBE),n=(0,s.createEffect)({name:"fx/track_group_join",handler:o}),c=e=>(0,s.sample)({clock:e.done,target:n}),d=(e,t,r)=>(0,a.api)("groups.join",e,t,r).then((e=>(o(),e)))},869071:(e,t,r)=>{r.d(t,{connectTrackTmrGroupsJoin:()=>i.connectTrackTmrGroupsJoin,groupsJoinAction:()=>i.groupsJoinAction,trackTmrGroupsJoin:()=>i.trackTmrGroupsJoin});var i=r(51921)},910364:(e,t,r)=>{r.d(t,{createCacheService:()=>a});var i=r(746573);const a=e=>{const t=(0,i.getEffectorServiceDomain)(e),r=Object.create(null),a=t.createStore(Object.create(null)),s=t.createEvent("add"),o=t.createEvent("delete");return a.on(s,((e,{key:t,data:r})=>(e[t]=r,e))).on(o,((e,t)=>(delete e[t],e))),{$cache:a,add:s,delete:o,get:e=>a.getState()[e]||null,isWaited:e=>void 0!==r[e],getWaited:e=>r[e],setWaited:(e,t)=>{r[e]=t},deleteWaited:e=>{delete r[e]}}}},136335:(e,t,r)=>{r.d(t,{createOwnerService:()=>a.createOwnerService,createUserService:()=>i.createUserService});var i=r(277594),a=r(43188)},43188:(e,t,r)=>{r.d(t,{createOwnerService:()=>l});var i=r(32489),a=r(805658),s=r(810068),o=r(910364),n=r(746573),c=r(33305);const d=(0,o.createCacheService)(),l=e=>{const t=e.fields||[],r=(0,n.getEffectorServiceDomain)(e),o=r.createStore({id:0}),l=r.createEvent("initialize"),_=r.createEvent("reload"),p=r.createEffect({name:"initializeFx"}),u=p.pending,f=p.doneData;return p.use((({ownerId:e,useCache:r})=>{if(r){const r=d.get(e);if(r){if(t.every((e=>r.hasOwnProperty(e))))return Promise.resolve(r)}}if(d.isWaited(e)){const r=d.getWaited(e).find((e=>t.every((t=>Boolean(e.fields[t])))));if(r)return r.promise.finally((()=>{d.deleteWaited(e)})),r.promise}let i=s.Ranges.isGroupId(e)?(0,a.apiWithPrefetch)("groups.getById",{group_ids:String(e),fields:t.join(",")}).then((t=>t.groups?.[0]||{id:e})):(0,a.apiWithPrefetch)("users.get",{user_ids:String(e),fields:t.join(",")}).then((e=>e[0]));const o={fields:t.reduce(((e,t)=>(e[t]=!0,e)),{}),promise:i},n=d.isWaited(e)?[...d.getWaited(e),o]:[o];return d.setWaited(e,n),i})),(0,i.sample)({clock:l,source:o,filter:(e,t)=>e.id!==t,fn:(t,r)=>({ownerId:r,useCache:Boolean(e?.useCache)}),target:p}),(0,i.sample)({clock:_,source:o,fn:e=>({ownerId:e.id}),target:p}),(0,i.sample)({clock:p.doneData,target:o}),(0,i.sample)({clock:p.doneData,filter:()=>Boolean(e?.useCache),fn:e=>{const t=d.get(e.id);if(t){if((0,c.isOwnerUser)(t)&&(0,c.isOwnerUser)(e))return{key:e.id,data:{...t,...e}};if((0,c.isOwnerGroup)(t)&&(0,c.isOwnerGroup)(e))return{key:e.id,data:{...t,...e}}}return{key:e.id,data:e}},target:d.add}),{$isInitializing:u,$owner:o,initialize:l,onInitialized:f,reload:_}}},277594:(e,t,r)=>{r.d(t,{createUserService:()=>o});var i=r(32489),a=r(957994),s=r(805658);const o=({domain:e})=>{const t=(e,t)=>!(!e||e.id!==t.userId),r=e.createStore(null),o=e.createEffect((({params:e})=>(0,s.apiWithPrefetch)("users.get",e))),n=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,a.api)("wall.subscribe",e.params)}))),c=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,a.api)("wall.unsubscribe",e.params)}))),d=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,a.api)("video.liveSubscribe",e.params)}))),l=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,a.api)("video.liveUnsubscribe",e.params)}))),_=e.createEffect((async e=>({userId:e.params.user_id,response:await(0,a.api)("fave.addUser",e.params)}))),p=e.createEffect((async e=>({userId:e.params.user_id,response:await(0,a.api)("fave.removeUser",e.params)}))),u=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,a.api)("account.ban",e.params)}))),f=e.createEffect((async e=>({userId:e.params.owner_id,response:await(0,a.api)("account.unban",e.params)}))),S=e.createEffect((async e=>({userId:e.params.user_id,response:await(0,a.api)("bestFriends.add",e.params)}))),m=e.createEffect((async e=>({userId:e.params.user_id,response:await(0,a.api)("bestFriends.delete",e.params)})));return(0,i.sample)({clock:o.doneData,fn:e=>e[0]||null,target:r}),(0,i.sample)({clock:n.doneData,source:r,filter:t,fn:e=>({...e,is_subscribed:1}),target:r}),(0,i.sample)({clock:c.doneData,source:r,filter:t,fn:e=>({...e,is_subscribed:0}),target:r}),(0,i.sample)({clock:d.doneData,source:r,filter:t,fn:e=>({...e,video_live:e.video_live?{...e.video_live,is_notifications_blocked:0}:void 0}),target:r}),(0,i.sample)({clock:l.doneData,source:r,filter:t,fn:e=>({...e,video_live:e.video_live?{...e.video_live,is_notifications_blocked:1}:void 0}),target:r}),(0,i.sample)({clock:_.doneData,source:r,filter:t,fn:e=>({...e,is_favorite:1}),target:r}),(0,i.sample)({clock:p.doneData,source:r,filter:t,fn:e=>({...e,is_favorite:0}),target:r}),(0,i.sample)({clock:u.doneData,source:r,filter:t,fn:e=>({...e,blacklisted_by_me:1}),target:r}),(0,i.sample)({clock:f.doneData,source:r,filter:t,fn:e=>({...e,blacklisted_by_me:0}),target:r}),(0,i.sample)({clock:S.doneData,source:r,filter:t,fn:e=>({...e,is_best_friend:!0}),target:r}),(0,i.sample)({clock:m.doneData,source:r,filter:t,fn:e=>({...e,is_best_friend:!1}),target:r}),{fetchUserFx:o,subscribeToPostsFx:n,unsubscribeFromPostsFx:c,subscribeToVideoLiveFx:d,unsubscribeFromVideoLiveFx:l,faveAddUserFx:_,faveRemoveUserFx:p,accountBanFx:u,accountUnbanFx:f,bestFriendAddFx:S,bestFriendDeleteFx:m,$user:r,domain:e}}},653422:(e,t,r)=>{r.d(t,{apiFaveAddNarrative:()=>a,apiFaveRemoveNarrative:()=>s});var i=r(957994);function a(e){return(0,i.api)("fave.addNarrative",e)}function s(e){return(0,i.api)("fave.removeNarrative",e)}},373237:(e,t,r)=>{r.d(t,{createFaveService:()=>s});var i=r(32489),a=r(653422);const s=({domain:e})=>{const t=e.createEvent("fire/faveAddNarrative"),r=e.createEvent("fire/faveRemoveNarrative"),s=e.createEffect("fx/faveAddNarrative"),o=e.createEffect("fx/faveRemoveNarrative");return s.use(a.apiFaveAddNarrative),o.use(a.apiFaveRemoveNarrative),(0,i.sample)({clock:t,target:s}),(0,i.sample)({clock:r,target:o}),{fireAddNarrative:t,fireRemoveNarrative:r,addNarrativeFx:s,removeNarrativeFx:o}}},507838:(e,t,r)=>{r.d(t,{findOwnerById:()=>s,isGroup:()=>a});var i=r(468073);function a(e){return i.Ranges.isGroupId(e.id)}const s=(e=0,t=[],r=[])=>{if(e)return i.Ranges.isUserId(e)?t.find((t=>t?.id===e)):r.find((t=>t?.id===Math.abs(e)))}},646938:(e,t,r)=>{var i,a,s,o,n;r.d(t,{DynamicStickersTypes:()=>d,StickerTypes:()=>c,StoryBlockType:()=>o,StoryEntryPoint:()=>a,StoryListName:()=>n,StoryPollBackgroundType:()=>u,StorySource:()=>s,StoryStickerSubtype:()=>l,StoryType:()=>i,dynamicStickerIds:()=>_,staticStickerIds:()=>p}),function(e){e.PHOTO="photo",e.VIDEO="video",e.LIVE="live"}(i||(i={})),function(e){e.SWIPE="swipe",e.NAVIGATION_BUTTON="navigation_button",e.SIT_POSTING="sit_posting",e.LINK="link",e.STORY_REPLY="story_reply",e.STORY_REPOST="story_repost",e.CATALOG_ADD="catalog_add",e.DIALOG="dialog",e.STORY_LIVE_FINISHED="story_live_finished",e.DIALOG_VKME="dialog_vkme",e.STORY_VIEWER_FINISHED="story_viewer_finished",e.PUSH_TRY_MASK="push_try_mask",e.STORY_VIEWER_TRY_MASK="story_viewer_try_mask",e.LINK_MASK="link_mask",e.POSTING="posting",e.NEW_STORY_AVATAR="new_story_avatar",e.STORY_REPLIES_LIST="story_replies_list",e.STORIES_FEED="stories_feed",e.STORIES_SEARCH_NEWS="stories_search_news",e.QUESTION_STICKER="question_sticker",e.LIST_MIDDLE="list_middle",e.ARCHIVE_EMPTY_BUTTON="archive_empty_button",e.ARCHIVE_MENU_BUTTON="archive_menu_button",e.IM="im",e.PROFILE_BUTTON="profile_button",e.SHARE="share",e.MINI_APP="mini_app",e.SYSTEM_SHARING="system_sharing",e.SHORTCUT="shortcut",e.ARCHIVE_SHARING="archive_sharing",e.STORY_VIEWER_CAMERA_BUTTON="story_viewer_camera_button",e.STORY_VIEWER_MUSIC="story_viewer_music",e.STORY_VIEWER_MUSIC_SHEET="story_viewer_music_sheet",e.REPOST_TO_STORY_ACTIVITY="repost_to_story_activity",e.CHANGE_AVATAR="change_avatar",e.GROUP_ADD_STORIES_PAGE="group_add_stories_page",e.MUSIC_COVER_SHARING="music_cover_sharing"}(a||(a={})),function(e){e.FEED="feed",e.FEED_MIDDLE="feed_middle",e.LINK="link",e.PROFILE="profile",e.IM_DIALOGS="im_dialogs",e.IM_DIALOG_HEADER="im_dialog_header",e.SNIPPET="snippet",e.REPLY="reply",e.REPLIES_LIST="replies_list",e.REPLY_STORY="reply_story",e.DISCOVER="discover",e.STORIES_MANAGE="stories_manage",e.USER_PERSONAL_CARD="user_personal_card",e.GROUP_PERSONAL_CARD="group_personal_card",e.NARRATIVE_SNIPPET="narrative_snippet",e.NARRATIVE_STORY="narrative_story",e.NARRATIVE_LINK="narrative_link",e.NARRATIVE_RECOMMENDATIONS="narrative_recommendations",e.NARRATIVE_SECTION="narrative_section",e.FAVE="fave",e.SPAMFEED="sf",e.ADS_PREVIEW="ads_preview",e.LIST_MIDDLE="list_middle",e.PLACE_STORY_LIST="place_story_list",e.SEARCH_STORY_LIST="search_story_list",e.STORY_ARCHIVE="story_archive",e.IM_MSG_LIST="im_msg_list",e.NOSPAM="nospam",e.PROFILE_SNACKBAR="profile_snackbar",e.MY_QUESTIONS="question_story"}(s||(s={})),function(e){e.stories="stories",e.appGroupedStories="app_grouped_stories",e.promoStories="promo_stories",e.discover="discover",e.liveActive="live_active",e.liveFinished="live_finished"}(o||(o={})),function(e){e.feed="feed",e.apps="apps",e.discover="discover"}(n||(n={}));const c={hashtag:1,mention:2,question:3,place:4,music:5,storyReply:6,owner:7,link:8,marketItem:9,post:10,poll:11,sticker:12,app:13,situationalTheme:14,playlist:15,videoButton:16,situationalTemplate:17,spoiler:18},d={situationalTemplate:c.situationalTemplate};var l;!function(e){e.aliexpress="aliexpress_product",e.market="market_item"}(l||(l={}));const _=Object.values(d),p=Object.values(c).filter((e=>!_.includes(e)));var u;!function(e){e.photo="photo",e.gradient="gradient",e.default="default"}(u||(u={}))},33270:(e,t,r)=>{r.d(t,{apiLikesAdd:()=>a,apiLikesDelete:()=>s});var i=r(957994);function a(e){return(0,i.api)("likes.add",e)}function s(e){return(0,i.api)("likes.delete",e)}},208579:(e,t,r)=>{var i;!function(e){e.Story="story"}(i||(i={}))},733498:(e,t,r)=>{r.d(t,{createLikesService:()=>i.createLikesService});var i=r(921245);r(208579)},921245:(e,t,r)=>{r.d(t,{createLikesService:()=>s});var i=r(32489),a=r(33270);const s=({domain:e})=>{const t=e.createEvent("fire/likesAdd"),r=e.createEvent("fire/likesDelete"),s=e.createEffect("fx/likesAdd"),o=e.createEffect("fx/likesDelete");return s.use(a.apiLikesAdd),o.use(a.apiLikesDelete),(0,i.sample)({clock:t,target:s}),(0,i.sample)({clock:r,target:o}),{fireAdd:t,fireDelete:r,addFx:s,deleteFx:o}}},928410:(e,t,r)=>{r.d(t,{apiMessagesSend:()=>a});var i=r(957994);function a(e){return(0,i.api)("messages.send",e)}},455673:(e,t,r)=>{r.d(t,{createMessagesService:()=>s});var i=r(32489),a=r(928410);const s=({domain:e})=>{const t=e.createEvent("fire/messageSend"),r=e.createEffect("fx/messageSend");return r.use(a.apiMessagesSend),(0,i.sample)({clock:t,target:r}),{fireMessagesSend:t,sendFx:r}}},869397:(e,t,r)=>{r.d(t,{apiNarrativesBatchEdit:()=>o,apiNarrativesCreate:()=>a,apiNarrativesDelete:()=>n,apiNarrativesEdit:()=>s,apiNarrativesGetById:()=>c,apiNarrativesGetFeedBlock:()=>d,apiNarrativesGetFromOwner:()=>l,apiNarrativesReorder:()=>p,apiNarrativesSaveCustomCover:()=>_});var i=r(957994);function a(e){return(0,i.api)("narratives.create",e)}function s(e){return(0,i.api)("narratives.edit",e)}function o(e){return(0,i.api)("narratives.batchEdit",e)}function n(e){return(0,i.api)("narratives.delete",e)}function c(e){return(0,i.api)("narratives.getById",e)}function d(e={}){return(0,i.api)("narratives.getFeedBlock",e)}function l(e){return(0,i.api)("narratives.getFromOwner",e)}function _(e){return(0,i.api)("narratives.saveCustomCover",e)}function p(e){return(0,i.api)("narratives.reorder",e)}},942838:(e,t,r)=>{r.d(t,{createNarrativesService:()=>s});var i=r(32489),a=r(869397);const s=({domain:e})=>{const t=e.createEvent("fire/narrativesGetById"),r=e.createEvent("fire/narrativesGetFromOwner"),s=e.createEvent("fire/narrativesGetFeedBlock"),o=e.createEvent("fire/narrativesCreate"),n=e.createEvent("fire/narrativesEdit"),c=e.createEvent("fire/narrativesBatchEdit"),d=e.createEvent("fire/narrativesDelete"),l=e.createEvent("fire/narrativesSaveCustomCover"),_=e.createEvent("fire/narrativesReorder"),p=e.createEffect("fx/narrativesGetById"),u=e.createEffect("fx/narrativesGetFromOwner"),f=e.createEffect("fx/narrativesGetFeedBlock"),S=e.createEffect("fx/narrativesCreate"),m=e.createEffect("fx/narrativesEdit"),v=e.createEffect("fx/narrativesBatchEdit"),E=e.createEffect("fx/narrativesDelete"),g=e.createEffect("fx/narrativesSaveCustomCover"),h=e.createEffect("fx/narrativesReorder");return p.use(a.apiNarrativesGetById),u.use(a.apiNarrativesGetFromOwner),f.use(a.apiNarrativesGetFeedBlock),S.use(a.apiNarrativesCreate),m.use(a.apiNarrativesEdit),v.use(a.apiNarrativesBatchEdit),E.use(a.apiNarrativesDelete),g.use(a.apiNarrativesSaveCustomCover),h.use(a.apiNarrativesReorder),(0,i.sample)({clock:t,target:p}),(0,i.sample)({clock:r,target:u}),(0,i.sample)({clock:s,target:f}),(0,i.sample)({clock:o,target:S}),(0,i.sample)({clock:n,target:m}),(0,i.sample)({clock:c,target:v}),(0,i.sample)({clock:d,target:E}),(0,i.sample)({clock:l,target:g}),(0,i.sample)({clock:_,target:h}),{fireGetById:t,fireGetFromOwner:r,fireGetFeedBlock:s,fireCreate:o,fireEdit:n,fireBatchEdit:c,fireDelete:d,fireSaveCustomCover:l,fireReorder:_,getByIdFx:p,getFromOwnerFx:u,getFeedBlockFx:f,createFx:S,editFx:m,batchEditFx:v,deleteFx:E,saveCustomCoverFx:g,reorderFx:h}}},387200:(e,t,r)=>{r.d(t,{PHOTO_ALBUM_COVER_MIN_WIDTH:()=>i,getPhotoSize:()=>a});const i=200;function a(e,t){if(!e?.sizes?.length)return"";const r=[...e.sizes].sort(((e,t)=>e.width-t.width));let i=r.find((e=>e.width>=t));return i?.url?i.url:(i=r.reverse().find((e=>e.width<t)),i?.url?i.url:"")}},616220:(e,t,r)=>{r.d(t,{apiPollsCreate:()=>s,apiPollsGetById:()=>a});var i=r(957994);function a(e){return(0,i.api)("polls.getById",e)}function s(e){return(0,i.api)("polls.create",e)}},49819:(e,t,r)=>{r.d(t,{createPollsService:()=>s});var i=r(32489),a=r(616220);const s=({domain:e})=>{const t=e.createEvent("fire/pollsGetById"),r=e.createEvent("fire/pollsCreate"),s=e.createEffect("fx/pollsGetById"),o=e.createEffect("fx/pollsCreate");return s.use(a.apiPollsGetById),o.use(a.apiPollsCreate),(0,i.sample)({clock:t,target:s}),(0,i.sample)({clock:r,target:o}),{fireGetById:t,fireCreate:r,getByIdFx:s,createFx:o}}},554731:(e,t,r)=>{r.d(t,{HIDE_TOOLTIP_TIMEOUT:()=>i,OPENED_REACTED_USERS_DEFAULT_REACTION_ID:()=>l,REACTION_ID_DEFAULT:()=>s,REACTION_ID_MAX:()=>o,REACTION_ID_MIN:()=>n,REACTION_ID_UNSET:()=>c,REACTION_SET_ITEMS_MIN_COUNT:()=>d,SHOW_TOOLTIP_TIMEOUT:()=>a});const i=600,a=140,s=0,o=7,n=0,c=void 0,d=2,l=s},888065:(e,t,r)=>{r.d(t,{reactionCountsBrandUnwrap:()=>a,reactionCountsBrandWrap:()=>s});var i=r(672330);const a=e=>(0,i.unwrap)(e),s=e=>(0,i.wrap)(e)},369296:(e,t,r)=>{r.d(t,{areCountersEqual:()=>A,calcCounters:()=>h,calcCountersSum:()=>y,calcCountersWeightedSum:()=>T,counterForReactionId:()=>I,getDefaultReaction:()=>d,getDefaultReactionTitle:()=>l,getReaction:()=>c,hasReactionsForCounts:()=>k,isReactionIdSet:()=>u,isReactionIdUnset:()=>f,isUnknownObject:()=>n,isValidReactionId:()=>S,parseReactionId:()=>m,parseReactionIdOrUnset:()=>v,parseReactionMenuConfig:()=>g,prepareReactionMenuSet:()=>p,validateReactionSetPayloaditems:()=>E});var i=r(554731),a=r(888065),s=r(8520);const o=Number.isInteger||(e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e),n=e=>null!==e&&"object"==typeof e,c=(e,t)=>e.itemsById[t],d=e=>c(e,i.REACTION_ID_DEFAULT),l=e=>d(e)?.title,_=(e,t)=>0===e.length?"":((e,t,r=!0)=>e.reduce(((e,i)=>{const a=t(i),s=t(e);return s===a?r?e:i:s<a?e:i})))(e,(e=>(t.width-e.width)**2+(t.height-e.height)**2),!1).url,p=(e,t,r)=>{const i=t.map((({asset:e,color_sets:t,id:i,score:a,title:s})=>({animationURL:e.animation_url||void 0,backgroundColor:t?.background,id:i,imageMenuURL:_(e.images,r.imageMenuSize),imagePreviewURL:"imagePreviewSize"in r?_(e.images,r.imagePreviewSize):void 0,imageStoryPanelURL:"imageStoryPanelSize"in r?_(e.images,r.imageStoryPanelSize):void 0,imageStoryPreviewURL:"imageStoryPreviewSize"in r?_(e.images,r.imageStoryPreviewSize):void 0,score:a,title:s,titleColor:t?.foreground}))),a={};return i.forEach((e=>{a[e.id]=e})),{id:e,items:i,itemsById:a}},u=e=>e!==i.REACTION_ID_UNSET,f=e=>e===i.REACTION_ID_UNSET,S=e=>o(e)&&e>=i.REACTION_ID_MIN&&e<=i.REACTION_ID_MAX,m=e=>{const t=parseInt(e,10);return S(t)?{isValid:!0,value:t}:{isValid:!1}},v=e=>{const t=m(e);return t.isValid?t.value:i.REACTION_ID_UNSET},E=(e,t)=>{if(e.length<i.REACTION_SET_ITEMS_MIN_COUNT)return{error:new Error(`Invalid reactions items count in set '${t}': ${e.length}`)}},g=e=>{if(!n(e))return;const t={},{animationShowStaticAfterEnd:r,menuShowDelay:a,openedDefaultReactionId:s,reportJsErrors:o}=e;return"number"!=typeof a&&void 0!==a||(t.menuShowDelay=a),"boolean"==typeof r&&(t.animationShowStaticAfterEnd=r),"boolean"==typeof o&&(t.reportJsErrors=o),"number"==typeof s||null===s?null===s?t.openedDefaultReactionId=void 0:S(s)&&(t.openedDefaultReactionId=s):t.openedDefaultReactionId=i.OPENED_REACTED_USERS_DEFAULT_REACTION_ID,t},h=(e,t)=>{const r=(0,a.reactionCountsBrandWrap)({});return Object.entries((0,a.reactionCountsBrandUnwrap)(e)).forEach((([e,i])=>{const a=e,s=t?.itemsById?.[a]?.score??1;r[a]=s*(i||0)})),r},y=e=>Object.values((0,a.reactionCountsBrandUnwrap)(e)).reduce(((e,t)=>e+(t||0)),0),T=e=>y((0,a.reactionCountsBrandWrap)(e)),k=e=>y(e)>0,I=(e,t)=>e[t]??void 0,A=(e,t)=>e&&t?(0,s.isEqual)(e,t):e===t},672330:(e,t,r)=>{r.d(t,{unwrap:()=>i,wrap:()=>a});const i=e=>e,a=e=>e},913885:(e,t,r)=>{r.d(t,{apiStatsTrackEvents:()=>a});var i=r(957994);function a(e){return(0,i.api)("stats.trackEvents",e)}},809152:(e,t,r)=>{r.d(t,{STATS_EVENT_TYPE_STORIES_VIEWER_NAVIGATION:()=>i,STATS_EVENT_TYPE_STORIES_VIEWING_START_TIME:()=>a,STATS_EVENT_TYPE_STORY_LINK_VIEW:()=>s,STATS_EVENT_TYPE_VIDEO_ONBOARDING:()=>o});const i="stories_viewer_navigation",a="stories_viewing_start_time",s="story_link_view",o="video_onboarding"},744030:(e,t,r)=>{r.d(t,{createStatsService:()=>s});var i=r(32489),a=r(913885);const s=({domain:e})=>{const t=e.createEvent("fire/statsTrackEvents"),r=e.createEffect("fx/statsTrackEvents");return r.use(a.apiStatsTrackEvents),(0,i.sample)({clock:t,target:r}),{fireTrackEvents:t,trackEventsFx:r}}},288191:(e,t,r)=>{r.d(t,{apiStoriesAskQuestion:()=>T,apiStoriesBanOwner:()=>N,apiStoriesBanQuestionAuthor:()=>I,apiStoriesCreatePostponed:()=>G,apiStoriesDelete:()=>y,apiStoriesDeleteQuestion:()=>k,apiStoriesGet:()=>s,apiStoriesGetArchive:()=>d,apiStoriesGetById:()=>n,apiStoriesGetDetailedStats:()=>S,apiStoriesGetDiscover:()=>c,apiStoriesGetPhotoUploadServer:()=>R,apiStoriesGetQuestions:()=>u,apiStoriesGetReplies:()=>_,apiStoriesGetStats:()=>f,apiStoriesGetVideoUploadServer:()=>b,apiStoriesGetViewers:()=>l,apiStoriesGetWithPrefetch:()=>o,apiStoriesHideAllReplies:()=>D,apiStoriesHidePrivacyBlock:()=>h,apiStoriesHideReply:()=>x,apiStoriesMarkNotInterested:()=>v,apiStoriesMarkSeen:()=>g,apiStoriesMarkSkipped:()=>m,apiStoriesSave:()=>O,apiStoriesSearch:()=>E,apiStoriesSeenReplies:()=>p,apiStoriesSetDiscoverVisible:()=>P,apiStoriesSubscribeUserToApp:()=>w,apiStoriesUnbanOwner:()=>F,apiStoriesUnbanQuestionAuthor:()=>A});var i=r(957994),a=r(805658);function s(e){return(0,i.api)("stories.get",e)}function o(e){return(0,a.apiWithPrefetch)("stories.get",e)}function n(e){return(0,i.api)("stories.getById",e)}function c(e){return(0,i.api)("stories.getDiscover",e)}function d(e){return(0,i.api)("stories.getArchive",e)}function l(e){return(0,i.api)("stories.getViewers",e)}function _(e){return(0,i.api)("stories.getReplies",e)}function p(e){return(0,i.api)("stories.seenReplies",e)}function u(e){return(0,i.api)("stories.getQuestions",e)}function f(e){return(0,i.api)("stories.getStats",e)}function S(e){return(0,i.api)("stories.getDetailedStats",e)}function m(e){return(0,i.api)("stories.markSkipped",e)}function v(e){return(0,i.api)("stories.markNotInterested",e)}function E(e){return(0,i.api)("stories.search",e)}function g(e){return(0,i.api)("stories.markSeen",e)}function h(e){return(0,i.api)("stories.hidePrivacyBlock",e)}function y(e){return(0,i.api)("stories.delete",e)}function T(e){return(0,i.api)("stories.askQuestion",e)}function k(e){return(0,i.api)("stories.deleteQuestion",e)}function I(e){return(0,i.api)("stories.banQuestionAuthor",e)}function A(e){return(0,i.api)("stories.unbanQuestionAuthor",e)}function w(e){return(0,i.api)("stories.subscribeUserToApp",e)}function R(e){return(0,i.api)("stories.getPhotoUploadServer",e)}function b(e){return(0,i.api)("stories.getVideoUploadServer",e)}function O(e){return(0,i.api)("stories.save",e)}function N(e){return(0,i.api)("stories.banOwner",e)}function F(e){return(0,i.api)("stories.unbanOwner",e)}function P(e){return(0,i.api)("stories.setDiscoverVisible",e)}function x(e){return(0,i.api)("stories.hideReply",e)}function D(e){return(0,i.api)("stories.hideAllReplies",e)}function G(e){return(0,i.api)("stories.createPostponed",{...e,stories:JSON.stringify(e.stories)})}},837066:(e,t,r)=>{r.d(t,{STORIES_ARCHIVE_START_TIME:()=>s,STORIES_EDITOR_FONTS:()=>o,STORIES_MAX_COUNT_REPLIES:()=>a});var i=r(866467);const a=250,s=1559032200,o=[{label:i.getLang("stories_creator_text_label_modern"),fontFamily:"TT Firs Neue"},{label:i.getLang("stories_creator_text_label_playful"),fontFamily:"TT Knickerbockers Script"},{label:i.getLang("stories_creator_text_label_aesthetic"),fontFamily:"TT Knickerbockers Grotesk"},{label:i.getLang("stories_creator_text_label_dynamic"),fontFamily:"TT Commons Bold",fontStyle:"italic"},{label:i.getLang("stories_creator_text_label_classic"),fontFamily:"TT Barrels Trl"},{label:i.getLang("stories_creator_text_label_elegant"),fontFamily:"TT Barrels Trl Italic",fontStyle:"italic"},{label:i.getLang("stories_creator_text_label_rounded"),fontFamily:"TT Rounds Neue",textTransform:"uppercase"},{label:i.getLang("stories_creator_text_label_standard"),fontFamily:"TT Commons"},{label:i.getLang("stories_creator_text_label_handwritten"),fontFamily:"TT Lovelies Script"},{label:i.getLang("stories_creator_text_label_bookish"),fontFamily:"TT Phobos"}]},828912:(e,t,r)=>{r.d(t,{StoryFeedbackLoadMethods:()=>i,fetchFeedbackFx:()=>n,getStoryFeedbackLoadParams:()=>o});var i,a=r(564586),s=r(594496);!function(e){e[e.getViewers=0]="getViewers",e[e.getReplies=1]="getReplies",e[e.seenReplies=2]="seenReplies",e[e.getQuestions=3]="getQuestions",e[e.getDetailedStats=4]="getDetailedStats"}(i||(i={}));const o=(e,t)=>({0:{owner_id:e,story_id:t,extended:1,count:100,fields:(0,s.makeOwnerFields)(["photo_100","photo_50"])},1:{owner_id:e,story_id:t,extended:1,fields:(0,s.getStoryOwnerFields)()},2:{owner_id:e,story_id:t},3:{owner_id:e,story_id:t,extended:1,fields:(0,s.makeOwnerFields)(["domain","first_name_dat","first_name_ins","last_name_ins","last_name_dat","first_name_gen","last_name_gen"]),count:100},4:{owner_id:e,story_id:t}}),n=a.storiesDomain.createEffect({name:"fire/storiesGetFeedback",handler:({ownerId:e,storyId:t,pollId:r})=>{const i=o(e,t);return Promise.allSettled([a.storiesService.getViewersFx(i[0]),a.storiesService.getRepliesFx(i[1]),a.storiesService.getQuestionsFx(i[3]),r?a.pollsService.getByIdFx({owner_id:e,poll_id:r}):Promise.resolve(null),a.storiesService.getDetailedStatsFx(i[4])]).then((e=>e.map((e=>"fulfilled"===e.status?e?.value:null)))).finally((()=>{a.storiesService.seenRepliesFx(i[2])}))}})},41903:(e,t,r)=>{r.d(t,{STORIES_ARCHIVE_START_TIME:()=>n.STORIES_ARCHIVE_START_TIME,STORIES_EDITOR_FONTS:()=>n.STORIES_EDITOR_FONTS,STORIES_MAX_COUNT_REPLIES:()=>n.STORIES_MAX_COUNT_REPLIES,StoryFeedbackLoadMethods:()=>d.StoryFeedbackLoadMethods,apiStoriesCreatePostponed:()=>o.apiStoriesCreatePostponed,apiStoriesDelete:()=>o.apiStoriesDelete,apiStoriesGet:()=>o.apiStoriesGet,apiStoriesGetArchive:()=>o.apiStoriesGetArchive,apiStoriesGetById:()=>o.apiStoriesGetById,apiStoriesGetDiscover:()=>o.apiStoriesGetDiscover,apiStoriesGetReplies:()=>o.apiStoriesGetReplies,apiStoriesGetWithPrefetch:()=>o.apiStoriesGetWithPrefetch,apiStoriesSearch:()=>o.apiStoriesSearch,createStoriesService:()=>i.createStoriesService,decodeBase64:()=>a.decodeBase64,faveService:()=>c.faveService,fetchFeedbackFx:()=>d.fetchFeedbackFx,getStoryFeedbackLoadParams:()=>d.getStoryFeedbackLoadParams,narrativesService:()=>c.narrativesService,saveNavigationStatEvent:()=>s.saveNavigationStatEvent,saveViewerStartTime:()=>s.saveViewerStartTime,splitStoryRawId:()=>a.splitStoryRawId,statsService:()=>c.statsService,storiesService:()=>c.storiesService,userService:()=>c.userService});var i=r(898368),a=r(601686),s=r(541756),o=r(288191),n=r(837066),c=r(564586),d=r(828912)},927966:(e,t,r)=>{r.d(t,{FEED_STORIES_BLOCK_OWNER_FIELDS:()=>a,FEED_STORIES_BLOCK_OWNER_MINIMIZED_FIELDS:()=>i});const i=["photo_100"],a=["first_name","last_name","first_name_gen","last_name_gen","first_name_ins","last_name_ins","screen_name","name","is_member","is_closed","photo_50","photo_100","photo_200","friend_status","verified","sex"]},594496:(e,t,r)=>{r.d(t,{getStoryOwnerFields:()=>a,makeOwnerFields:()=>s});var i=r(927966);function a(e=!1){return s(e?i.FEED_STORIES_BLOCK_OWNER_MINIMIZED_FIELDS:i.FEED_STORIES_BLOCK_OWNER_FIELDS)}function s(e){return e.join(",")}},117295:(e,t,r)=>{r.d(t,{transformClickableStickers:()=>v});var i=r(8520),a=r(33305),s=r(540462),o=r(52905),n=r(356812),c=r(866467),d=r(387200),l=r(507838),_=r(34231),p=r(646938);const u={hashtag:p.StickerTypes.hashtag,mention:p.StickerTypes.mention,question:p.StickerTypes.question,place:p.StickerTypes.place,music:p.StickerTypes.music,story_reply:p.StickerTypes.storyReply,owner:p.StickerTypes.owner,link:p.StickerTypes.link,market_item:p.StickerTypes.marketItem,post:p.StickerTypes.post,poll:p.StickerTypes.poll,sticker:p.StickerTypes.sticker,app:p.StickerTypes.app,situational_theme:p.StickerTypes.situationalTheme,playlist:p.StickerTypes.playlist,clip:p.StickerTypes.videoButton,situational_template:p.StickerTypes.situationalTemplate,spoiler:p.StickerTypes.spoiler},f={transparent:1,blue_gradient:2,red_gradient:3,underline:4,blue:5,green:6,white:7,question_reply:8,light:9,impressive:10,dark:11,accent_background:12,accent_text:13,dark_unique:14,light_unique:15,light_text:18,dark_text:19,black:20,dark_without_bg:21,light_without_bg:22,rectangle:23,circle:24,poop:25,heart:26,star:27,album:28,horizontal:29,equalizer:30,header_meta:31},S=(e,t=6)=>isNaN(e)?NaN:Number(e.toFixed(t)),m=/^\[(id|club)(\d+)\|(.*)]$/;function v(e,t=[],r=[],v){const E=e?.clickable_stickers;if(!(E&&Object.values(E).length&&E.original_width&&E.original_height))return{original_width:0,original_height:0,stickers:[]};let g=E.original_width,h=E.original_height;Number((h/g).toFixed(2))>1.78&&(h=1.78*g);const y=(E.original_height-h)/2,T=g/100,k=h/100;return{original_width:g,original_height:h,stickers:E?.clickable_stickers?.length?E.clickable_stickers.reduce(((e,E)=>{if(!E)return e;if(v&&"situational_template"===E.type&&!(0,s.partConfigEnabled)("stories_mvk_sticker_template"))return e;if(!v&&"situational_template"===E.type&&!(0,s.partConfigEnabled)("stories_sticker_template"))return e;const{clickable_area:g=[]}=E;if(g.length<4)return e;const h=Math.sqrt(Math.pow(g[1].x-g[0].x,2)+Math.pow(g[1].y-g[0].y,2)),I=Math.sqrt(Math.pow(g[1].x-g[2].x,2)+Math.pow(g[1].y-g[2].y,2));if(!h||!I)return e;const A=g[1].x-g[0].x;let w=180*Math.acos(A/h)/Math.PI;isNaN(w)&&(w=0),g[1].y<g[0].y&&(w=-w);const R=u[E.type],b={id:E.id,type:R,top:S((g[0].y-y)/k/100),left:S(g[0].x/T/100),width:S(h/T/100),height:S(I/k/100),rotate:S(w)};E.style&&(b.style=f[E.style]);let O=!1;switch(R){case p.StickerTypes.hashtag:E.hashtag?b.hashtag=E.hashtag:O=!0;break;case p.StickerTypes.mention:{const e=E.mention?.match(m),i=e?.[1],s=Number(e?.[2]);if(!s||isNaN(s)){O=!0;break}const o="id"===i&&t.find((({id:e})=>e===s)),n=!o&&"club"===i&&r.find((({id:e})=>e===s));o?(b.mentionedPhotoUrl=o.photo_100||o.photo_50||"",b.mentionedOwnerHref=(0,a.getOwnerHref)(o),b.mentionedText=(0,a.getOwnerFullName)(o)):n?(b.mentionedText=n.name||"",b.mentionedPhotoUrl=n.photo_100||n.photo_50||"",b.mentionedOwnerHref=(0,a.getOwnerHref)(n)):O=!0;break}case p.StickerTypes.question:b.question=E.question||"";break;case p.StickerTypes.place:E.place_id?b.placeId=E.place_id:O=!0;break;case p.StickerTypes.music:if(!E.audio){O=!0;break}b.audioId=`${E.audio.owner_id}_${E.audio.id}`,b.audioData=JSON.stringify((0,n.apiAudioToAudioTuple)(E.audio)),E.audio_restrictions&&(b.audioRestriction={code:E.audio_restrictions.id,title:E.audio_restrictions.title,buttonText:E.audio_restrictions.button?.title||"",buttonUrl:E.audio_restrictions.button?.action?.url||""});break;case p.StickerTypes.playlist:if(!E.playlist){O=!0;break}b.playlistOwnerId=E.playlist.owner_id,b.playlistId=E.playlist.id,b.playlistFollowed=Boolean(E.playlist.followed);break;case p.StickerTypes.storyReply:E.owner_id&&(b.ownerId=E.owner_id),b.link=(0,a.getOwnerHref)((0,l.findOwnerById)(E.owner_id,t,r)),E.story_id?b.storyId=E.story_id:b.isExpired=!0;break;case p.StickerTypes.owner:E.owner_id&&(b.ownerId=E.owner_id),b.link=(0,a.getOwnerHref)((0,l.findOwnerById)(E.owner_id,t,r));break;case p.StickerTypes.link:E.link_object?(b.link=E.link_object.url?(0,_.wrapAwayIfExternal)(E.link_object.url):"",b.tooltipText=E.tooltip_text||""):O=!0;break;case p.StickerTypes.marketItem:if(E.subtype===p.StoryStickerSubtype.aliexpress)b.link=E.link_object?.url?(0,_.wrapAwayIfExternal)(E.link_object.url):"",b.photoUrl=E.link_object&&(0,d.getPhotoSize)(E.link_object.photo,50*devicePixelRatio)||"";else if(E.subtype===p.StoryStickerSubtype.market&&E.market_item)if(b.photoUrl=E.market_item.thumb&&(0,i.getPhotoSize)(E.market_item.thumb,50*devicePixelRatio)?.url||"",b.isRestricted=!1,v)b.link=`/product${E.market_item.owner_id}_${E.market_item.id}`;else{const e=(0,a.getOwnerHref)((0,l.findOwnerById)(E.market_item.owner_id,t,r));b.link=`${e}?w=product${E.market_item.owner_id}_${E.market_item.id}`,b.seoSlug=E.market_item.seo_slug}else O=!0;break;case p.StickerTypes.post:E.post_owner_id&&(b.postOwnerId=E.post_owner_id),E.post_id?b.postId=E.post_id:O=!0;break;case p.StickerTypes.poll:E.poll?(b.pollId=E.poll.id,b.pollOwnerId=E.poll.owner_id):O=!0;break;case p.StickerTypes.sticker:E.sticker_pack_id?(b.stickerPackId=E.sticker_pack_id,E.sticker_id&&(b.stickerId=E.sticker_id),b.tooltipText=c.getLang("stories_view_sticker_pack")):O=!0;break;case p.StickerTypes.situationalTheme:E.situational_theme_id?(b.situationalAppId=o.SITPOSTING_APP_ID,b.situationalThemeId=E.situational_theme_id):O=!0;break;case p.StickerTypes.videoButton:E.clip_id?(E.owner_id&&(b.videoOwnerId=E.owner_id),b.videoId=E.clip_id,b.videoType=E.type,b.tooltipText=c.getLang("stories_link_attach_clip")):O=!0;break;case p.StickerTypes.situationalTemplate:E.situational_theme_id?(b.situationalAppId=o.SITPOSTING_APP_ID,b.situationalThemeId=E.situational_theme_id,E.situational_replied_users&&(b.situationalRepliedUsers=E.situational_replied_users,b.situationalRepliedAvatars=E.situational_replied_users?.items?.map((e=>{const{photo_100:i}=t.find((t=>t.id===e))||{},{photo_100:a}=r.find((t=>t.id===e))||{},s=i||a;if(s)return{photo_100:s}})).filter((e=>Boolean(e)))||[])):O=!0;break;default:O=!0}return O||e.push(b),e}),[]):[]}}},937625:(e,t,r)=>{r.d(t,{transformDetailedStatsData:()=>p,transformPoll:()=>_,transformStoryQuestions:()=>l});var i=r(866467),a=r(8520),s=r(468073),o=r(33305),n=r(646938);const c=(e="",t="")=>e&&t?`${e} ${t}`:e||t,d=(e,t=32)=>(0,a.getPhotoSize)(e??[],t*window.devicePixelRatio),l=(e,t,r=0,i=0)=>(0,a.isArray)(e)&&(0,a.isArray)(t)?e.map((({id:e,is_anonymous:a,question:n,is_owner_blocked:d,is_published:l,owner_id:_})=>{const p=!a&&window.vk.id!=_&&!s.Ranges.isGroupId(r),u=!a&&window.vk.id!=_,f=t?.find((e=>e?.id===_));return{author:f?{link:(0,o.getOwnerHref)(f),name:(0,o.getOwnerFullName)(f),nameDat:c(f?.first_name_dat,f?.last_name_dat),nameGen:c(f?.first_name_gen,f?.last_name_gen),nameIns:c(f?.first_name_ins,f?.last_name_ins)}:{},canAnswer:p,canBlocked:u,id:e,isAnonymous:a,isOwnerBlocked:d,isPublished:l,ownerId:_,storyId:i,storyOwnerId:r,text:n}})):[],_=e=>{if(!e)return null;const{votes:t,id:r,owner_id:a,question:s,photo:o,background:c,can_vote:l}=e;return{ownerId:a,pollId:r,question:s,votersCountText:t?i.getLang("voting_N_voted",t):i.getLang("voting_nobody_voted"),background:o?{type:n.StoryPollBackgroundType.photo,photoUrl:d(o?.images)?.url||"",backgroundColor:o?.color||""}:"gradient"===c?.type?{type:n.StoryPollBackgroundType.gradient,angle:c.angle||0,color:c.color||"",points:c.points||[]}:{type:n.StoryPollBackgroundType.default},needShowResults:!l}},p=e=>e?{preview:e.preview||"",achievement:e.achievement||"",achievementSubtitle:e.achievement_subtitle||"",categories:e.categories?.map((e=>({title:e.header,type:e.type,lines:e.lines.map((e=>({name:e.name||"",type:e.type,counter:e.is_unavailable?i.getLang("stories_stat_off"):String(e.counter??""),unavailable:e.is_unavailable})))})))||[]}:null},591024:(e,t,r)=>{r.d(t,{transformDetailedStatsData:()=>o.transformDetailedStatsData,transformGetNarrativesResponseToLegacy:()=>i.transformGetNarrativesResponseToLegacy,transformNarrativeGetApiResponseToLegacyFormat:()=>s.transformNarrativeGetApiResponseToLegacyFormat,transformPoll:()=>o.transformPoll,transformStoriesToLegacy:()=>s.transformStoriesToLegacy,transformStoryArchiveResponse:()=>a.transformStoryArchiveResponse,transformStoryGetApiResponseToLegacyFormat:()=>s.transformStoryGetApiResponseToLegacyFormat,transformStoryQuestions:()=>o.transformStoryQuestions});r(117295);var i=r(715614),a=r(506492),s=r(529371),o=r(937625)},529371:(e,t,r)=>{r.d(t,{transformNarrativeGetApiResponseToLegacyFormat:()=>g,transformStoriesToLegacy:()=>I,transformStoryGetApiResponseToLegacyFormat:()=>E});var i=r(891281),a=r(317929),s=r(418562),o=r(309205),n=r(33305),c=r(908671),d=r(646938),l=r(866467),_=r(8520),p=r(898848),u=r(507838),f=r(117295),S=r(715614),m=r(369296),v=r(540462);function E(e,t,r){const{items:i,profiles:a=[],groups:o=[],reaction_sets:n}=e,c=i.map((e=>{const i=e.owner_id||e.stories?.[0]?.owner_id||0,c=(0,u.findOwnerById)(i,a,o)||{id:i},l=(0,v.partConfigEnabled)("stories_preview_for_minimized")&&"feed"===t&&"discover"===e.type?[]:e.stories?.filter(Boolean)||[],_=t===d.StoryListName.feed||t===d.StoryListName.discover||t===d.StoryListName.apps,p={id:e.id||(0,s.default)(),author:y(c,a,l[0]?.also_subscribed),has_unseen:e.has_unseen,items:l.map((e=>k(e,c,a,o,r,t))),track_code:e.track_code,can_blacklist:_,app:e.app&&h(e.app),type:e.type,send_mask_hash:"",remove_from_blacklist_hash:"",is_narrative:!1,is_apps:e.type===d.StoryBlockType.appGroupedStories,next_from:""};if(e.grouped?.length&&(p.grouped=E({items:e.grouped,profiles:a,groups:o},t,r)),n&&(p.reaction_set=A(n)),r){const i=function(e,t,r,i,a,s){const o=e.stories?.[0],n=e.app;if("app_grouped_stories"!==e.type||!o)return;const c=k(o,t,r,i,a,s);c.raw_id=c.raw_id+"&meta",c.is_apps_meta_story=!0,n&&(c.app=h(n));return c}(e,c,a,o,r,t);i&&p.items.push(i)}return p}));return c}function g(e,t,r){const{items:i,profiles:a=[],groups:o=[]}=e;return i.map((e=>{const i=e.owner_id||e.stories?.[0]?.owner_id||0,n=(0,u.findOwnerById)(i,a,o)||{id:i},c=e.stories?.filter(Boolean)||[];return{id:(0,s.default)(),author:y(n,a,c[0]?.also_subscribed),items:c.map((e=>k(e,n,a,o,r,t))),can_blacklist:!1,type:d.StoryBlockType.stories,send_mask_hash:"",remove_from_blacklist_hash:"",is_apps:!1,next_from:"",is_narrative:!0,narrative:(0,S.transformNarrative)(e,n)}}))}function h(e){return{url:`/app${e.id}`,name:e.title,photoUrl:e.icon_139||e.icon_150||e.icon_75||""}}function y(e,t=[],r){const i=e.verified?'<div class="page_verified"></div>':"",a=function(e,t=[]){if(!e)return;const r=[],i=e.user_ids||[];return i.forEach((e=>{const i=t.find((t=>t.id===e));i&&r.push({photo_url:i.photo_50||i.photo_100||"",href:(0,n.getOwnerHref)(i),name:i.first_name||"",sex:i.sex||0})})),{total_count:e.count||0,owners:r}}(r,t);if((0,n.isOwnerUser)(e)){const t=e.id,r=e.first_name||"",s=e.last_name||"",o=e.first_name_gen||"",c=e.last_name_gen||"",d=e.first_name_ins||"",l=(0,n.getOwnerFullName)(e),p=s?`${o} ${c}`:o;return{id:t,name:(0,_.escape)(l),name_get:(0,_.escape)(p),firstName:(0,_.escape)(r),first_name_gen:(0,_.escape)(o),first_name_ins:(0,_.escape)(d),photo:e.photo_100||e.photo_50||"",href:(0,n.getOwnerHref)(e),verify:i,gender:e.sex||0,can_follow:R(e),also_subscribed:a}}const s=-e.id,o=(0,_.escape)(e.name||"");return{id:s,name:o,name_get:o,firstName:o,first_name_gen:o,first_name_ins:o,photo:e.photo_100||e.photo_50||"",href:(0,n.getOwnerHref)(e),verify:i,gender:0,can_follow:R(e),also_subscribed:a}}function T(e){if(!(e?.files&&e?.first_frame&&e.duration&&e.ov_id))return;return{sources:Object.keys(e.files).reduce(((t,r)=>{if(r.startsWith("mp4_"))return t[a.VideoFormat.MPEG]||(t[a.VideoFormat.MPEG]={}),t[a.VideoFormat.MPEG][r.replace("mp4_","")]=String(e.files?.[r]??""),t;const i={type:"url",url:String(e.files?.[r]??"")};switch(r){case"hls":t[a.VideoFormat.HLS]=i;break;case"dash_sep":t[a.VideoFormat.DASH_SEP]=i;break;case"dash_webm":t[a.VideoFormat.DASH_WEBM]=i}return t}),{}),thumbUrl:(0,_.getPhotoSize)(e?.first_frame,400)?.url??"",duration:e.duration,unitedVideoId:Number(e.ov_id??0),title:e.title??""}}function k(e,t,r,i,a,s){let S,m;if(e.mask?.owner_id){const t=(0,u.findOwnerById)(e.mask?.owner_id,r,i);t&&(S=t.screen_name,(0,n.isOwnerUser)(t)&&(m=t.sex))}const v=b(t,e),E=!v&&(s===d.StoryListName.feed||s===d.StoryListName.apps||s===d.StoryListName.discover);return{owner_id:e.owner_id,raw_id:`${e.owner_id}_${e.id}`,date:(0,l.getSmDate)(e.date||0),time:e.date||0,type:P(e),unread:!e.seen,canLike:Boolean(e.can_like),can_comment:O(e),can_share:Boolean(e.can_share),can_remove:N(e,t),can_delete_with_reason:Boolean(e.can_delete_with_reason),can_manage:v,can_ask:Boolean(e.can_ask),can_ask_anonymous:Boolean(e.can_ask_anonymous),canAddToNarrative:e.can_use_in_narrative,stats:{follow:{event_type:"subscribe",rhash:""},url_view:{event_type:"url_view",rhash:""}},isLiked:Boolean(e.is_liked),likesCount:e.likes_count||0,reaction_set_id:e.reaction_set_id||"",user_reaction_id:e.user_reaction_id||0,preview_url:e.blurred_preview||"",needMute:Boolean(e.need_mute),muteReply:Boolean(e.mute_reply),isPromo:Boolean(e.is_promo),isProfileQuestion:Boolean(e.is_profile_question),promoCaption:e.is_promo&&e.caption||"",track_code:e.track_code||"",video:{owner_id:e.owner_id,video_id:e.video?.id||0,duration:e.video?.duration||0},vkVideoConfig:T(e.video),link:e.link?{text:e.link.text||"",url:e.link.url||""}:void 0,isPartOfNarrative:Boolean(e.narratives_count),report_hash:"",maskOwnerDomain:S,maskOwnerSex:m,can_hide_reply:F(e,r,i),noSound:Boolean(e.no_sound),isNewQuestions:v&&Boolean(e.questions?.new),views:Boolean(e.views)?(0,c.formatCount)(e.views||0):"",needShowEmptyStats:Boolean(e.need_show_empty_stats),is_expired:Boolean(e.is_expired),is_deleted:Boolean(e.is_deleted),is_private:!Boolean(e.can_see),isAds:Boolean(e.is_ads),isOneTime:Boolean(e.is_one_time),isOneTimeSeen:Boolean(e.is_one_time)&&!Boolean(e.can_see),seenProgress:0,replies:e.replies?.count?(0,c.formatCount)(e.replies.count):"",replies_new_counter:e.replies?.new||0,clickable_stickers:(0,f.transformClickableStickers)(e,r,i,a),canMarkNotInterested:E,photo_url:e.photo?.sizes&&(0,_.getPhotoSize)(e.photo.sizes,(0,p.isRetina)()?1200:600)?.url||"",small_preview:w(e,a),video_url:e.video?.files?(0,o.getVideoBestQualityUrl)(e.video.files):"",first_frame:e.video?.first_frame&&(0,_.getPhotoSize)(e.video?.first_frame,800)?.url||"",is_apps_meta_story:!1,repliesCountText:"",authorId:0,isMusicCover:!1,is_authors_ads:e.is_authors_ads,advertiser_info_url:e.advertiser_info_url,ad_marker:e.ad_marker,caption:e.caption,is_best_friends_privacy:e.is_best_friends_privacy}}function I(e,t,r){const{items:i,profiles:a,groups:o,reaction_sets:n}=e,c=i[0]?.owner_id||0,l=(0,u.findOwnerById)(c,a,o)||{id:c},_=t===d.StoryListName.feed||t===d.StoryListName.discover||t===d.StoryListName.apps,p=i.some((e=>!e.seen)),f={id:(0,s.default)(),author:y(l,a,i[0]?.also_subscribed),has_unseen:p,items:i.map((e=>k(e,l,a,o,r,t))),track_code:"",can_blacklist:_,type:d.StoryBlockType.stories,send_mask_hash:"",remove_from_blacklist_hash:"",is_narrative:!1,is_apps:!1,next_from:""};return n&&(f.reaction_set=A(n)),[f]}function A(e){return e.map((({id:e,items:t})=>(0,m.prepareReactionMenuSet)(e,t.map((e=>({...e,id:e.id}))),{imageMenuSize:{width:96,height:96},imagePreviewSize:{width:32,height:32},imageStoryPanelSize:{width:128,height:128},imageStoryPreviewSize:{width:40,height:40}})))}function w(e,t=!1){const r=e.photo?.sizes;if(r)return(0,_.getPhotoSize)(r,t?10:(0,p.isRetina)()?600:300)?.url||"";const i=e.video?.first_frame;return i&&(0,_.getPhotoSize)(i,t?10:320)?.url||""}function R(e){return(0,n.isOwnerUser)(e)?window.vk.id!==e.id&&(e.friend_status===i.FriendsFriendStatusStatusEnumNames.NOT_A_FRIEND||e.friend_status===i.FriendsFriendStatusStatusEnumNames.INCOMING_REQUEST):!e.is_member&&!e.is_closed}function b(e,t){return(0,n.isOwnerUser)(e)?t.owner_id===e.id&&window.vk.id===e.id:t.owner_id===-e.id&&(t.is_ads?Boolean(e.is_advertiser):Boolean(e.is_admin))}function O(e){return e.can_comment?Boolean(e.can_comment):"live_active"===e.type&&Boolean(e.video?.can_comment)}function N(e,t){return!e.is_deleted&&(!e.can_delete_with_reason&&(!!e.can_delete||b(t,e)&&("photo"===e.type||"video"===e.type)))}function F(e,t,r){if(!e.parent_story_owner_id||!e.parent_story_id)return!1;const i=window.vk.id,a=e.parent_story_owner_id;if(a===i)return!0;const s=(0,u.findOwnerById)(a,t,r);return!!(s&&(0,n.isOwnerGroup)(s)&&s.is_admin)}function P(e){return"photo"===e.type?d.StoryType.PHOTO:"video"===e.type?d.StoryType.VIDEO:"live_active"===e.type||"live_finished"===e.type?d.StoryType.LIVE:d.StoryType.PHOTO}},715614:(e,t,r)=>{r.d(t,{transformGetNarrativesResponseToLegacy:()=>c,transformNarrative:()=>n});var i=r(8520),a=r(33305),s=r(507838),o=r(506492);function n(e,t){const r=`${e.owner_id}_${e.id}`,s=(0,a.isOwnerGroup)(t),n=s&&Boolean(t.is_closed),c={id:e.id,rawId:r,ownerId:e.owner_id,ownerName:(0,i.escape)((s?t.name:(0,a.getOwnerFullName)(t))||""),ownerShortName:(0,i.escape)((s?t.name:(0,a.getOwnerShortName)(t))||""),ownerUrl:(0,a.getOwnerHref)(t),ownerPath:`${s?"club":"id"}${e.owner_id}`,ownerAvatarUrl:t.photo_100||t.photo_50||"",title:(0,i.escape)(e.title),isBookmarked:e.is_favorite,bookmarkHash:"",reportHash:"",canEdit:d(e,t),editHash:"",canView:e.can_see,storiesCount:e.story_ids?.length||0,isOwnerClosedGroup:n,isGroupEditor:n&&Boolean(t.is_admin),url:`${window.location.origin}/narrative${r}`,storyIds:e.story_ids||[],stories:e.stories?.map(o.transformStoryArchive)||[],isDeleted:e.is_delete,date:"",coverUrl:""};if(e.cover){Object.assign(c,{coverUrl:e.cover.cropped_sizes&&(0,i.getPhotoSize)(e.cover.cropped_sizes,300)?.url||"",coverCrop:{x:e.cover.crop_x||0,y:e.cover.crop_y||0,width:e.cover.crop_width||0,height:e.cover.crop_height||0}}),e.cover.custom_photo&&(c.customCover=function(e,t=[]){if(!e)return;return{photoId:e.id,originalPhotoUrl:e.orig_photo?.url||e.sizes&&(0,i.getPhotoSize)(e.sizes,600)?.url||"",previewUrl:t&&(0,i.getPhotoSize)(t,300)?.url||e.sizes&&(0,i.getPhotoSize)(e.sizes,300)?.url||""}}(e.cover.custom_photo,e.cover.cropped_sizes));const t=e.cover.cover_story_id;if(t){Object.assign(c,{coverStoryId:t,coverStoryRawId:`${e.owner_id}_${t}`});const r=e.stories?.find((e=>e?.id===t));r&&(c.coverStory=(0,o.transformStoryArchive)(r))}}return c}function c(e){const{items:t,profiles:r=[],groups:i=[]}=e;return t?.length?t.reduce(((e=[],t)=>{if(!t)return e;const a=(0,s.findOwnerById)(t.owner_id,r,i)||{id:t.owner_id};if(!a)return e;const o=n(t,a);return o?e.concat(o):e}),[]):[]}function d(e,t){const r=Boolean(e.can_delete);let i=!1;if((0,a.isOwnerGroup)(t)){if(e.owner_id!==-t.id)return!1;i=Boolean(t.is_admin)}else{if(e.owner_id!==t.id)return!1;i=window.vk.id===t.id}return!!i&&r}},506492:(e,t,r)=>{r.d(t,{transformStoryArchive:()=>n,transformStoryArchiveResponse:()=>c});var i=r(309205),a=r(8520),s=r(41903),o=r(34231);function n(e){const t=Math.max(e.date?Math.ceil(new Date(1e3*e.date).setUTCHours(0,0,0,0)/1e3):0,s.STORIES_ARCHIVE_START_TIME),r=e.photo?.sizes||e.video?.image,n={id:e.id,rawId:`${e.owner_id}_${e.id}`,listId:`archive${e.owner_id}_${t}`,time:Number(e.date),preview:r&&(0,a.getPhotoSize)(r,350)?.url||"",originalPreviewUrl:r&&(0,a.getPhotoSize)(r,600)?.url||""};return"video"===e.type&&e.video&&Object.assign(n,{videoUrl:e.video.files&&(0,i.getVideoBestQualityUrl)(e.video.files)||"",duration:e.video.duration}),e.link&&Object.assign(n,{linkUrl:(0,o.wrapAwayIfExternal)(e.link.url)||"",linkText:e.link.text||"",linkType:""}),n}function c(e){const{items:t=[]}=e;return t.filter(Boolean).map(n)}},898368:(e,t,r)=>{r.d(t,{createStoriesService:()=>c});var i=r(32489),a=r(288191),s=r(80963),o=r(755812),n=r(869071);const c=({domain:e})=>{const t=e.createEvent("fire/storiesGet"),r=e.createEvent("fire/storiesGetById"),c=e.createEvent("fire/storiesGetArchive"),d=e.createEvent("fire/storiesGetViewers"),l=e.createEvent("fire/storiesGetReplies"),_=e.createEvent("fire/storiesSeenReplies"),p=e.createEvent("fire/storiesGetQuestions"),u=e.createEvent("fire/storiesGetStats"),f=e.createEvent("fire/storiesGetDetailedStats"),S=e.createEvent("fire/storiesMarkSkipped"),m=e.createEvent("fire/storiesMarkNotInterested"),v=e.createEvent("fire/storiesMarkSeen"),E=e.createEvent("fire/storiesHidePrivacyBlock"),g=e.createEvent("fire/storiesDelete"),h=e.createEvent("fire/storiesAskQuestion"),y=e.createEvent("fire/storiesDeleteQuestion"),T=e.createEvent("fire/storiesBanQuestionAuthor"),k=e.createEvent("fire/storiesUnbanQuestionAuthor"),I=e.createEvent("fire/storiesSubscribeUserToApp"),A=e.createEvent("fire/storiesGetPhotoUploadServer"),w=e.createEvent("fire/storiesGetVideoUploadServer"),R=e.createEvent("fire/storiesSave"),b=e.createEvent("fire/storiesSearch"),O=e.createEvent("fire/storiesUnbanOwner"),N=e.createEvent("fire/storiesBanOwner"),F=e.createEvent("fire/storiesSetDiscoverVisible"),P=e.createEvent("fire/storiesHideReply"),x=e.createEvent("fire/storieHideAllReplies"),D=e.createEffect("fx/storiesGet"),G=e.createEffect("fx/storiesGetById"),C=e.createEffect("fx/storiesGetArchive"),L=e.createEffect("fx/storiesGetViewers"),B=e.createEffect("fx/storiesGetReplies"),U=e.createEffect("fx/storiesSeenReplies"),V=e.createEffect("fx/storiesGetQuestions"),M=e.createEffect("fx/storiesGetStats"),W=e.createEffect("fx/storiesGetDetailedStats"),H=e.createEffect("fx/storiesMarkSkipped"),K=e.createEffect("fx/storiesMarkNotInterested"),z=e.createEffect("fx/storiesMarkSeen"),Q=e.createEffect("fx/storiesHidePrivacyBlock"),Y=e.createEffect("fx/storiesDelete"),$=e.createEffect("fx/storiesAskQuestion"),q=e.createEffect("fx/storiesDeleteQuestion"),j=e.createEffect("fx/storiesBanQuestionAuthor"),J=e.createEffect("fx/storiesUnbanQuestionAuthor"),X=e.createEffect("fx/storiesSubscribeUserToApp"),Z=e.createEffect("fx/storiesGetPhotoUploadServer"),ee=e.createEffect("fx/storiesGetVideoUploadServer"),te=e.createEffect("fx/storiesSave"),re=e.createEffect("fx/storiesSearch"),ie=e.createEffect("fx/storiesUnbanOwner"),ae=e.createEffect("fx/storiesBanOwner"),se=e.createEffect("fx/storiesSetDiscoverVisible"),oe=e.createEffect("fx/storiesHideReply"),ne=e.createEffect("fx/storiesHideAllReplies"),ce=(0,s.createFriendsAddFx)({domain:e}),de=(0,s.createFriendsDeleteFx)({domain:e}),le=(0,o.createGroupsJoinFx)({domain:e}),_e=(0,o.createGroupsLeaveFx)({domain:e});return D.use(a.apiStoriesGet),G.use(a.apiStoriesGetById),C.use(a.apiStoriesGetArchive),L.use(a.apiStoriesGetViewers),B.use(a.apiStoriesGetReplies),U.use(a.apiStoriesSeenReplies),V.use(a.apiStoriesGetQuestions),M.use(a.apiStoriesGetStats),W.use(a.apiStoriesGetDetailedStats),H.use(a.apiStoriesMarkSkipped),K.use(a.apiStoriesMarkNotInterested),z.use(a.apiStoriesMarkSeen),Q.use(a.apiStoriesHidePrivacyBlock),Y.use(a.apiStoriesDelete),$.use(a.apiStoriesAskQuestion),q.use(a.apiStoriesDeleteQuestion),j.use(a.apiStoriesBanQuestionAuthor),J.use(a.apiStoriesUnbanQuestionAuthor),X.use(a.apiStoriesSubscribeUserToApp),Z.use(a.apiStoriesGetPhotoUploadServer),ee.use(a.apiStoriesGetVideoUploadServer),te.use(a.apiStoriesSave),re.use(a.apiStoriesSearch),ae.use(a.apiStoriesBanOwner),ie.use(a.apiStoriesUnbanOwner),se.use(a.apiStoriesSetDiscoverVisible),oe.use(a.apiStoriesHideReply),ne.use(a.apiStoriesHideAllReplies),(0,n.connectTrackTmrGroupsJoin)(le),(0,i.sample)({clock:t,target:D}),(0,i.sample)({clock:r,target:G}),(0,i.sample)({clock:c,target:C}),(0,i.sample)({clock:d,target:L}),(0,i.sample)({clock:l,target:B}),(0,i.sample)({clock:_,target:U}),(0,i.sample)({clock:p,target:V}),(0,i.sample)({clock:u,target:M}),(0,i.sample)({clock:f,target:W}),(0,i.sample)({clock:S,target:H}),(0,i.sample)({clock:m,target:K}),(0,i.sample)({clock:v,target:z}),(0,i.sample)({clock:E,target:Q}),(0,i.sample)({clock:g,target:Y}),(0,i.sample)({clock:h,target:$}),(0,i.sample)({clock:y,target:q}),(0,i.sample)({clock:T,target:j}),(0,i.sample)({clock:k,target:J}),(0,i.sample)({clock:I,target:X}),(0,i.sample)({clock:A,target:Z}),(0,i.sample)({clock:w,target:ee}),(0,i.sample)({clock:R,target:te}),(0,i.sample)({clock:b,target:re}),(0,i.sample)({clock:O,target:ie}),(0,i.sample)({clock:N,target:ae}),(0,i.sample)({clock:F,target:se}),(0,i.sample)({clock:P,target:oe}),(0,i.sample)({clock:x,target:ne}),{fireGet:t,fireGetById:r,fireGetArchive:c,fireGetViewers:d,fireGetReplies:l,fireSeenReplies:_,fireGetQuestions:p,fireGetStats:u,fireGetDetailedStats:f,fireMarkSkipped:S,fireMarkNotInterested:m,fireMarkSeen:v,fireHidePrivacyBlock:E,fireDelete:g,fireAskQuestion:h,fireDeleteQuestion:y,fireBanQuestionAuthor:T,fireUnbanQuestionAuthor:k,fireSubscribeUserToApp:I,fireGetPhotoUploadServer:A,fireGetVideoUploadServer:w,fireSave:R,fireSearch:b,fireUnbanOwner:O,fireBanOwner:N,fireSetDiscoverVisible:F,fireHideReply:P,fireHideAllReplies:x,getFx:D,getByIdFx:G,getArchiveFx:C,getViewersFx:L,getRepliesFx:B,seenRepliesFx:U,getQuestionsFx:V,getStatsFx:M,getDetailedStatsFx:W,markSkippedFx:H,markNotInterestedFx:K,markSeenFx:z,hidePrivacyBlockFx:Q,deleteFx:Y,askQuestionFx:$,deleteQuestionFx:q,banQuestionAuthorFx:j,unbanQuestionAuthorFx:J,subscribeUserToAppFx:X,getPhotoUploadServerFx:Z,getVideoUploadServerFx:ee,saveFx:te,searchFx:re,unbanOwnerFx:ie,banOwnerFx:ae,setDiscoverVisibleFx:se,hideReplyFx:oe,hideAllRepliesFx:ne,friendsAddFx:ce,friendsDeleteFx:de,groupsJoinFx:le,groupsLeaveFx:_e}}},564586:(e,t,r)=>{r.d(t,{faveService:()=>m,narrativesService:()=>S,pollsService:()=>v,statsService:()=>f,storiesDomain:()=>p,storiesService:()=>u,userService:()=>E});var i=r(32489),a=r(41903),s=r(744030),o=r(942838),n=r(733498),c=r(455673),d=r(373237),l=r(49819),_=r(136335);const p=(0,i.createDomain)("stories"),u=(0,a.createStoriesService)({domain:p}),f=(0,s.createStatsService)({domain:p}),S=(0,o.createNarrativesService)({domain:p}),m=((0,n.createLikesService)({domain:p}),(0,c.createMessagesService)({domain:p}),(0,d.createFaveService)({domain:p})),v=(0,l.createPollsService)({domain:p}),E=(0,_.createUserService)({domain:p})},601686:(e,t,r)=>{function i(e){return(e?.split("_")??[]).map(Number)}function a(e,t="windows-1251"){return new TextDecoder(t).decode(function(e){const t=atob(e);return Uint8Array.from(t,(e=>e.codePointAt(0)||0))}(e))}r.d(t,{decodeBase64:()=>a,splitStoryRawId:()=>i})},901089:(e,t,r)=>{r.d(t,{getStoryList:()=>s,removeStoryList:()=>o,setApiStoryList:()=>n,setStoryList:()=>a,transformApiStoryList:()=>c});var i=r(591024);function a(e,t){window.cur[`stories_list_${e}`]=t}function s(e){return window.cur[`stories_list_${e}`]}function o(e){delete window.cur[`stories_list_${e}`]}function n(e,t){a(e,c(e,t))}function c(e,t){return(0,i.transformStoryGetApiResponseToLegacyFormat)(t,e,!1)}},764505:(e,t,r)=>{r.d(t,{clean:()=>i.clean,escapeRE:()=>i.escapeRE,isElement:()=>i.isElement,isRetina:()=>i.isRetina,replaceEntities:()=>i.replaceEntities});var i=r(898848)},965440:(e,t,r)=>{r.d(t,{apiAudioToAudioTuple:()=>c});var i=r(8520),a=r(764505),s=r(133326),o=r(854950);const n=new WeakMap,c=(e,{useCache:t=!1}={})=>{if(!e)return null;if(t){const t=n.get(e);if(t)return t}const r=[e.id,e.owner_id,e.url||"",(0,a.clean)(e.title),(0,a.clean)(e.artist||e.performer||""),e.duration,e.album_id||0,0,"",e.lyrics_id||0,0,"",d(e),(0,s.getAudioHashesString)({addHash:e.access_key,editHash:e.access_key,actionHash:e.access_key,deleteHash:e.access_key,replaceHash:e.access_key,urlHash:e.access_key,restoreHash:e.access_key}),l(e),e.ads||{},(0,a.clean)(e.subtitle||""),e.main_artists||"",e.featured_artists||"",!!e.album&&[e.album?.owner_id,e.album?.id,e.album?.access_key],e.track_code||"",e.content_restricted||0,e.album_part_number||0,!0,e.access_key||"",e.audio_chart_info||!1,e.release_audio_id||""];return t&&n.set(e,r),r};function d(e){const{podcast_info:t}=e,r=Boolean(t);return{podcast:r,dislike:e.dislike,fave:r&&Boolean(t?.is_favorite)}}function l(e){const{podcast_info:t,album:r}=e;if(t){const e=t.cover;return e?.sizes&&(0,i.getPhotoSize)(e.sizes||[],(0,o.getImageMinWidth)(40))?.url||""}const a=r?.thumb;return a?a.sizes?(0,i.getPhotoSize)(a.sizes||[],(0,o.getImageMinWidth)(200))?.url||"":`${a.photo_300},${a.photo_135}`||"":""}},309205:(e,t,r)=>{function i(e){if(!e)return"";const t=/^mp4_(\d+)$/,{url:r}=Object.keys(e).reduce(((r,i)=>{const a=i.match(t);if(!a)return r;const s=Number.parseInt(a[1]);return r.quality<s&&(r.quality=s,r.url=String(e[i]??"")),r}),{url:"",quality:0});return r}r.d(t,{getVideoBestQualityUrl:()=>i})},80963:(e,t,r)=>{r.d(t,{createFriendsAddFx:()=>l,createFriendsAddListFx:()=>v,createFriendsDeleteBulkFx:()=>p,createFriendsDeleteFx:()=>_,createFriendsDeleteListFx:()=>E,createFriendsDeleteSubscriberFx:()=>y,createFriendsEditListFx:()=>g,createFriendsGetFollowersFx:()=>T,createFriendsGetFriendsDeletionSuggestionsFx:()=>c,createFriendsGetFx:()=>o,createFriendsGetListsFx:()=>a,createFriendsGetMutualFx:()=>w,createFriendsGetOnlineFx:()=>S,createFriendsGetRecentFx:()=>A,createFriendsGetRequestsFx:()=>u,createFriendsHideSuggestion:()=>R,createFriendsPrefetchCountersFx:()=>I,createFriendsPrefetchFx:()=>n,createFriendsPrefetchListsFx:()=>s,createFriendsPrefetchOnlineFx:()=>m,createFriendsPrefetchRecommendationsFx:()=>d,createFriendsPrefetchRequestsFx:()=>f,createFriendsRequestsToSubscribersFx:()=>k,createFriendsSearchFx:()=>h});var i=r(412554);const a=e=>(0,i.createApiEffect)("friends.getLists",e),s=e=>(0,i.createPrefetchEffect)("friends.getLists",e),o=e=>(0,i.createApiEffect)("friends.get",e),n=e=>(0,i.createPrefetchEffect)("friends.get",e),c=e=>(0,i.createApiEffect)("friends.getFriendsDeletionSuggestions",e),d=e=>(0,i.createPrefetchEffect)("friends.getRecommendations",e),l=e=>(0,i.createApiEffect)("friends.add",e),_=e=>(0,i.createApiEffect)("friends.delete",e),p=e=>(0,i.createApiEffect)("friends.deleteBulk",e),u=e=>(0,i.createApiEffect)("friends.getRequests",e),f=e=>(0,i.createPrefetchEffect)("friends.getRequests",e),S=e=>(0,i.createApiEffect)("friends.getOnline",e),m=e=>(0,i.createPrefetchEffect)("friends.getOnline",e),v=e=>(0,i.createApiEffect)("friends.addList",e),E=e=>(0,i.createApiEffect)("friends.deleteList",e),g=e=>(0,i.createApiEffect)("friends.editList",e),h=e=>(0,i.createApiEffect)("friends.search",e),y=e=>(0,i.createApiEffect)("friends.deleteSubscriber",e),T=e=>(0,i.createApiEffect)("friends.getFollowers",e),k=e=>(0,i.createApiEffect)("friends.requestsToSubscribers",e),I=e=>(0,i.createPrefetchEffect)("friends.getCounters",e),A=e=>(0,i.createApiEffect)("friends.getRecent",e),w=e=>(0,i.createApiEffect)("friends.getMutual",e),R=e=>(0,i.createApiEffect)("friends.hideSuggestion",e)},755812:(e,t,r)=>{r.d(t,{createGroupsEditFx:()=>n,createGroupsGetByIdFx:()=>a,createGroupsGetMembersFx:()=>_,createGroupsInviteFx:()=>d,createGroupsIsMemberFx:()=>c,createGroupsJoinFx:()=>s,createGroupsLeaveFx:()=>o,createGroupsRecallInvitationFx:()=>l});var i=r(412554);const a=e=>(0,i.createApiEffect)("groups.getById",e),s=e=>(0,i.createApiEffect)("groups.join",e),o=e=>(0,i.createApiEffect)("groups.leave",e),n=e=>(0,i.createApiEffect)("groups.edit",e),c=e=>(0,i.createApiEffect)("groups.isMember",e),d=e=>(0,i.createApiEffect)("groups.invite",e),l=e=>(0,i.createApiEffect)("groups.recallInvitation",e),_=e=>(0,i.createApiEffect)("groups.getMembers",e)},908671:(e,t,r)=>{r.d(t,{formatCount:()=>i});const i=(e,t)=>{const r=t?.separator||".",i=t?.maximumFractionDigits??1,a=t?.roundingMode||void 0,s=t?.kLimit||1e3,o=t?.mLimit||1e6,n=t?.bLimit||1e9,c=window.langConfig?.locale||"ru",d=(e,t)=>{"floor"===a&&(e=Math.floor(e*Math.pow(10,i))/Math.pow(10,i));let s=e.toFixed(i);return Number(s).toLocaleString(c).replace(/\./,r)+t};if(e>-s&&e<s)return e.toLocaleString(c);const l=e/n;if(l>=1||l<=-1)return d(e/1e9,"B");const _=e/o;if(_>=1||_<=-1)return d(e/1e6,"M");const p=e/s;return p>=1||p<=-1?d(e/1e3,"K"):String(e)}}}]);try{stManager?.done("dist/web/chunks/00937475.455f7bfd.js")}catch(e){}