"use strict";(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[84984],{908166:(e,t,i)=>{function o(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="#fff" d="m6.55 5.05 4.77 2.64a.35.35 0 0 1 0 .62l-4.77 2.64a.37.37 0 0 1-.5-.13.34.34 0 0 1-.05-.17v-5.3A.36.36 0 0 1 6.37 5c.06 0 .12.02.18.05Z"/></svg>',name:"play_marusia_foreground_16"}}i.d(t,{getIcon16PlayMarusiaForeground:()=>o})},792112:(e,t,i)=>{function o(){return{icon:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="#fff" d="M5 7.4c0-.84 0-1.26.16-1.58a1.5 1.5 0 0 1 .66-.66C6.14 5 6.56 5 7.4 5h1.2c.84 0 1.26 0 1.58.16a1.5 1.5 0 0 1 .66.66c.16.32.16.74.16 1.58v1.2c0 .84 0 1.26-.16 1.58a1.5 1.5 0 0 1-.66.66c-.32.16-.74.16-1.58.16H7.4c-.84 0-1.26 0-1.58-.16a1.5 1.5 0 0 1-.66-.66C5 9.86 5 9.44 5 8.6V7.4Z"/></svg>',name:"stop_marusia_foreground_16"}}i.d(t,{getIcon16StopMarusiaForeground:()=>o})},22285:(e,t,i)=>{function o(e,t,i,o){const r=t?"article.php":"al_articles.php";ajax.post(r,{act:"tts",article_owner_id:e.owner_id,article_id:e.id,hash:e.tts_hash,support_streaming:i?1:0},{onDone:e=>{o(e)}})}i.d(t,{loadArticle:()=>o})},6204:(e,t,i)=>{i.d(t,{ArticleTts:()=>c});var o=i(400160),r=i(867366),_=i(219095),n=i(392358),a=i(423015),s=i(138586),l=i(482310),d=i(22285);class c{static load(e,t,i,o){this.loadingArticleRawId=e.raw_id,(0,d.loadArticle)(e,t,i,(e=>{this.loadingArticleRawId=null,o(e)}))}static getAudio(e,t,i){const o=[],_=JSON.stringify({articleTts:!0,articleId:e,articleOwnerId:t,externalStream:!0});return o[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ID]=`${t}${e}`,o[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_OWNER_ID]=t,o[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_URL]=i.url,o[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_TITLE]=i.title,o[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_PERFORMER]=i.artist,o[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_DURATION]=i.duration,o[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_AUTHOR_LINK]="",o[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_LYRICS]=0,o[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_FLAGS]=0,o[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_CONTEXT]="",o[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_EXTRA]=_,o[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_HASHES]="",o[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_COVER_URL]="",o[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ADS]={},o[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_SUBTITLE]="",o[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_MAIN_ARTISTS]="",o[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_FEAT_ARTISTS]="",o[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ALBUM]=!1,o[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_TRACK_CODE]="",o[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_RESTRICTION]=0,o[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_INDEX_ALBUM_PART]=0,o[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_ACCESS_KEY]="",o[r.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_CHART_INFO_INDEX]=!1,o}static play(e,t,i,r){this.onArticleTtsExpire=r,this.statsHandlersInitialized||(this._audioPlayer().subscribe(n.AudioPlayerEventType.PLAY,(()=>{if(this.isAnyArticleInPlayer()){const e=this._audioPlayer().getCurrentProgress()>0?o.ArticleTtsActionType.CONTINUE:o.ArticleTtsActionType.START;this.sendStats(e)}})),this._audioPlayer().subscribe(n.AudioPlayerEventType.PAUSE,(()=>{this.isAnyArticleInPlayer()&&this.sendStats(o.ArticleTtsActionType.PAUSE)})),this._audioPlayer().subscribe(n.AudioPlayerEventType.ENDED,(()=>{if(this.isAnyArticleInPlayer()){let e=this._audioPlayer();if(e._impl?._hlsError||e._impl?._currentAudioEl?.error){e._impl&&(e._impl._hlsError=void 0);const t=(0,l.getAudioExtra)(e.getCurrentAudio());e.deleteCurrentPlaylist(),c.retryCount<3&&(c.retryCount+=1,setTimeout((()=>{this.onArticleTtsExpire?.(t)}),c.RETRY_TIMEOUT))}this.sendStats(o.ArticleTtsActionType.P100)}})),this.statsHandlersInitialized=!0);const _=this.getAudio(e,t,i),a=this._audioPlayer().getPlaylist(s.AudioPlaylist.TYPE_ARTICLE_TTS,t,e);a.mergeWith({list:[_]}),this._audioPlayer().play(_,a)}static _audioPlayer(){return window.getAudioPlayer()}static _audioExtra(){const e=this._audioPlayer().getCurrentAudio();return(0,l.getAudioExtra)(e)??{}}static isLoadingArticle(e){return this.loadingArticleRawId===e.raw_id}static isArticleInPlayer(e){return e.owner_id===this._audioExtra().articleOwnerId&&e.id===this._audioExtra().articleId}static isAnyArticleInPlayer(){return(0,_.isArticleTts)(this._audioPlayer().getCurrentAudio())}static sendStats(e){const{articleId:t,articleOwnerId:i}=this._audioExtra();o.articleTtsActionStatController.logEvent({action:e,nav_screen:"article_read",article_id:t,owner_id:i,audio_length:(0,a.audioTupleToAudioObject)(this._audioPlayer().getCurrentAudio())?.duration??0,speed:Math.round(100*AudioPlayer.podcastGetPlaybackRate()),volume:Math.round(100*this._audioPlayer().getVolume())})}}c.statsHandlersInitialized=!1,c.retryCount=0,c.RETRY_TIMEOUT=1e3},402096:(e,t,i)=>{i.d(t,{ON_BOARDING_BG_RECT_ID:()=>s,default:()=>c});var o=i(754866),r=i(972332),_=i(672277),n=i(287470),a=i(250598);const s="onboarding_bg_rect",l="page_header_cont",d="onboarding";class c{initOnboardingBG(){if(!window.onboardingBG){let e='\n<div id="onboarding_layout">\n  <svg id="onboarding_bg_header" width="100%" height="49px">\n    <rect id="onboarding_bg_rect" class="GroupOnboardingBg" x="0" y="0" width="100%" height="100%" fill-opacity="0.8" fill="#000"></rect>\n  </svg>\n  <svg id="onboarding_bg" width="100%" height="100%">\n  <defs>\n    <mask id="mask" x="0" y="0" width="100%" height="100%">\n      <rect x="0" y="0" width="100%" height="100%" fill="#fff"></rect>\n      <rect id="onboarding_bg_clip" class="GroupOnboardingBgClip" x="0" y="0" width="0" height="0" fill="#000" rx="8" ry="8"></rect>\n    </mask>\n  </defs>\n  <rect id="onboarding_bg_rect" class="GroupOnboardingBg" x="0" y="42" width="100%" height="100%" mask="url(#mask)" fill-opacity="0.8"></rect>\n  </svg>\n</div>\n      ',t=(0,o.se)(e);(0,o.domInsertBefore)(t,window.layerBG),window.onboardingBGHeader=(0,o.ge)("onboarding_bg_header"),window.onboardingBG=(0,o.ge)("onboarding_bg"),window.onboardingBGRect=(0,o.ge)(s),window.onboardingBGClip=(0,o.ge)("onboarding_bg_clip"),window.cur.destroy.push((()=>{(0,o.hide)(window.onboardingBG),(0,o.hide)(window.onboardingBGHeader),(0,o.removeClass)((0,o.ge)(l),d),this.hideDarkness=!0,this.hideTT(),delete window.onboardingBG,delete window.onboardingBGHeader,delete window.onboardingBGRect,delete window.onboardingBGClip,this.opts.onBGClick&&(0,r.removeEvent)(window.onboardingBG,"click",this.opts.onBGClick)}))}this.opts.onBGClick&&(0,r.addEvent)(window.onboardingBG,"click",this.opts.onBGClick)}showTT(){const[,e]=(0,o.getXY)(this.el);this.tt=new a.ElementTooltip(this.el,this.ttParams),this.opts.highlight&&(this.addDarkness(),this.addHighlight()),this.tt.show();const t=this.tt.getContent();(0,n.isElementInViewport)(this.el)&&(0,n.isElementInViewport)(t)||(0,_.scrollToY)(e-42-this.ttParams.scrollOffset)}hideTT(){this.tt&&(this.tt.destroy(),this.removeDarkens(),this.hideDarkness&&((0,r.removeEvent)(window,"scroll"),(0,r.removeEvent)(window,"resize")),this.opts.onBGClick&&window.onboardingBG&&(0,r.removeEvent)(window.onboardingBG,"click",this.opts.onBGClick),this.opts.onHide&&this.opts.onHide())}addHighlight(){window.onboardingBGClip&&(this.highlightElement(),(0,r.addEvent)(window,"scroll",this.onScrollTT.bind(this)),(0,r.addEvent)(window,"resize",this.onResizeTT.bind(this)))}highlightElement(){let e=this.el.offsetWidth,t=this.el.offsetHeight,i=(0,o.getXY)(this.el);(0,o.attr)(window.onboardingBGClip,"width",e+this.border[1]+this.border[3]),(0,o.attr)(window.onboardingBGClip,"height",t+this.border[0]+this.border[2]),(0,o.attr)(window.onboardingBGClip,"x",i[0]-this.border[1]),(0,o.attr)(window.onboardingBGClip,"y",i[1]-this.border[0])}onResizeTT(){this.setDartToFullWidth(),this.highlightElement()}onScrollTT(){let e=this.getPageHeight();window.onboardingBG.height!=e&&this.setDartToFullHeight()}setDartToFullHeight(){(0,o.attr)(window.onboardingBG,"height",this.getPageHeight())}setDartToFullWidth(){(0,o.attr)(window.onboardingBG,"width",this.getPageWidth()),(0,o.attr)(window.onboardingBGHeader,"width",this.getPageWidth())}addDarkness(){(0,o.isVisible)(window.onboardingBG)||(this.setDartToFullHeight(),this.setDartToFullWidth(),(0,o.show)(window.onboardingBG),(0,o.isVisible)(window.onboardingBGHeader)||((0,o.show)(window.onboardingBGHeader),(0,o.addClass)((0,o.ge)(l),d)))}removeDarkens(){this.hideDarkness&&((0,o.hide)(window.onboardingBG),(0,o.hide)(window.onboardingBGHeader),(0,o.removeClass)((0,o.ge)(l),d))}ttOnHide(){this.hideTT()}show(){setTimeout(this.showTT.bind(this),1e3)}getPageWidth(){const e=document.documentElement,t=document.body;return Math.max(t.scrollWidth,e.scrollWidth,t.offsetWidth,e.offsetWidth,t.clientWidth,e.clientWidth)}getPageHeight(){const e=document.documentElement,t=document.body;return Math.max(t.scrollHeight,e.scrollHeight,t.offsetHeight,e.offsetHeight,t.clientHeight,e.clientHeight)}constructor(e,t,i={}){this.el=e,this.text=t,this.hideDarkness=!0,this.oldColor=!1;let o={autoShow:!1,noAutoHideOnWindowClick:i.noAutoHideOnWindowClick??!0,content:t instanceof HTMLElement?t:`${t}`,cls:`feature_intro_tt tutorial_tip_tt ${(()=>{const e=i.class??"";return i.tooltipWhite?e:e+" feature_intro_blue_tt"})()}`,appendToParent:!0,onHide:this.ttOnHide.bind(this),scrollOffset:i.scrollOffset||0,align:i.align||a.ElementTooltip.ALIGN_CENTER};i.side&&(o.forceSide=i.side),i.offset&&(o.offset=i.offset),i.width&&(o.width=i.width),i.shift&&(o.centerShift=i.shift),i.border?this.border=i.border:this.border=[10,10,10,10],i.ttOnHide&&(o.onHide=i.ttOnHide),i.withCloseButton&&(o.withCloseButton=i.withCloseButton,o.onCloseButtonClick=i.onCloseButtonClick),i.align&&(o.align=i.align),this.ttParams=o,this.opts=i,this.initOnboardingBG()}}},287470:(e,t,i)=>{function o(e){const t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}function r(e,t){return`<b>${e}</b><br/>${t}`}i.d(t,{buildTooltipeContent:()=>r,isElementInViewport:()=>o})},857606:(e,t,i)=>{function o(e,t=!0){return`${t?"data-":""}ad-stat-${e}`}i.d(t,{getStatAttrName:()=>o})},396482:(e,t,i)=>{i.d(t,{AD_POST_CLASS_SELECTOR:()=>r,PixelNames:()=>o});const o={audio_click:"audio_click",click:"click",click_deeplink:"click_deeplink",click_post_link:"click_post_link",click_post_owner:"click_post_owner",click_pretty_card:"click_pretty_card",closed_by_user:"closed_by_user",hide:"hide",impression:"impression",impression_pretty_card:"impression_pretty_card",like_post:"like_post",load:"load",playback_started:"playback_started",playback_paused:"playback_paused",playback_resumed:"playback_resumed",playback_completed:"playback_completed",playhead_reached_value:"playhead_reached_value",playhead_viewability_value:"playhead_viewability_value",render:"render",share_post:"share_post",show_off:"show_off",video_fullscreen_off:"video_fullscreen_off",video_fullscreen_on:"video_fullscreen_on",video_pause:"video_pause",video_play:"video_play",video_play_100:"video_play_100",video_resume:"video_resume",video_start:"video_start",video_volume_off:"video_volume_off",video_volume_on:"video_volume_on",viewability_duration:"viewability_duration",viewability_measurable:"viewability_measurable",viewability_unmeasurable:"viewability_unmeasurable",viewin:"viewin",volume_off:"volume_off",volume_on:"volume_on",error:"error"},r="._ads_block_data_w"},248199:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{SENSITIVITY_TRIGGER_EVENT_PLAYBACK_PROGRESS:()=>SENSITIVITY_TRIGGER_EVENT_PLAYBACK_PROGRESS,logPixelEvent:()=>logPixelEventUntyped,throttleLogPixelReachedValueEvent:()=>throttleLogPixelReachedValueEvent,triggerAdHtmlEvent:()=>triggerAdHtmlEvent});var _shared_lib_ls__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(469004),_shared_lib_common__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(898848),_shared_utils_numberHashCode__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(586227),_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(396482),_shared_lib_js_logger__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(298077),_shared_user_user_env__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(540462),_shared_feed_feed_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(54998),_attributes__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(857606),_shared_pixels_utils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(349438),_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(374339),_shared_lib_throttle__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(150585);const SENSITIVITY_TRIGGER_EVENT_PLAYBACK_PROGRESS=.01,SENSITIVITY_TRIGGER_EVENT_REACHED_SECONDS=.3,THROTTLE_TRIGGER_EVENT_SECOND=250,LS_ADS_EVENTS="ads.events",uniqueEvents=[_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.render,_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.viewability_measurable,_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.viewability_unmeasurable,_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.viewin,_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.error],isUniqueEvent=e=>uniqueEvents.includes(e),triggerAdHtmlEvent=(el,event)=>{if(!el)return null;const statHtml=(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_7__.getAdAttribute)(el,`ad-stat-html-${event}`);if((0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_7__.removeAdAttribute)(el,`ad-stat-html-${event}`),statHtml){const statElemWrap=document.createElement("div");let elem;for(statElemWrap.setAttribute("innerHTML",statHtml);elem=statElemWrap.firstChild;)if(el.appendChild(elem),"SCRIPT"===elem.tagName)try{eval(elem.innerHTML)}catch(e){(0,_shared_lib_js_logger__WEBPACK_IMPORTED_MODULE_3__.logEvalError)(e,elem.innerHTML)}}};function parsePixels(e,t){try{const t=JSON.parse(e);if(Array.isArray(t))return{pixels:t}}catch(i){if(!/^https?:\/\//.test(e))return{isInvalid:!0,pixels:[]};return{pixels:e.split("$$$").map((e=>({type:t,url:e})))}}return{pixels:[]}}const filterPixelReachedEvents=(e,t,i)=>{const o=i?.duration,r="number"==typeof i?.value&&i?.value>=0?i?.value+SENSITIVITY_TRIGGER_EVENT_REACHED_SECONDS:o&&"number"==typeof i?.pvalue&&i?.pvalue>=0?i?.pvalue*o:0,_="number"==typeof i?.pvalue&&i?.pvalue>=0?i?.pvalue+SENSITIVITY_TRIGGER_EVENT_PLAYBACK_PROGRESS:o&&r?100*r/o:0;if(r||_){const{pixelsFilter:i,pixelsRemainingFilter:o}=t.reduce(((e,t)=>(t?.pvalue&&"number"==typeof t?.pvalue&&_&&t?.pvalue<=_||t?.value&&"number"==typeof t?.value&&r&&t?.value<=r?e.pixelsFilter.push(t):e.pixelsRemainingFilter.push(t),e)),{pixelsFilter:[],pixelsRemainingFilter:[]}),n=(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_7__.getAdAttribute)(e,`ad-stat-disabled-${_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.playhead_reached_value}`);try{if(i.length>0){(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_7__.updateAdAttribute)(e,`ad-stat-${_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.playhead_reached_value}`,JSON.stringify(o));const t=n?JSON.parse(n):[];Array.isArray(t)&&Array.isArray(i)&&(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_7__.updateAdAttribute)(e,`ad-stat-disabled-${_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.playhead_reached_value}`,JSON.stringify([...t,...i]))}}catch(e){console.log(`throw Pixel event error: ${e.message}`)}return i}return[]},logPixelEvent=(e,t,i)=>{if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_4__.partConfigEnabled)("ads_pixels_track_new_events_web_mvk")&&(0,_shared_feed_feed_utils__WEBPACK_IMPORTED_MODULE_5__.isOnFeedPage)())try{const o=(0,_shared_feed_feed_utils__WEBPACK_IMPORTED_MODULE_5__.getNearestPost)(e)??e;if(!(o instanceof HTMLElement))return;const r=(0,_attributes__WEBPACK_IMPORTED_MODULE_8__.getStatAttrName)(t,!1),_=(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_7__.getAdAttribute)(o,r),n=(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_7__.getAdAttribute)(o,"ad-block-uid");if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_4__.partConfigEnabled)("feed_ads_pixel_tracked_console_log")&&(0,_shared_pixels_utils__WEBPACK_IMPORTED_MODULE_6__.logIfAdPostPixelFired)(o,t),!_)return;let{isInvalid:a,pixels:s}=parsePixels(_,t);if(a&&console.log("throw Pixel parse error"),isUniqueEvent(t)&&s.length&&((0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_7__.updateAdAttribute)(o,`ad-disabled-stat-${t}`,_),(0,_shared_feed_adblock_protection_attributes_hider__WEBPACK_IMPORTED_MODULE_7__.removeAdAttribute)(o,r)),n&&isUniqueEvent(t)&&s.length)try{const e=(0,_shared_utils_numberHashCode__WEBPACK_IMPORTED_MODULE_9__.numberHashCode)(`${t}${n}`),i=_shared_lib_ls__WEBPACK_IMPORTED_MODULE_0__.multiAccountLs.get(LS_ADS_EVENTS)||{};if(!i[e]){const t=(new Date).getTime()/1e3|0;i[e]=t,_shared_lib_ls__WEBPACK_IMPORTED_MODULE_0__.multiAccountLs.set(LS_ADS_EVENTS,i)}}catch(e){console.log(`throw Pixel event error: ${e.message}`)}t===_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.playhead_reached_value&&(s=filterPixelReachedEvents(o,s,i)),s.forEach((e=>{sendPixelEvent({pixel:e})})),triggerAdHtmlEvent(o,t)}catch(e){console.log(`throw Pixel event error: ${e.message}`)}},throttleLogPixelReachedValueEvent=(0,_shared_lib_throttle__WEBPACK_IMPORTED_MODULE_10__.throttle)(((e,t)=>{logPixelEvent(e,_shared_pixels_constants__WEBPACK_IMPORTED_MODULE_2__.PixelNames.playhead_reached_value,t)}),THROTTLE_TRIGGER_EVENT_SECOND);function sendPixelEvent({pixel:e,adEl:t}){if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_4__.partConfigEnabled)("ads_pixels_track_new_events_web_mvk")&&((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_4__.partConfigEnabled)("feed_ads_pixel_tracked_console_log")&&(0,_shared_pixels_utils__WEBPACK_IMPORTED_MODULE_6__.logPixelSent)(e.type,e,t),e.url)){(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_1__.vkImage)().src=e.url}}const logPixelEventUntyped=(e,...t)=>{if(e instanceof HTMLElement)return logPixelEvent(e,...t)}},349438:(e,t,i)=>{i.d(t,{logIfAdPostPixelFired:()=>d,logPixelSent:()=>l});var o=i(396482),r=i(540462),_=i(374339),n=i(962724);const a=(e,t,i,o)=>{console.debug(`[ads pixels log][debug] Pixel "${e}" is touched${t?` with text "${t}"`:""}`,i,o)},s=(e,t,i)=>{a(e,"Pixel rich conditions and fired to track",t,i)},l=(e,t,i)=>{a(e,"Pixel sent",t,i)},d=(e,t,i)=>{if(i)return void s(t,void 0,e);const a=(0,r.partConfigEnabled)("post_adblock_protection_promo")?n.Locator.getInstance().lookupSelector(o.AD_POST_CLASS_SELECTOR):o.AD_POST_CLASS_SELECTOR;(e.classList.contains(a.replaceAll(".",""))||(0,_.hasAdElementAttributes)(e))&&s(t,void 0,e)}},400160:(e,t,i)=>{i.d(t,{ArticleTtsActionType:()=>o,articleTtsActionStatController:()=>_});var o,r=i(314309);!function(e){e.START="start",e.PAUSE="pause",e.CONTINUE="continue",e.SEEK="seek",e.CLOSE="close",e.P10="10p",e.P25="25p",e.P50="50p",e.P75="75p",e.P95="95p",e.P99="99p",e.P100="100p"}(o||(o={}));const _=new class{logEvent(e,t){const i={type:"type_marusia_reading_item",type_marusia_reading_item:e};this.actionStatCollector.logEvent(i,t)}constructor(){this.productStatCollector=new r.ProductionStatCollector,this.actionStatCollector=new r.ActionStatCollector(this.productStatCollector)}}},668275:(e,t,i)=>{i.d(t,{isDebugEnabled:()=>_});var o=i(469004);let r;const _=()=>(void 0!==r||(r=!!o.ls.get("reactions.debug_enabled")),r)},295673:(e,t,i)=>{i.d(t,{reactionLogError:()=>_});var o=i(298077);const r="reactions";function _({error:e,reportError:t=!1}){t&&(0,o.logError)(e,{environment:r}),console.error(e)}},586227:(e,t,i)=>{function o(e){let t=0;if(0===e.length)return t;for(let i=0,o=e.length;i<o;i++){t=(t<<5)-t+e.charCodeAt(i),t|=0}return t}i.d(t,{numberHashCode:()=>o})},673006:(e,t,i)=>{i.d(t,{BADGES_BOX_WIDTH:()=>o,BADGE_COMMENT_SELECTOR:()=>s,BADGE_IMAGE_SIZE_100:()=>d,BADGE_IMAGE_SIZE_20:()=>c,BadgesEventName:()=>n,BadgesEventRef:()=>_,BadgesObjectType:()=>a,DONUT_BADGE_ID:()=>l,LINK_TO_HELP_FOR_AUTHORS:()=>r});const o=640,r="/@authors-badges",_={TAB:"tab",SENDER_LIST:"sender_list",POST_BTN:"post_btn",COLLECTION_BLOCK:"collection_block",COLLECTON_ALL:"collecton_all",NOTIFICATION:"notification",PUSH:"push",PIN:"pin",COMMENT_IMG:"comment_img",COMMENT_LINK:"comment_link",PROFILE_DETAILS:"profile_details"},n={OPEN_BADGE:"open_badge",OPEN_BADGES_ALL:"open_badges_all"};var a;!function(e){e[e.WALL=11]="WALL"}(a||(a={}));const s="BadgeComment",l=38,d=100,c=20},787476:(e,t,i)=>{i.d(t,{generateLatinizedName:()=>c,isPublishNameCorrect:()=>s,updateArticleSnippetsFromQueueByPost:()=>a});var o=i(298077),r=i(898848),_=i(540462);i(6204),i(801746),i(792112),i(908166),i(358172),i(392358),i(449299),i(866467);const n="article_snippet";function a(e){if(!window.vk.id)return;if(!(0,_.partConfigEnabled)("update_private_snippets_by_queue"))return;const t=Array.from(e.querySelectorAll(`.${n}`));if(!t.length)return;const i=[];t.forEach((e=>{if(!window.vk.id||!e.dataset.needUpdate)return;const t=e.dataset.articleRawId;t&&i.push({article_raw_id:t,post_raw_id:e.dataset.postId,is_mini_snippet:(0,r.intval)(e.dataset.isMiniSnippet)})})),i.length&&window.ajax.post("al_articles.php",{act:"get_snippets",article_snippets:JSON.stringify(i)},{onDone:e=>{t.forEach((t=>{t.dataset.articleRawId&&e[t.dataset.articleRawId]&&(t.outerHTML=e[t.dataset.articleRawId])}))},onFail:()=>((0,o.logError)(new Error("Fail: updateArticleSnippetsFromQueueByPost")),!0)})}function s(e){return!!/^[a-z0-9\-]+$/.test(e)&&(!e.includes("--")&&(!e.startsWith("-")&&!e.endsWith("-")&&!(e.length>60)))}const l=[{to:"a",from:"[ÀÁÂÃÄÅÆĀĂĄẠẢẤẦẨẪẬẮẰẲẴẶ]"},{to:"c",from:"[ÇĆĈČ]"},{to:"d",from:"[ÐĎĐÞ]"},{to:"e",from:"[ÈÉÊËĒĔĖĘĚẸẺẼẾỀỂỄỆ]"},{to:"g",from:"[ĜĞĢǴ]"},{to:"h",from:"[ĤḦ]"},{to:"i",from:"[ÌÍÎÏĨĪĮİỈỊ]"},{to:"j",from:"[Ĵ]"},{to:"ij",from:"[Ĳ]"},{to:"k",from:"[Ķ]"},{to:"l",from:"[ĹĻĽŁ]"},{to:"m",from:"[Ḿ]"},{to:"n",from:"[ÑŃŅŇ]"},{to:"o",from:"[ÒÓÔÕÖØŌŎŐỌỎỐỒỔỖỘỚỜỞỠỢǪǬƠ]"},{to:"oe",from:"[Œ]"},{to:"p",from:"[ṕ]"},{to:"r",from:"[ŔŖŘ]"},{to:"s",from:"[ßŚŜŞŠ]"},{to:"t",from:"[ŢŤ]"},{to:"u",from:"[ÙÚÛÜŨŪŬŮŰŲỤỦỨỪỬỮỰƯ]"},{to:"w",from:"[ẂŴẀẄ]"},{to:"x",from:"[ẍ]"},{to:"y",from:"[ÝŶŸỲỴỶỸ]"},{to:"z",from:"[ŹŻŽ]"}],d={1072:"a",1073:"b",1074:"v",1075:"g",1076:"d",1077:"e",1105:"e",1078:"zh",1079:"z",1080:"i",1081:"i",1082:"k",1083:"l",1084:"m",1085:"n",1086:"o",1087:"p",1088:"r",1089:"s",1090:"t",1091:"u",1092:"f",1093:"h",1094:"c",1095:"ch",1096:"sh",1097:"sch",1099:"y",1101:"e",1102:"u",1103:"ya"};function c(e,t){e=e.toLowerCase();let i="",o=!1;const r="-qwertyuiopasdfghjklzxcvbnm0123456789".split("");l.forEach((t=>{e=e.replace(new RegExp(t.from,"gi"),t.to)}));for(let t=0;t<e.length;t++)if(/\s/.test(e[t]))o||(i+="-",o=!0);else if(r.includes(e[t]))i+=e[t],o=!1;else{let r=d[e.charCodeAt(t)];r&&(i+=r,o=!1)}return i=i.substr(0,t),i=i.replace(/-*$/,"").replace(/^-*/,"").replace(/-+/g,"-"),i}},345235:(e,t,i)=>{i.d(t,{highlightModule:()=>d});var o=i(402096),r=i(137771),_=i(672277),n=i(754866),a=i(342018);let s,l;function d(e){const t=document.getElementById(e.module);if(!t||!t.classList.contains("module"))return;window.cur.__narrowBarForceNotFixed=!0;const i=e.speed?e.speed:300;(0,_.scrollToY)((0,n.getXY)(t)[1]-100,i);const d=()=>{s&&(s.hideTT(),(0,_.enableBodyScroll)(),delete window.cur.__narrowBarForceNotFixed,(0,r.updateNarrow)(),e.onClose&&e.onClose())};s=new o.default(t,e.text,{highlight:!0,width:250,offset:[0,-17],side:"bottom",withCloseButton:!0,onBGClick:d,onCloseButtonClick:d}),s.show(),(0,_.disableBodyScroll)(),e.autoCancelDelay&&(l=setTimeout((()=>{d(),l=null}),e.autoCancelDelay),(0,a.pushNavDestroy)((()=>{l&&clearTimeout(l)})))}},865556:(e,t,i)=>{i.d(t,{REACTIONS_COUNTS_RESPONSE_FIELD:()=>s,SIZE_128:()=>a,SIZE_32:()=>r,SIZE_40:()=>_,SIZE_96:()=>n,SUPPORTED_OBJECT_TYPES:()=>o,WK_SECTION_PREFIX_REACTIONS:()=>l});const o={wall:"wall",wall_reply:"wall_reply"},r={width:32,height:32},_={width:40,height:40},n={width:96,height:96},a={width:128,height:128},s="reactions_counts",l="reactions"},927350:(e,t,i)=>{i.d(t,{ENABLED_IN_POST_REPLY:()=>r,isDebugEnabled:()=>o.isDebugEnabled});var o=i(668275);const r=!1},873780:(e,t,i)=>{i.d(t,{reactionLogError:()=>_});var o=i(295673),r=i(66663);const _=({error:e})=>{const t=(0,r.getReactionConfig)(),i=t?.reportJsErrors??!1;(0,o.reactionLogError)({error:e,reportError:i})}},66663:(e,t,i)=>{i.d(t,{getReactionConfig:()=>u,getReactionSet:()=>E,storageAddSets:()=>c,storageSetConfig:()=>h});var o=i(558137),r=i(8520),_=i(369296),n=i(873780),a=i(865556),s=i(927350);const l=(0,o.makeSharedState)("reactions-storage",(()=>new Map),{version:0}),d=(0,o.makeSharedState)("reactions-config",(()=>({config:void 0})),{version:0}),c=e=>{(0,s.isDebugEnabled)()&&console.log(e),Object.entries(e).forEach((([e,t])=>{const i=(0,_.validateReactionSetPayloaditems)(t,e);if(i)return void(0,n.reactionLogError)({error:i.error});const o=t.map((e=>({...e,title:(0,r.decodeHTMLEntities)(e.title)})));l().set(e,(0,_.prepareReactionMenuSet)(e,o,{imageMenuSize:a.SIZE_96,imagePreviewSize:a.SIZE_32,imageStoryPanelSize:a.SIZE_128,imageStoryPreviewSize:a.SIZE_40}))}))},E=e=>{const t=l().get(e);if(t)return t;{const t=new Error(`Reaction set not found: ${e}`);(0,n.reactionLogError)({error:t})}},h=e=>{(0,s.isDebugEnabled)()&&console.log(e);const t=(0,_.parseReactionMenuConfig)(e);t?d().config=t:console.warn("Reactions: invalid menu config passed",e)},u=()=>{const e=d()?.config;return e}},163790:(e,t,i)=>{i.d(t,{getReactionsButtonPostTemplate:()=>h,getReactionsButtonReplyTemplate:()=>u,likeDataReactionsFields:()=>w});var o=i(540462),r=i(754866),_=i(865556),n=i(66663),a=i(369296),s=i(888065),l=i(673006);const d=(e,t,i)=>{const o=(e=>{try{const t=JSON.parse(e);if(null!==t&&"object"!=typeof t)return;return t}catch(e){return}})(e)?.set_id,_="string"==typeof o?o:void 0;if(!t||!_)return;const s=(0,n.getReactionSet)(_);return s?{likeClassName:"like_btn--hidden PostBottomAction--hidden",template:(0,r.rs)(t,{reactions_button_title:(0,a.getDefaultReactionTitle)(s)||"",reactions_set_id:_,badges_object_type:l.BadgesObjectType.WALL,badges_object_owner_id:i?.objectOwnerId||0,badges_object_id:i?.objectId||0,badges_ref:l.BadgesEventRef.POST_BTN})}:void 0},c=(e,t)=>t.length>e,E=e=>{const t=e[2],[i,o]=t.split("_");return{objectOwnerId:Number(i),objectId:Number(o)}},h=(e,t)=>{const i=E(e),o=t?.wallTpl?.post_likes_reactions,r=c(14,e)?e[14]:void 0;if("string"==typeof r)return d(r,o,i)},u=(e,t)=>{const i=E(e),r=t?.wallTpl?.reply_likes_reactions;if(!(0,o.partConfigEnabled)("reactions_enabled_post_replies"))return;const _=c(14,e)?e[14]:void 0;return"string"==typeof _?d(_,r,i):void 0},p=e=>{let t=JSON.parse(e);if(null===t||"object"==typeof t||Array.isArray(t)){if(Array.isArray(t)){t=(0,s.reactionCountsBrandWrap)((i=t,Object.assign({},i)))}var i;return t}},g=e=>{const t=c(5,e)?e[5]:void 0;if("string"!=typeof t)return;const i=(e=>{const t=e.indexOf(";"),i=e.substr(0,t),o=e.substr(t+1);if("1"===i)return p(o)})(t);return i?{counts:i}:void 0},w=e=>{const t=g(e);return{[_.REACTIONS_COUNTS_RESPONSE_FIELD]:t?.counts}}},118628:(e,t,i)=>{i.d(t,{highlightNarrativeBlock:()=>p,prepareStoriesForPublishing:()=>h,updateNarrativeBlock:()=>u,updateNarrativeSnippetsFromQueueByPost:()=>g});var o=i(754866),r=i(246429),_=i(345235),n=i(866467),a=i(898848),s=i(298077),l=i(540462),d=i(810068),c=i(901089);const E="NarrativeSnippet";function h(e){return e.map((e=>e.id)).join(",")}function u(e=!1){const t=(0,a.intval)(window.cur.oid);d.Ranges.isUserId(t)&&"profile"===window.cur.module||(window.cur.narrativeBlock?window.ajax.post("al_stories.php",{act:"get_narrative_block",owner_id:t},{onDone:e=>{const t=(0,a.intval)(window.cur.oid),i=document.getElementById(`narratives_module${t}_wrapper`);if(i)if(e)(0,o.domReplaceEl)(i,e),window.cur.narrativeBlock&&window.cur.narrativeBlock.destroy(),window.NarrativeBlock&&(window.cur.narrativeBlock=new window.NarrativeBlock);else{const e=i.parentElement;e?.children.length&&e?.children.length>1?i.remove():e?.remove(),window.cur.narrativeBlock&&window.cur.narrativeBlock.destroy(),delete window.cur.narrativeBlock}(0,c.removeStoryList)(`narratives${t}`)}}):e&&function(e){window.boxQueue.hideAll();const t=document.querySelector("#box_layer_wrap"),i=document.querySelector("#box_loader");window.nav.reload({onDone:()=>{e&&e()},showProgress:()=>{(0,o.show)(t),(0,o.show)(i),(0,r.refreshBoxLoaderCoords)()},hideProgress:()=>{(0,o.hide)(t),(0,o.hide)(i)}})}((()=>{window.cur.needNarrativeOnboard=!0})))}function p(e){if(!e)return;const t=`narratives_module${window.vk.id}`;(0,_.highlightModule)({module:t,text:n.getLang("stories_narrative_block_onboarding_text"),onClose:()=>{delete window.cur.needNarrativeOnboard,window.ajax.post("al_index.php",{act:"hide_feature_tt",hash:e,type:"profile_narrative"})},autoCancelDelay:1e4,speed:600})}function g(e){if(!window.vk.id)return;if(!(0,l.partConfigEnabled)("update_private_snippets_by_queue"))return;const t=Array.from(e.querySelectorAll(`.${E}`));if(!t.length)return;const i=[];t.forEach((e=>{if(!window.vk.id||!e.dataset.needUpdate)return;const t=e.dataset.narrativeRawId;t&&i.push({narrative_raw_id:t,from:e.dataset.from})})),i.length&&window.ajax.post("al_stories.php",{act:"get_narrative_snippets",narrative_snippets:JSON.stringify(i)},{onDone:e=>{t.forEach((t=>{t.dataset.narrativeRawId&&e[t.dataset.narrativeRawId]&&(t.outerHTML=e[t.dataset.narrativeRawId])}))},onFail:()=>((0,s.logError)(new Error("Fail: updateNarrativeSnippetFromQueueByPost")),!0)})}},390199:(e,t,i)=>{i.d(t,{highlightUpdatedPost:()=>r,highlightUpdatedPostContent:()=>_});var o=i(581197);const r=e=>{(0,o.triggerAnimationClass)(e,"post_highlight_updated",3e3)},_=e=>{(0,o.triggerAnimationClass)(e,"post_highlight_updated_content",3e3)}},996531:(e,t,i)=>{i.d(t,{floatingButtonCollapseAllRepliesHide:()=>_,floatingButtonCollapseAllRepliesShow:()=>n,highlightUpdatedReply:()=>l,highlightUpdatedReplyContent:()=>d,loadRepliesLinkIsVisible:()=>s,loadRepliesLinkShow:()=>a});var o=i(581197),r=i(754866);const _=e=>{e instanceof HTMLElement&&e.classList.contains("replies_side")&&e.classList.add("replies_side_hidden")},n=e=>{e instanceof HTMLElement&&e.classList.contains("replies_side")&&e.classList.remove("replies_side_hidden")},a=e=>{e instanceof HTMLElement&&e.classList.contains("replies_next")&&e.classList.add("replies_next_shown")},s=e=>!!(e instanceof HTMLElement&&e.classList.contains("replies_next"))&&(e.classList.contains("replies_next_shown")||(0,r.isVisible)(e)),l=e=>{(0,o.triggerAnimationClass)(e,"reply_highlight_updated",3e3)},d=e=>{(0,o.triggerAnimationClass)(e,"reply_highlight_updated_content",3e3)}},358172:(e,t,i)=>{e.exports=i.p+"icons/58c1b2240970f92c.png"}}]);try{stManager?.done("dist/web/chunks/ec9ec794.08b9bd27.js")}catch(e){}