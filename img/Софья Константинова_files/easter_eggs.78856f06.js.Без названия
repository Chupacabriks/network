(()=>{"use strict";var e,t,i,n={959477:(e,t,i)=>{i.d(t,{EasterEggs:()=>p});var n=i(535130),a=i(754866),o=i(898848),s=i(972332),r=i(317216),_=i(314309),c=i(246429),h=i(19589),d=i(342018),u=i(810068);const p={URL:"easter-eggs",ANIMATION_GROUP:"easter_eggs",CLICK_ANIMATION_GROUP:"easter_eggs_click",ACT_POPUP:"getPopup",ACT_FOUND_EGG:"foundEgg",ACT_HIDE_EVENT:"hideEvent",ACT_EASTER_EGGS:"getEasterEggs",ACT_PERFORM_ACTION:"performAction",frames:{},activeAnimations:{},_init:function(e){this.eggs=e,this._checkContainer(),this._setEggs(),this._setCurEvents(),n.LottieManager.observer.ignoreGroup(this.CLICK_ANIMATION_GROUP)},_setCurEvents:function(){this.curSet||(this.curSet=!0,window.cur._back?(window.cur._back.hide&&window.cur._back.hide.push(this._flush.bind(this)),window.cur._back.show&&(window.cur._back.show.push(this._flush.bind(this)),window.cur._back.show.push(this.updateEggs.bind(this)))):(0,d.pushNavDestroy)((()=>this._flush())))},_flush:function(e){if(this.activeAnimations)for(let t in this.activeAnimations)if(this.activeAnimations.hasOwnProperty(t)){const i=t.split("_");(0,o.isNumeric)(e)&&e!==parseInt(i[0])||(this.activeAnimations[t].stop(),this.activeAnimations[t].destroy(),delete this.activeAnimations[t])}if(this.frames)for(let t in this.frames)if(this.frames.hasOwnProperty(t)){const i=t.split("_");(0,o.isNumeric)(e)&&e!==parseInt(i[0])||((0,s.removeEvent)(this.frames[t],"click"),(0,s.removeEvent)((0,a.geByClass)("EasterEggFrame__hideEvent",this.frames[t]),"click"),this.frames[t].parentNode.removeChild(this.frames[t]),delete this.frames[t])}this.container&&(this.container.innerHTML=""),this.frames=[],this.activeAnimations=[]},_checkContainer:function(){this.container||(this.container=document.body.appendChild((0,a.ce)("div",{className:"EasterEggsContainer",innerHTML:""})))},_setEggs:function(){this.eggs&&this.eggs.forEach((e=>{e.positions&&e.positions.length&&e.positions.forEach((t=>{this._validPosition(t.url_regexp)&&this._appendEasterEgg(t,e)}))}))},_validPosition:function(e){if(e=(e||"").replace(/(^#)|(#$)/g,""))try{const t=new RegExp(e),i=this._getNormalizedUrl();return t.test(i)}catch(e){return!1}return!1},_getNormalizedUrl(){switch(window.cur.module){case"profile":return"/id"+(window.cur.oid||0);case"groups":return"/club"+(void 0===window.cur.oid?0:-window.cur.oid);default:return location.pathname}},_appendEasterEgg:function(e,t){t.animation?.url&&this._getAnimation(t.animation?.url).then((async i=>{const _=document.createElement("div");_.className="EasterEggFrame",(0,s.addEvent)(_,"click",function i(){(0,s.removeEvent)(_,"click",i),this.onFrameClick({eggId:t.id,eggEventId:t.event_id,positionId:e.position_id,hash:e.hash,url:t.url,clickAnimation:t.click_animation})}.bind(this));const c=document.createElement("div");c.className="EasterEggFrame__hideEvent",(0,s.addEvent)(c,"click",(i=>{(0,s.stopEvent)(i),this.onHideClick({eventId:t.event_id,eggId:t.id,positionId:e.position_id})})),(0,o.isNumeric)(e.appearance.top)?(0,a.setStyle)(_,{top:e.appearance.top}):(0,o.isNumeric)(e.appearance.bottom)&&(0,a.setStyle)(_,{bottom:e.appearance.bottom}),(0,o.isNumeric)(e.appearance.left)?((0,a.setStyle)(_,{left:e.appearance.left}),(0,a.setStyle)(c,{right:0})):(0,o.isNumeric)(e.appearance.right)&&((0,a.setStyle)(_,{right:e.appearance.right}),(0,a.setStyle)(c,{left:0})),e.appearance.fixed&&(0,a.setStyle)(_,{position:"absolute"}),t.animation?.width&&(0,a.setStyle)(_,{width:t.animation?.width}),t.animation?.height&&(0,a.setStyle)(_,{height:t.animation?.height});let h=null;e.appearance.container&&(h=document.querySelector(e.appearance.container)),h?h.appendChild(_):this.container.appendChild(_),_.style.display="block";const d=await n.LottieManager.loadAnimation({group:this.ANIMATION_GROUP,name:t.animation?.url,animationData:i,containers:[_],width:t.animation?.width,height:t.animation?.height,loop:!0,autoplay:!0}).catch((()=>{_.style.display="none"}));t.hide_close_button||_.appendChild(c);const u=t.id+"_"+e.position_id;this.frames[u]=_,this.activeAnimations[u]=d,this.sendStats(r.IEasterEggsItemEventType.EGG_SHOW,t.id,t.event_id,e.position_id)}))},async _runClickAnimation(e,t,i,o){const s=e+"_"+t,r=this.frames[s],_=this.activeAnimations[s];i?.width&&(0,a.setStyle)(r,{width:i?.width}),i?.height&&(0,a.setStyle)(r,{height:i?.height});const c=await n.LottieManager.loadAnimation({group:this.CLICK_ANIMATION_GROUP,name:i.url,animationData:o,containers:[r],width:i?.width,height:i?.height,loop:!1,autoplay:!0});_&&_.destroy(),this.activeAnimations[s]=c},_getAnimation:function(e){return new Promise(((t,i)=>{const n=new XMLHttpRequest;n.open("GET",e,!0),n.send(),n.onreadystatechange=()=>{if(4===n.readyState)try{const e=JSON.parse(n.responseText);t(e)}catch(e){i()}}}))},onFrameClick:function(e){if(!(0,o.isNumeric)(e.eggId)||!(0,o.isNumeric)(e.positionId))return;const t=()=>{this._foundEgg(e.eggId,e.positionId,e.hash,(()=>{if(this._flush(e.eggId),e.url)return window.open(e.url,"_blank");this._showPopup(e.eggId,e.eggEventId,e.positionId)}))};e.clickAnimation&&e.clickAnimation.url?this._getAnimation(e.clickAnimation?.url).then((i=>{this._runClickAnimation(e.eggId,e.positionId,e.clickAnimation,i),setTimeout(t,e.clickAnimation?.duration||0)})):t()},onHideClick:function(e){window.ajax.post(this.URL,{act:this.ACT_HIDE_EVENT,event_id:e.eventId,egg_id:e.eggId,position_id:e.positionId},{onDone:()=>{this.updateEggs()},onFail:()=>!0})},_foundEgg:function(e,t,i,n){window.ajax.post(this.URL,{act:this.ACT_FOUND_EGG,egg_id:e,position_id:t,position_hash:i},{onDone:()=>{this.updateEggs(),n&&n()},onFail:()=>!0})},updateEggs:function(){this._flush(),window.ajax.post(this.URL,{act:this.ACT_EASTER_EGGS,url:window.location.pathname},{onDone:e=>{e&&this._init(e)},onFail:()=>!0})},_showPopup:function(e,t,i){u.Ranges.isUserId(window.vk.id)&&window.ajax.post(this.URL,{act:this.ACT_POPUP,egg_id:e},{onDone:(n,a,o)=>{if(!a)return;if("function"!=typeof window.MessageBox)return;const s=new window.MessageBox({title:n,hideButtons:!0,needShadow:!1,containerClass:"ImageStatusPopup__container",onShow:()=>{this.sendStats(r.IEasterEggsItemEventType.POPUP_SHOW,e,t,i),this.curBoxData={eggId:e,eggEventId:t,positionId:i}},onDestroy:()=>{this.curBoxData={}}});s.content(a),s.show(),setTimeout((()=>{s.evalBox(o,this.URL,{act:this.ACT_POPUP})}))},onFail:()=>!0})},sendStats:function(e,t=0,i=0,n=0){e===r.IEasterEggsItemEventType.POPUP_ACTION&&this.curBoxData&&(t=this.curBoxData.eggId,i=this.curBoxData.eggEventId,n=this.curBoxData.positionId),_.easterEggsItemStat.logEvent(t,i,n,e)},performAction:function(e,t){t.preventDefault(),this.sendStats(r.IEasterEggsItemEventType.POPUP_ACTION),e&&window.ajax.post(this.URL,{act:this.ACT_PERFORM_ACTION,jwt:e},{onDone:()=>((0,c.curBox)()?.hide(),!0),onFail:()=>((0,c.curBox)()?.hide(),!0)})},setLightTheme(e){e.preventDefault(),this.sendStats(r.IEasterEggsItemEventType.POPUP_ACTION),(0,c.curBox)()?.hide(),h.colorScheme.setMode(h.ColorSchemeMode.Light)}}},993016:(e,t,i)=>{var n=i(636576),a=i(959477);window.vk?.stDomain&&(i.p=window.vk.stDomain+"/dist/"),window.EasterEggs=a.EasterEggs,requestIdleCallback((()=>{try{(0,n.statlogsValueEvent)("entries_requests",1,"easter_eggs","web")}catch{}}),{timeout:5e3});try{stManager?.done(partConfigEnabled("web_static_manager_done_with_hash")?"dist/web/easter_eggs.78856f06.js":"dist/web/easter_eggs.js")}catch(e){}}},a={};function __webpack_require__(e){var t=a[e];if(void 0!==t)return t.exports;var i=a[e]={exports:{}};return n[e].call(i.exports,i,i.exports,__webpack_require__),i.exports}__webpack_require__.m=n,e=[],__webpack_require__.O=(t,i,n,a)=>{if(!i){var o=1/0;for(c=0;c<e.length;c++){for(var[i,n,a]=e[c],s=!0,r=0;r<i.length;r++)(!1&a||o>=a)&&Object.keys(__webpack_require__.O).every((e=>__webpack_require__.O[e](i[r])))?i.splice(r--,1):(s=!1,a<o&&(o=a));if(s){e.splice(c--,1);var _=n();void 0!==_&&(t=_)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[i,n,a]},__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},i=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,__webpack_require__.t=function(e,n){if(1&n&&(e=this(e)),8&n)return e;if("object"==typeof e&&e){if(4&n&&e.__esModule)return e;if(16&n&&"function"==typeof e.then)return e}var a=Object.create(null);__webpack_require__.r(a);var o={};t=t||[null,i({}),i([]),i(i)];for(var s=2&n&&e;"object"==typeof s&&!~t.indexOf(s);s=i(s))Object.getOwnPropertyNames(s).forEach((t=>o[t]=()=>e[t]));return o.default=()=>e,__webpack_require__.d(a,o),a},__webpack_require__.d=(e,t)=>{for(var i in t)__webpack_require__.o(t,i)&&!__webpack_require__.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},__webpack_require__.e=()=>Promise.resolve(),__webpack_require__.u=e=>{if(75477===e)return"chunks/"+e+".35e91db5.js"},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.p="/dist/",(()=>{__webpack_require__.b=document.baseURI||self.location.href;var e={26229:0};__webpack_require__.O.j=t=>0===e[t];var t=(t,i)=>{var n,a,[o,s,r]=i,_=0;if(o.some((t=>0!==e[t]))){for(n in s)__webpack_require__.o(s,n)&&(__webpack_require__.m[n]=s[n]);if(r)var c=r(__webpack_require__)}for(t&&t(i);_<o.length;_++)a=o[_],__webpack_require__.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return __webpack_require__.O(c)},i=self.webpackChunkvkweb=self.webpackChunkvkweb||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var o=__webpack_require__.O(void 0,[81765,59489],(()=>__webpack_require__(993016)));o=__webpack_require__.O(o)})();