"use strict";(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[4595],{10764:(t,e,o)=>{o.d(e,{MarketMarketAlbumTypeEnumNames:()=>i});const i={MARKET:0,MARKET_SERVICES:1}},56973:(t,e,o)=>{o.d(e,{memoizeFirstTruthy:()=>i});const i=t=>((t,e)=>{let o,i=!1;return(...r)=>(!0===i||(o=t(...r),i=e(o)),o)})(t,(t=>!!t))},150585:(t,e,o)=>{function i(t,e){let o,i,r=!1;return function a(){if(r)return o=arguments,void(i=this);t.apply(this,arguments),r=!0,setTimeout((function(){r=!1,o&&(a.apply(i,o),o=i=null)}),e)}}o.d(e,{throttle:()=>i})},335700:(t,e,o)=>{o.r(e),o.d(e,{UIGallery:()=>h,UI_GALLERY_CLASSNAME:()=>d.UI_GALLERY_CLASSNAME,UI_GALLERY_CONTENT_CLASSNAME:()=>d.UI_GALLERY_CONTENT_CLASSNAME,UI_GALLERY_INNER_CLASSNAME:()=>d.UI_GALLERY_INNER_CLASSNAME,uiGetGallery:()=>u});var i=o(558137),r=o(898848),a=o(939646),n=o(972332),s=o(593159),l=o(754866),d=o(15614);const c=(0,i.makeSharedState)("ui-gallery",(()=>({galleries:{},incIndex:0})),{version:0});function u(t){const e=(0,l.domData)((0,l.ge)(t),"gallery-id");return e&&c().galleries[e]}class h{_checkSizesAndUpdate(){return 0!==this._width&&0!==this._itemWidth||(this._width=Math.round((0,l.getSize)(this._el)[0]),this._itemWidth=(0,l.getSize)(this._items[0])[0],this._itemFullWidth=this._itemWidth+this._itemOffset),!(0===this._width||0===this._itemWidth)}_initScroll(){(this._opts.scrollX||this._opts.scrollY)&&(this._opts.isModernTransitionsEnabled||(0,n.addEvent)(this._innerCont,"DOMMouseScroll wheel",this._onWheelScroll.bind(this)))}_initArrows(){this._opts.noArrows?(0,l.addClass)(this._el,"ui_gallery_no_arrows"):(this._leftArrow=(0,l.geByClass1)("ui_gallery__arrow_left",this._el),this._rightArrow=(0,l.geByClass1)("ui_gallery__arrow_right",this._el),this._arrowWidth=(0,l.getSize)(this._leftArrow)[0],this._opts.isModernTransitionsEnabled?((0,n.addEvent)(this._leftArrow,"click",this._slide.bind(this,-1,void 0,{eventName:"arrow"})),(0,n.addEvent)(this._rightArrow,"click",this._slide.bind(this,1,void 0,{eventName:"arrow"}))):((0,n.addEvent)(this._leftArrow,"click",this._legacySlide.bind(this,-1,void 0,{eventName:"arrow"})),(0,n.addEvent)(this._rightArrow,"click",this._legacySlide.bind(this,1,void 0,{eventName:"arrow"}))),(0,n.addEvent)(this._leftArrow,"mouseover",this._onArrowMouseOver.bind(this,"left")),(0,n.addEvent)(this._leftArrow,"mouseout",this._onArrowMouseOut.bind(this)),(0,n.addEvent)(this._rightArrow,"mouseover",this._onArrowMouseOver.bind(this,"right")),(0,n.addEvent)(this._rightArrow,"mouseout",this._onArrowMouseOut.bind(this)))}_onWheelScroll(t){let e;if("wheel"==t.type)if(Math.abs(t.deltaY)>Math.abs(t.deltaX)){if(!this._opts.scrollY)return;e=-t.deltaY}else{if(!this._opts.scrollX)return;e=-t.deltaX}else if(void 0!==t.wheelDeltaY){if(!this._opts.scrollY)return;e=t.wheelDeltaY}else if(void 0!==t.wheelDelta)e=t.wheelDelta;else{if(!t.detail||1!==t.axis)return;e=-t.detail}e=this._scroll.rtlSame?-e:e,Math.abs(e)>=120&&(e=74*Math.max(-1,Math.min(1,e))),this._innerCont.scrollLeft-=e,this._checkItemsAfterScroll(this._innerCont.scrollLeft),(0,n.cancelEvent)(t)}_getScrollParams(){this._opts.shouldCheckGalleryViewed&&this._checkSizesAndUpdate();const t=this._width-2*this._arrowWidth,e=this._itemFullWidth>t;return{isItemBiggerThanWidth:e,scrollDistance:e?this._itemFullWidth:t}}_legacySlide(t,e,o){const{scrollDistance:i,isItemBiggerThanWidth:r}=this._getScrollParams();let s=this._innerCont.scrollLeft+(this._scroll.rtlSame?-t:t)*i;const d=this._innerCont.scrollWidth-this._width;this._scroll.negative?(s=Math.min(s,0),s=Math.abs(s)):s=Math.max(0,s),s=Math.min(d,s);const c=this._scroll.negative||this._scroll.rtlSame?-t:t;if(c>0&&s<d){s=Math.floor(s/this._itemFullWidth)*this._itemFullWidth}else if(c<0&&s>0){s=(r?Math.ceil(s/this._itemFullWidth):Math.floor(s/this._itemFullWidth))*this._itemFullWidth}if(this._opts.isFullSizeSlide&&(s=(this._visible.left+t)*this._itemFullWidth),0===s||s===d){const e=this._innerCont.scrollWidth;(0,l.addClass)(this._inner,"ui_gallery__inner_shift_instant"),this._onArrowMouseOut(),s&&(s+=t*(this._innerCont.scrollWidth-e))}this._scroll.negative&&(s=-s),(0,a.animate)(this._innerCont,{scrollLeft:s},{duration:Math.abs(this._innerCont.scrollLeft-s)+50,transition:a.Fx.Transitions.easeOutCubic}),this._checkItemsAfterScroll(s),setTimeout((()=>(0,l.removeClass)(this._inner,"ui_gallery__inner_shift_instant")),0),this._opts?.onSlide?.(t,{eventName:o?.eventName}),e&&(0,n.cancelEvent)(e)}_updateShift(t){let e=this._shift+t;const o=this._inner.scrollWidth-this._inner.clientWidth;e>o&&(e=o),e<0&&(e=0),this._shift=e}_slide(t,e,o){const{scrollDistance:i}=this._getScrollParams();this._updateShift(t*i),this._inner.style.transform=`translate3d(${-1*this._shift}px, 0, 0)`,this._checkItemsAfterScroll(this._shift),this._opts?.onSlide?.(t,{eventName:o?.eventName}),e&&(0,n.cancelEvent)(e)}_checkItemsAfterScroll(t,e){if(this._scroll.negative&&(t=Math.abs(t)),(!this._opts.shouldCheckGalleryViewed||this._visible.isGalleryViewed)&&(!this._opts.shouldCheckGalleryViewed||this._checkSizesAndUpdate())){if(this._opts.markOutside||this._opts.onViewItem){const o=this._itemWidth/3,i=(this._scroll.backward?this._inner.scrollWidth-this._width-t:t)-this._scrollOffset,r=t&&Math.floor(i/this._itemFullWidth),a=r*this._itemFullWidth+2*o;let n;n=this._scroll.backward?t+this._width<this._inner.scrollWidth-a:t>a;const d=Math.min(this._items.length-1,Math.floor((i+this._width)/this._itemFullWidth)),c=d*this._itemFullWidth+2*o;let u;if(u=this._scroll.backward?t>this._inner.scrollWidth-c:t+this._width<c,this._opts.onViewItem){const t=n?Math.min(this._items.length-1,r+1):r,o=u?Math.max(0,d-1):d;if(e||t!==this._visible.left||o!==this._visible.right){for(let i=t;i<=o;i++)(this._visible.left<0||e&&!(0,s.inArray)(this._items[i],this._visible.items)||i<this._visible.left||i>this._visible.right)&&this._opts.onViewItem(this._items[i],i);this._visible.left=t,this._visible.right=o,this._visible.items=this._items.slice(t,o+1)}}this._opts.markOutside&&(e?((0,l.geByClass)("ui_gallery_item_outside",this._inner).forEach((t=>{(0,l.removeClass)(t,"ui_gallery_item_outside")})),this._outside.left=-1,this._outside.right=-1):((r!==this._outside.left||!n)&&this._outside.left>=0&&((0,l.removeClass)(this._items[this._outside.left],"ui_gallery_item_outside"),this._outside.left=-1),(d!==this._outside.right||!u)&&this._outside.right>=0&&((0,l.removeClass)(this._items[this._outside.right],"ui_gallery_item_outside"),this._outside.right=-1)),n&&r!==this._outside.left&&((0,l.addClass)(this._items[r],"ui_gallery_item_outside"),this._outside.left=r),u&&d!==this._outside.right&&((0,l.addClass)(this._items[d],"ui_gallery_item_outside"),this._outside.right=d))}if(!this._opts.noArrows){const e=t>0,o=t+this._width<this._inner.scrollWidth;(0,l.toggleClass)(this._leftArrow,"ui_gallery__arrow_visible",this._scroll.rtl&&!this._scroll.backward?o:e),(0,l.toggleClass)(this._rightArrow,"ui_gallery__arrow_visible",this._scroll.rtl&&!this._scroll.backward?e:o)}(!this._scroll.backward&&this._inner.scrollWidth-t-this._width<1e3||this._scroll.backward&&t<1e3)&&this._onLoadMore()}}_onArrowMouseOver(t){this._inner.classList.add(`ui_gallery__inner_shift_${t}`)}_onArrowMouseOut(){this._inner.classList.remove("ui_gallery__inner_shift_left"),this._inner.classList.remove("ui_gallery__inner_shift_right")}_onLoadMore(){!this._opts.onLoadMore||this._loadingMore||this._finised||(this._loadingMore=!0,this._opts.onLoadMore(this._items.length))}addMore(t,e){t=t||[],this.addItems(t),this._finised=!!e||!t.length,this._loadingMore=!1}addItems(t,e){if((t=t||[]).length){const o=e>=0&&e<this._items.length?this._items[e]:null;t.forEach((t=>{o?(0,l.domInsertBefore)(t,o):this._inner.appendChild(t)})),this.refresh()}}destroy(){(0,n.removeEvent)(this._innerCont),(0,n.removeEvent)(this._leftArrow),(0,n.removeEvent)(this._rightArrow),(0,l.domData)(this._el,"gallery-id",null),delete c().galleries[this._id],this._opts.onDestroy&&this._opts.onDestroy(),(0,l.re)(this._el)}removeItem(t){return(0,r.isNumeric)(t)&&(t=this._items[t]),!(!t||!(0,s.inArray)(t,this._items))&&((0,l.re)(t),this.refresh(),this._items.length||this.destroy(),!0)}refresh(){this._width=Math.round((0,l.getSize)(this._el)[0]),this._items=(0,l.geByClass)("ui_gallery_item",this._el),this._checkItemsAfterScroll(this._innerCont.scrollLeft,!0)}scrollToDirection(t){this._opts.isModernTransitionsEnabled?this._slide(t,void 0,{eventName:"bullet"}):this._legacySlide(t,void 0,{eventName:"bullet"})}getItems(){return this._items}getVisibleItems(){return this._visible.items.map(((t,e)=>[t,this._visible.left+e]))}setGalleryViewed(){this._visible.isGalleryViewed=!0,this._checkItemsAfterScroll(this._innerCont.scrollLeft)}constructor(t,e){if(!t)throw new Error("No element was provided for UIGallery");if(!(t=(0,l.ge)(t)).classList.contains(d.UI_GALLERY_CLASSNAME))throw new Error("Provided incorrect element for UIGallery");const o=u(t);if(o)return o;this._opts=(0,s.extend)({markOutside:!1,scrollY:!0,scrollX:!0,noArrows:!1,isFullSizeSlide:!1,isModernTransitionsEnabled:!1},e),this._id=c().incIndex,c().incIndex+=1,this._el=t,this._width=Math.round((0,l.getSize)(this._el)[0]),this._items=(0,l.geByClass)("ui_gallery_item",this._el),this._itemWidth=(0,l.getSize)(this._items[0])[0],this._itemOffset=(0,s.intval)((0,l.getStyle)(this._items[0],vk.rtl?"marginLeft":"marginRight")),this._scrollOffset=(0,s.intval)((0,l.getStyle)(this._items[0],"marginLeft")),this._itemFullWidth=this._itemWidth+this._itemOffset,this._innerCont=(0,l.geByClass1)(d.UI_GALLERY_CONTENT_CLASSNAME,this._el),this._inner=(0,l.geByClass1)(d.UI_GALLERY_INNER_CLASSNAME,this._el),this._opts.isModernTransitionsEnabled&&(this._shift=0,this._inner.classList.add("ui_gallery__inner--withTransitions")),this._scroll=function(){const t={rtl:!1,backward:!1,delta:1,negative:!1,rtlSame:!1};if(!vk.rtl)return t;if(!cur._scrollInfo){const e=(0,l.se)('<div style="position: fixed; left: -1000px; width: 0; overflow: scroll">x</div>'),o=document.querySelector("#content");o?.appendChild(e);const i=e.scrollLeft;t.rtl=vk.rtl,t.backward=i>0,e.scrollLeft=1e3,t.delta=e.scrollLeft===i?-1:1,t.negative=!t.backward&&t.delta<0,t.rtlSame=t.rtl&&!t.backward&&!t.negative,(0,l.re)(e),cur._scrollInfo=t}return cur._scrollInfo}(),this._loadingMore=!1,this._finised=!1,this._visible={left:-1,right:-1,items:[],isGalleryViewed:!1},this._outside={left:-1,right:-1,timer:null},this._initScroll(),this._initArrows(),(0,l.domData)(this._el,"gallery-id",this._id),c().galleries[this._id]=this,this._checkItemsAfterScroll(this._innerCont.scrollLeft,!0)}}},268008:(t,e,o)=>{o.d(e,{AttachmentPlatformProvider:()=>n,useAttachmentPlatformContext:()=>a});var i=o(296540);const r=(0,i.createContext)(void 0),a=()=>{const t=(0,i.useContext)(r);if(!t)throw new Error("useAttachmentPlatformContext must be called within AttachmentPlatformProvider! Consider adding MVKAttachmentProvider or WebAttachmentProvider.");return t},n=r.Provider},457654:(t,e,o)=>{o.d(e,{Carousel:()=>u});var i=o(474848),r=o(296540),a=o(8520),n=o(753457),s=o(849397),l=o(268008),d=o(540462),c=o(940286);const u=(0,o(456921).observer)((function({children:t,onChange:e,className:o,...u}){const h=(0,r.useRef)(null),{onCarouselSlideChange:m,onCarouselNextClick:_,onCarouselPrevClick:p,subscribeOnCarouselModalClose:A}=(0,l.useAttachmentPlatformContext)(),{viewWidth:g}=(0,n.useAdaptivityWithJSMediaQueries)(),f=g<n.ViewWidth.TABLET,y=(0,c.usePostSharedState)();(0,r.useEffect)((()=>A?.((()=>y.setCurrentSlideIndex(y.currentSlideIndex)))),[]);return(0,r.useEffect)((()=>{if(!h.current)return;const t=new window.ResizeObserver((()=>{h.current?.closest(".visually-hidden")||window.dispatchEvent(new Event("resize"))}));return t.observe(h.current),()=>{t.disconnect()}}),[]),(0,i.jsx)(s.Carousel,{getRootRef:h,slideIndex:y.currentSlideIndex,onChange:t=>{const o=t-y.currentSlideIndex;y.setCurrentSlideIndex(t),f&&(1===o&&_?.(),-1===o&&p?.());const i=h.current,r=i?.querySelectorAll(".attachmentCarousel__slide")?.[t];e?.(t),m?.(i,r)},onNextClick:()=>{f||_?.()},onPrevClick:()=>{f||p?.()},className:(0,a.classNames)(o,"attachmentCarousel"),borderRadius:(0,d.partConfigEnabled)("feed_react_post")?0:8,...u,children:t})}))},165794:(t,e,o)=>{o.d(e,{Carousel:()=>i.Carousel});var i=o(457654)},59072:(t,e,o)=>{o.d(e,{MediaGrid:()=>u});var i=o(474848),r=o(140935),a=o(193262),n=o(268008),s=o(839185),l=o(296540),d=o(575753),c=o(540462);const u=({postId:t,attachments:e,onRestrictedClick:o})=>{const{maxImageWidth:u,maxContainerWidth:h,action:m,onRestrictedPhoto:_}=(0,n.useAttachmentPlatformContext)(),[p,A]=(0,l.useState)([]),g=(0,l.useMemo)((()=>e.filter((t=>"full"===t.style&&(0,a.isSupportedMediaGrid)(t)))),[e]),f=Boolean(1===g.length&&g[0].photo),y=(0,l.useCallback)((()=>{const t=g[0];1===g.length&&t.photo&&_(t.photo).then((t=>{o({owner_id:t.owner_id,photo_id:t.id}),A((t=>[{...t[0],restriction:void 0}]))}))}),[g,o,_]);return(0,l.useEffect)((()=>{const e=m(t);A(g.map(((t,o)=>({...(0,a.mapMediaGridAttachment)(t),action:e({attachment:t,index:o,count:g.length}),restriction:(0,a.extractRestriction)(t)}))))}),[g,m]),(0,i.jsx)(r.MediaGrid,{innerBorderRadius:(0,c.partConfigEnabled)("feed_react_post")?0:void 0,wrapperBorderRadius:(0,c.partConfigEnabled)("feed_react_post")?0:void 0,useMaskImage:d.browser.safari,maxImageWidth:u,features:s.MEDIA_GRID_FEATURES,attachments:p,maxContainerWidth:h,background:(0,s.getMediaGridBackgroundType)(),onRestrictedClick:f?y:void 0})}},193262:(t,e,o)=>{o.d(e,{extractId:()=>p,extractOverlay:()=>m,extractPhotoSizes:()=>c,extractRestriction:()=>_,isSupportedMediaGrid:()=>g,mapMediaGridAttachment:()=>A});var i=o(317835),r=o(661925),a=o(866467),n=o(277136),s=o(995500),l=o(935205);const d=t=>{const e={url:t.url||t.src||"",width:t.width,height:t.height,type:t.type};return t.type&&(e.type=t.type),e},c=t=>{switch(t.type){case s.WallpostAttachmentType.ALBUM:return t.album?.thumb?.sizes?.map(d)||[];case s.WallpostAttachmentType.MARKET_ALBUM:return t.market_album?.photo?.sizes?.map(d)||[];case s.WallpostAttachmentType.DOC:return e=t.doc?.preview,e?.photo?.sizes?e.photo.sizes.map(d):e?.video?[d(e.video)]:e?.graffiti?[d(e.graffiti)]:[];case s.WallpostAttachmentType.PHOTO:return t.photo?.sizes?.map(d)||[];case s.WallpostAttachmentType.VIDEO:case s.WallpostAttachmentType.CLIP:let o=t.video?.image?.filter((t=>!t.with_padding));return o?.length||(o=t.video?.image),o?.map(d)||[];case s.WallpostAttachmentType.GRAFFITI:const{width:i,height:r,url:a,photo_200:n,photo_586:l}=t.graffiti||{};if(i&&r&&a)return[{url:a,width:i,height:r}];if(n||l){const t=[];return n&&t.push({url:n,width:200,height:200}),l&&t.push({url:l,width:586,height:586}),t}return[];case s.WallpostAttachmentType.MINI_APP:return t.mini_app?.images?.map(d).filter((t=>t.width/t.height!=1))||[]}var e;return[]},u=["upcoming","waiting"],h=["started","upcoming","waiting"],m=t=>{const{photo:e,doc:o,album:s,video:d,market_album:c}=t;if(e)return{kind:"photo",hasNFT:Boolean(e.nft?.nft_public_id),hasMarket:e.has_tags};if(o)return(0,l.canPageShowGif)(o)?{kind:"gif",formattedSize:(0,i.formatFileSize)(o.size)}:{kind:"doc",ext:o.ext,formattedSize:(0,i.formatFileSize)(o.size)};if(d){const t="interactive"===d.type,e=t?a.getLang("video_interactive_label"):d.platform,o=h.find((t=>t===d.live_status)),i="live"===d.type&&!!o;return{kind:"video",platform:e,canPlay:!d.live_status||!u.includes(d.live_status),formattedDuration:d.duration?(0,r.formatVideoDuration)(d.duration,d.live_status):void 0,hidePlayButton:!!d.restriction,isInteractive:t,isLive:i,liveType:o}}return s?{kind:"album",title:s.title,size:s.size,formattedSize:(0,a.langNumeric)(s.size,a.getLang("mobile_post_photos_count","raw"))}:c?{kind:"market_album",title:c.title,size:c.count,formattedSize:(0,n.formatMarketAlbumSize)(c)}:void 0},_=t=>{const e=(t=>{switch(t.type){case s.WallpostAttachmentType.ALBUM:return t.album?.thumb?.restrictions;case s.WallpostAttachmentType.MARKET_ALBUM:return t.market_album?.photo?.restrictions;case s.WallpostAttachmentType.PHOTO:return t.photo?.restrictions;case s.WallpostAttachmentType.VIDEO:case s.WallpostAttachmentType.CLIP:return t.video?.restriction}})(t);if(e){const o=(t=>"delete_outline"===t.icon_name?"deleted":t.blur||t.can_preview?"restricted":"blocked")(e),i=[s.WallpostAttachmentType.VIDEO,s.WallpostAttachmentType.CLIP].includes(t.type)?a.getLang("video_restriction_title_unavailable"):a.getLang("photos_geo_restriction_title");let r=e.button?.title;return r||"restricted"!==o||(r=a.getLang("wall_restriction_action_text")),{type:o,text:"blocked"===o?e.text:e.title,shortText:i,actionText:r}}},p=t=>{const{id:e=0}=t.album||t.photo||t.doc||t.video||t.market_album||t.graffiti||t.audio||t.link||{};return String(e)},A=t=>({id:p(t),sizes:c(t)||[],overlay:m(t),canExtendBackground:"photo"===t.type||"doc"===t.type}),g=t=>{switch(t.type){case s.WallpostAttachmentType.ALBUM:case s.WallpostAttachmentType.PHOTO:case s.WallpostAttachmentType.MARKET_ALBUM:case s.WallpostAttachmentType.VIDEO:case s.WallpostAttachmentType.CLIP:case s.WallpostAttachmentType.GRAFFITI:return!0;case s.WallpostAttachmentType.DOC:return Boolean(t.doc?.preview)}return!1}},821968:(t,e,o)=>{o.d(e,{MediaGrid:()=>i.MediaGrid});var i=o(59072)},223127:(t,e,o)=>{o.d(e,{ModuleAttachmentProvider:()=>n,useModuleAttachmentContext:()=>a});var i=o(296540);const r=(0,i.createContext)({PrimaryAttachmentWrapper:({children:t})=>t}),a=()=>(0,i.useContext)(r),n=r.Provider},254020:(t,e,o)=>{o.d(e,{PrimaryAttachmentAudio:()=>A});var i=o(474848),r=o(753457),a=o(365971),n=o(866467),s=o(575753),l=o(452046),d=o(29560),c=o(296540),u=o(65465),h=o(628318),m=o(943226),_=o(738313),p=o(268008);const A=({audio:t})=>{const e=(0,d.useAudioPlayer)(),{viewWidth:o}=(0,r.useAdaptivityWithJSMediaQueries)(),{onRestrictedAudio:A}=(0,p.useAttachmentPlatformContext)(),{added:g,addOrDeleteAudio:f}=(0,m.useAddDeleteAudio)(t),y=(0,h.isActiveAudio)(t,e),v=Boolean(t.content_restricted||Number(t.region_restrictions)),[w,P]=(0,c.useState)(v?"restricted":"stopped"),b=(0,c.useMemo)((()=>({coverUrl:t?.album?.thumb?.photo_300,title:t.title,artist:t.artist,isExplicit:Boolean(t.is_explicit)})),[t]);return(0,c.useEffect)((()=>{v||(y&&e.status!==_.AudioPlayerStatus.NO&&e.status!==_.AudioPlayerStatus.INIT&&P(e.status),y||P(_.AudioPlayerStatus.STOPPED))}),[v,y,e.status]),(0,i.jsx)(a.PrimaryAttachmentAudio,{audio:b,toggleAudio:()=>{const o=(0,h.isPlayingAudio)(t,e,y),i=e.platformAudioPlayer;o?i?.pause():i?.playAudio(t,[t],e.audioPlayerContext,{type:u.AudioPlayerAdapterPlaylistType.WALL,ownerId:t.owner_id,albumId:t.album?t.album.id:t.album_id??0})},addAudio:f,status:w,addIconKind:g?"done":"add",onRestricted:()=>{A(t)},canAddOrDeleteAudio:(0,l.canAddOrDeleteAudio)(),textListen:n.getLang("audio_primary_attachment_audio_listen"),ariaLabelAdd:n.getLang("audio_add_to_audio"),ariaLabelDone:n.getLang("audio_delete_audio"),imageLoading:"eager",blurType:s.browser.chrome?"svg":"backdrop",size:o<r.ViewWidth.TABLET?"s":"m"})}},618503:(t,e,o)=>{o.d(e,{PrimaryAttachmentAudio:()=>i.PrimaryAttachmentAudio});var i=o(254020)},732664:(t,e,o)=>{o.d(e,{PrimaryAttachmentClip:()=>d});var i=o(474848),r=o(807775),a=o(873900),n=o(112082),s=o(446314),l=o(268008);const d=({postId:t,attachment:e})=>{const{maxContainerWidth:o,onClipClick:d}=(0,l.useAttachmentPlatformContext)(),c=(0,a.getIdentityRawId)({id:e.clip.id??0,ownerId:e.clip.owner_id??0});return(0,i.jsx)(n.PrimaryAttachmentClipWrapper,{videoRawId:c,postId:t,coverWidth:o,ratio:e.clip.restriction?r.Ratio.VIDEO_MAX:r.Ratio.HIGH,getPlayer:t=>(0,i.jsx)(s.ClipPlayerWidget,{...t,onClick:t=>d(t,c),borderRadius:"none"})})}},993361:(t,e,o)=>{o.d(e,{PrimaryAttachmentClip:()=>r.PrimaryAttachmentClip,isWallWallpostAttachmentClip:()=>i.isWallWallpostAttachmentClip});var i=o(69732),r=o(732664)},69732:(t,e,o)=>{o.d(e,{isWallWallpostAttachmentClip:()=>i});const i=t=>"type"in t&&"clip"===t.type&&"clip"in t&&"object"==typeof t.clip&&!Array.isArray(t.clip)},98540:(t,e,o)=>{o.d(e,{PrimaryAttachmentGif:()=>g});var i=o(474848),r=o(296540),a=o(268008),n=o(839185),s=o(193262),l=o(575753),d=o(24063),c=o(753457),u=o(288208),h=o(935205),m=o(866467),_=o(48269),p=o(168799),A=o(103881);const g=({index:t,count:e,ratio:o,postId:g,attachment:f,gifExtras:y})=>{const[v,w]=(0,r.useState)(!1),{maxImageWidth:P,maxContainerWidth:b,action:C,gifActions:S}=(0,a.useAttachmentPlatformContext)(),{add:E,show:I,share:T}=S,k=(0,n.getPrimaryAttachmentBackgroundType)(),L=Boolean(E&&y?.addHash),x=(0,h.extractHash)(f.doc),R=(0,h.getDocFullId)(f.doc),{sizes:M,overlay:O}=(0,r.useMemo)((()=>({sizes:(0,s.extractPhotoSizes)(f),overlay:(0,s.extractOverlay)(f)})),[f]),W=(0,r.useMemo)((()=>(0,u.makeMediaData)({sizes:M},{maxImageWidth:P,isHeightLimitEnabled:n.PRIMARY_ATTACHMENT_FEATURES.isHeightLimitEnabled})),[M,P]),D=(0,r.useMemo)((()=>C(g)({attachment:f,index:t,count:e})),[g,f,t,e]),N=(0,r.useCallback)((t=>{y?.addHash&&(E?.(t.currentTarget,R,x,y.addHash),w((t=>!t)))}),[E]),B=(0,r.useCallback)((t=>{I(t.currentTarget,t)}),[I]),F=(0,r.useCallback)((t=>T?.(t.currentTarget,R,x,t)),[T]);return(0,i.jsx)("div",{className:"PrimaryAttachmentGif",children:(0,i.jsx)(d.PrimaryAttachmentGif,{noBorderRadius:!0,ratio:o,sizes:M,action:{...D,onClick:B},overlay:O,background:k,useMaskImage:l.browser.safari,maxImageWidth:P,maxContainerWidth:b,features:n.PRIMARY_ATTACHMENT_FEATURES,overlayClassName:"page_gif_autoplay","data-thumb":W?.thumb?.url??"","data-preview":+Boolean(f.doc?.preview?.video),children:(0,i.jsxs)(d.PrimaryAttachmentGif.Actions,{children:[T&&(0,i.jsx)(c.Tooltip,{text:m.getLang("wall_doc_share"),children:(0,i.jsx)(d.PrimaryAttachmentGif.Action,{onClick:F,label:m.getLang("wall_doc_share"),icon:(0,i.jsx)(_.Icon24ShareOutline,{})})}),L&&(0,i.jsx)(c.Tooltip,{text:m.getLang("wall_doc_add"),children:(0,i.jsx)(d.PrimaryAttachmentGif.Action,{onClick:N,label:m.getLang("wall_doc_add"),icon:v?(0,i.jsx)(p.Icon20Check,{}):(0,i.jsx)(A.Icon24AddOutline,{})})})]})})})}},582703:(t,e,o)=>{o.d(e,{PrimaryAttachmentGif:()=>i.PrimaryAttachmentGif});var i=o(98540)},820826:(t,e,o)=>{o.d(e,{isWallWallpostAttachmentGif:()=>i});const i=t=>"type"in t&&"doc"===t.type&&"doc"in t&&"object"==typeof t.doc&&!Array.isArray(t.doc)},924572:(t,e,o)=>{o.d(e,{PrimaryAttachmentMiniApp:()=>c});var i=o(474848),r=o(422283),a=o(279734),n=o(628843),s=o(268008),l=o(296540),d=o(193262);const c=({attachment:t,postId:e})=>{const{maxImageWidth:o,maxContainerWidth:c,action:u}=(0,s.useAttachmentPlatformContext)(),h=(0,l.useMemo)((()=>(0,d.extractPhotoSizes)(t)),[t]),m=(0,l.useMemo)((()=>u(e)({attachment:t})),[e,t]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.PrimaryAttachmentPhoto,{noBorderRadius:!0,background:"gray_fields",action:m,ratio:h[0]?.width/h[0]?.height,maxContainerWidth:c,maxImageWidth:o,sizes:h}),Boolean(t.mini_app?.description&&m?.href)&&(0,i.jsx)(a.Link,{href:m?.href,target:m?.isExternal?"_blank":"",children:(0,i.jsx)(n.FeedActionCell,{expandable:"always",maxHeight:44,children:t.mini_app?.description})})]})}},989047:(t,e,o)=>{o.d(e,{PrimaryAttachmentMiniApp:()=>r.PrimaryAttachmentMiniApp,isWallWallpostAttachmentMiniApp:()=>i.isWallWallpostAttachmentMiniApp});var i=o(345250),r=o(924572)},345250:(t,e,o)=>{o.d(e,{isWallWallpostAttachmentMiniApp:()=>i});const i=t=>"type"in t&&"mini_app"===t.type&&"mini_app"in t&&"object"==typeof t.mini_app&&!Array.isArray(t.mini_app)},305084:(t,e,o)=>{o.d(e,{PrimaryAttachmentPhotoDoc:()=>_,isPrimaryPhotoDoc:()=>m});var i=o(474848),r=o(422283),a=o(359935),n=o(193262),s=o(268008),l=o(839185),d=o(296540),c=o(995500),u=o(575753),h=o(540462);const m=t=>[c.WallpostAttachmentType.PHOTO,c.WallpostAttachmentType.DOC].includes(t.type),_=({index:t,count:e,ratio:o,postId:m,attachment:_,onRestrictedClick:p,onClose:A})=>{const{maxImageWidth:g,maxContainerWidth:f,action:y,onRestrictedPhoto:v}=(0,s.useAttachmentPlatformContext)(),w=(t=>{switch(t.type){case c.WallpostAttachmentType.PHOTO:return r.PrimaryAttachmentPhoto;case c.WallpostAttachmentType.DOC:return a.PrimaryAttachmentDocument}})(_),P=(0,l.getPrimaryAttachmentBackgroundType)(),[b,C]=(0,d.useState)((()=>(0,n.extractRestriction)(_))),S=(0,d.useCallback)((()=>{_.photo&&v(_.photo).then((t=>{C(void 0),p({owner_id:t.owner_id,photo_id:t.id})}))}),[_,p]),{sizes:E,overlay:I}=(0,d.useMemo)((()=>({sizes:(0,n.extractPhotoSizes)(_),overlay:(0,n.extractOverlay)(_)})),[_]),T=(0,d.useMemo)((()=>y(m)({attachment:_,index:t,count:e,onClose:A})),[m,_,t,e]);return w?(0,i.jsx)(w,{noBorderRadius:(0,h.partConfigEnabled)("feed_react_post"),ratio:o,sizes:E,action:T,overlay:I,background:P,restriction:b,useMaskImage:u.browser.safari,maxImageWidth:g,maxContainerWidth:f,features:l.PRIMARY_ATTACHMENT_FEATURES,onRestrictedClick:_.photo?S:void 0}):null}},32893:(t,e,o)=>{o.d(e,{PrimaryAttachmentPhotoDoc:()=>i.PrimaryAttachmentPhotoDoc,isPrimaryPhotoDoc:()=>i.isPrimaryPhotoDoc});var i=o(305084)},339246:(t,e,o)=>{o.d(e,{PrimaryAttachmentVideo:()=>h});var i=o(474848),r=o(296540),a=o(95781),n=o(807775),s=o(575753),l=o(268008),d=o(193262),c=o(839185),u=o(355711);const h=({index:t,count:e,ratio:o,postId:h,attachment:m,video:_,adData:p,mode:A="primary"})=>{const{maxImageWidth:g,maxContainerWidth:f,action:y,destroyInlineVideoPlayer:v}=(0,l.useAttachmentPlatformContext)(),w=(0,r.useRef)(null);(0,r.useEffect)((()=>()=>{w.current&&v?.(w.current)}),[]);const{sizes:P,overlay:b}=(0,r.useMemo)((()=>({sizes:(0,d.extractPhotoSizes)(m),overlay:(0,d.extractOverlay)(m)})),[m]),C=(0,r.useMemo)((()=>y(h,A)({attachment:m,index:t,count:e})),[h,m,t,e]),S=(0,r.useMemo)((()=>(0,d.extractRestriction)(m)),[]),E=(0,u.getVideoRatio)(m,o),I=(0,r.useMemo)((()=>(0,u.getVideoExtraProps)(m,_,E,p)),[E,m,_?.isAutoplayEnabled,p]);return(0,i.jsx)(a.PrimaryAttachmentVideo,{...I,noBorderRadius:!0,ratio:E,sizes:P,action:C,getRootRef:w,overlay:b,maxImageAvailableRatio:n.Ratio.VIDEO_MAX,background:"black_fields",onRestrictedClick:C?.onClick,restriction:S,useMaskImage:s.browser.safari,maxImageWidth:g,maxContainerWidth:f,features:c.PRIMARY_ATTACHMENT_FEATURES})}},355711:(t,e,o)=>{o.d(e,{getVideoExtraProps:()=>n,getVideoRatio:()=>l});var i=o(807775),r=o(538522),a=o(540462);const n=(t,e,o,n)=>{const s=t.video;let l="";e?.isAutoplayEnabled&&(l+=" page_video_autoplayable"),s.restriction&&(l+=" VideoRestriction"),o&&o!==i.Ratio.SQUARE&&(l+=" page_video_croppable");let d=s.access_key,c=null;s.owner_id&&s.id&&(c=(0,r.joinRawId)({ownerId:s.owner_id,itemId:s.id}),!d&&s.album_id&&(d=(0,r.joinRawId)({ownerId:s.owner_id,itemId:s.album_id})));const u={};return(0,a.partConfigEnabled)("post_adblock_protection_promo")&&(u["data-post-locator"]='"'),s?.promo_post_hash&&(u["data-promo-post-hash"]=s.promo_post_hash),s?.should_stretch&&(u["data-stretch-vertical"]="1"),c&&(u["data-video"]=c),s.duration&&(u["data-duration"]=`${s.duration}`),n&&(u["data-ad-data"]=n),{"data-list":d,wrapperClassName:l,...u}},s=t=>Math.min(i.Ratio.VIDEO_MAX,Math.max(t,i.Ratio.HIGH)),l=(t,e)=>{if(e)return e;if(!t.video?.image?.length)return i.Ratio.VIDEO_MAX;const o=t.video.image.filter((t=>!t.with_padding));if(!o.length)return;if(t.video?.width&&t.video?.height)return s(t.video.width/t.video.height);const r=t.video.image[0];return s(r.width/r.height)}},794990:(t,e,o)=>{o.d(e,{PrimaryAttachmentVideo:()=>i.PrimaryAttachmentVideo,isWallWallpostAttachmentVideo:()=>r.isWallWallpostAttachmentVideo});var i=o(339246),r=o(227319)},227319:(t,e,o)=>{o.d(e,{isWallWallpostAttachmentVideo:()=>i});const i=t=>"type"in t&&"video"===t.type&&"video"in t&&"object"==typeof t.video&&!Array.isArray(t.video)},62267:(t,e,o)=>{o.d(e,{PrimaryAttachmentAudio:()=>i.PrimaryAttachmentAudio,PrimaryAttachmentPhotoDoc:()=>r.PrimaryAttachmentPhotoDoc,PrimaryAttachmentVideo:()=>a.PrimaryAttachmentVideo,isPrimaryPhotoDoc:()=>r.isPrimaryPhotoDoc,isWallWallpostAttachmentVideo:()=>a.isWallWallpostAttachmentVideo});var i=o(618503),r=o(32893),a=o(794990)},215596:(t,e,o)=>{o.d(e,{SecondaryAttachmentAudio:()=>A});var i=o(474848),r=o(728251),a=o(29560),n=o(628318),s=o(303913),l=o(694430),d=o(47677),c=o(800483),u=o(296540),h=o(363046),m=o(943226),_=o(268008),p=o(413666);const A=({originalAttachment:t,attachment:e,action:o,queue:A,feedV3Redesign:g})=>{const f=(0,a.useAudioPlayer)(),{onRestrictedAudio:y,noHorizontalPaddingOnSecondary:v,musicShowProgress:w}=(0,_.useAttachmentPlatformContext)(),P=t.audio||t.audio_playlist||t.podcast,{added:b,addOrDeleteAudio:C}=(0,m.useAddDeleteAudio)(t.audio),S=Boolean(P&&(0,n.isActiveAudio)(P,f)),E=Boolean(P&&(0,n.isPlayingAudio)(P,f,S)),I=E?"equalizer_active":"equalizer_idle",T=(0,u.useMemo)((()=>{const o=[];return t.audio&&o.push({...p.audioAfterAddActionStaticFields,ariaLabel:(0,n.getAudioAddDeleteAriaLabel)(b),icon:b?(0,i.jsx)(s.Icon24Done,{}):(0,i.jsx)(l.Icon24Add,{}),onClick:e.restricted?void 0:t=>{(0,h.cancelEvent)(t),C()}}),o.push({...p.audioAfterPlayActionStaticFields,ariaLabel:(0,n.getAudioPlayPauseAriaLabel)(E,e.content.title,e.content.description),icon:E?(0,i.jsx)(d.Icon24Pause,{}):(0,i.jsx)(c.Icon24Play,{}),onClick:t.audio||e.restricted?void 0:(0,n.getAudioAction)(t,E,f)}),o}),[e,E,t,C,f.platformAudioPlayer,f.audioPlayerContext]),k=(0,u.useMemo)((()=>{if(e.restricted&&!e.isDonut){const e=t.audio||t.podcast;if(!e)return;return{onClick:()=>y(e)}}return t.audio?{...o,ariaLabel:(0,n.getAudioPlayPauseAriaLabel)(E,e.content.title,e.content.description),onClick:(0,n.getAudioAction)(t,E,f,A)}:o}),[e,o,t,E,f.platformAudioPlayer,f.audioPlayerContext,A]);return(0,i.jsx)(r.SecondaryAttachment,{attachment:e,noHorizontalPadding:v,action:k,after:T,showProgressBars:w&&S,overlay:S?I:void 0,verticalPaddingRedesign:g,duration:t.audio?.duration,progress:f?.currentAudioProgress,volume:f?.currentAudioVolume,onVolumeChange:t=>f?.platformAudioPlayer?.setVolume(t),onSeek:t=>f?.platformAudioPlayer?.setCurrentAudioProgress(t),bufferingProgress:f?.currentAudioProgress})}},564858:(t,e,o)=>{o.d(e,{audioAction:()=>a});var i=o(363046),r=o(65465);const a=({player:t,audio:e,context:o,isPlaying:a,queue:n})=>s=>{(0,i.cancelEvent)(s),a?t.pause():t.playAudio(e,n??[e],o,{type:r.AudioPlayerAdapterPlaylistType.WALL,ownerId:e.owner_id,albumId:e.album?e.album.id:e.album_id??0})}},765043:(t,e,o)=>{o.d(e,{audioPlaylistAction:()=>r});var i=o(363046);const r=({audio:t,isPlaying:e,context:o,player:r})=>{const a=t.restriction;return n=>{(0,i.cancelEvent)(n),a||(e?r.pause():r.playPlaylist(t,o,t.audios))}}},413666:(t,e,o)=>{o.d(e,{audioAfterAddActionStaticFields:()=>r,audioAfterPlayActionStaticFields:()=>i});const i={key:"audio_play_pause",kind:"icon_button",style:"circle",icon:void 0,ariaLabel:""},r={key:"audio_add_delete",kind:"icon_button",icon:void 0,ariaLabel:""}},294567:(t,e,o)=>{o.d(e,{SecondaryAttachmentAudio:()=>i.SecondaryAttachmentAudio});var i=o(215596)},943226:(t,e,o)=>{o.d(e,{useAddDeleteAudio:()=>n});var i=o(296540),r=o(513109),a=o(181155);const n=t=>{const[e,o]=(0,i.useState)(),n=(0,i.useCallback)((()=>{t&&(e?(0,a.deleteAudio)({audio_id:e,owner_id:window.vk.id}).then((()=>o(void 0))):(0,r.addAudio)({audio_id:t.id,owner_id:t.owner_id,access_key:t.access_key,track_code:t.track_code}).then((t=>o(t.items?.[0]?.new_audio_id))))}),[e,t]);return{added:Boolean(e),addOrDeleteAudio:n}}},628318:(t,e,o)=>{o.d(e,{getAudioAction:()=>u,getAudioAddDeleteAriaLabel:()=>c,getAudioPlayPauseAriaLabel:()=>d,isActiveAudio:()=>s,isPlayingAudio:()=>l});var i=o(738313),r=o(866467),a=o(765043),n=o(564858);const s=(t,e)=>{const{currentAudio:o,currentPlaylist:i}=e;return"audios"in t?i?.id===t.id:o?.id===t.id},l=(t,e,o)=>{const{status:r}=e;return(o??s(t,e))&&r===i.AudioPlayerStatus.PLAYING},d=(t,e,o)=>[t?r.getLang("mobile_audio_player_pause"):r.getLang("mobile_audio_player_play"),e,o].filter(Boolean).join(" "),c=t=>t?r.getLang("global_delete_audio"):r.getLang("global_add_to_audio"),u=(t,e,o,i)=>{if(!o.platformAudioPlayer)return;if(t.audio_playlist)return(0,a.audioPlaylistAction)({audio:t.audio_playlist,player:o.platformAudioPlayer,context:o.audioPlayerContext,isPlaying:e});const r=t.audio||t.podcast;return r?(0,n.audioAction)({audio:r,player:o.platformAudioPlayer,context:o.audioPlayerContext,isPlaying:e,queue:i}):void 0}},28616:(t,e,o)=>{o.d(e,{SecondaryAttachmentList:()=>f});var i=o(474848),r=o(296540),a=o(769967),n=o(194528),s=o(728251),l=o(982069),d=o(866467),c=o(268008),u=o(841408),h=o(294567),m=o(289306),_=o(834761),p=o(472786),A=o(868820);const g=t=>(0,d.langNumeric)(t,d.getLang("wall_attachment_secondary_show_more","raw")),f=({postId:t,findOwner:e,attachments:o,onShowMoreClick:d,initialExpanded:f,maxAttachmentsBeforeCut:y,feedV3Redesign:v})=>{const{action:w,secondaryAction:P,noHorizontalPaddingOnSecondary:b}=(0,c.useAttachmentPlatformContext)(),C=(0,r.useMemo)((()=>{const r=w(t);return o.map((t=>{const o=(0,u.mapSecondaryAttachment)(t,(0,i.jsx)(l.Icon12Explicit,{}),(0,m.getSecondaryAttachmentOwners)(t.compact,e)),a=r({attachment:t});return{original:t,secondary:o,after:a?(0,_.mapAfter)(t.compact,P(t)):void 0,action:a}}))}),[o,e,t]),S=(0,r.useMemo)((()=>C.map((t=>t.original.audio)).filter((t=>Boolean(t)))),[C]);return(0,i.jsx)(a.SecondaryAttachmentList,{formatCutText:g,initialExpanded:f,onShowMoreClick:d,maxAttachmentsBeforeCut:y,feedV3Redesign:v,children:C.map((({original:t,secondary:e,action:o,after:r},a)=>(0,p.isAudioAttachment)(t.type)&&!(0,A.isDonutAttachment)(t)?(0,i.jsxs)(i.Fragment,{children:[v&&a>0&&(0,i.jsx)(n.Spacing,{size:4}),(0,i.jsx)(h.SecondaryAttachmentAudio,{originalAttachment:t,attachment:e,action:o,queue:t.audio?S:void 0,feedV3Redesign:v},a)]}):(0,i.jsxs)(i.Fragment,{children:[v&&a>0&&(0,i.jsx)(n.Spacing,{size:4}),(0,i.jsx)(s.SecondaryAttachment,{attachment:e,action:o,after:r,noHorizontalPadding:b,verticalPaddingRedesign:v},a)]})))})}},438859:(t,e,o)=>{o.d(e,{SecondaryAttachmentList:()=>i.SecondaryAttachmentList});var i=o(28616)},289306:(t,e,o)=>{o.d(e,{getSecondaryAttachmentOwners:()=>i});const i=(t,e)=>{const o={};t.icons?.forEach((({source_id:t})=>{t&&(o[t]=e(t))}));return{owner:e(t.title?.source_id),imageOwnerBySourceIdMap:o}}},472786:(t,e,o)=>{o.d(e,{isAudioAttachment:()=>r});var i=o(995500);function r(t){return[i.WallpostAttachmentType.AUDIO,i.WallpostAttachmentType.AUDIO_PLAYLIST,i.WallpostAttachmentType.PODCAST].includes(t)}},868820:(t,e,o)=>{o.d(e,{isDonutAttachment:()=>r});var i=o(995500);function r(t){return t.type===i.WallpostAttachmentType.PODCAST&&(t.podcast?.podcast_info?.is_donut??!1)}},834761:(t,e,o)=>{o.d(e,{mapAfter:()=>i});const i=(t,e)=>t.button?{key:"button",kind:"button",text:t.button?.text?.text?t.button?.text?.text:"",...e}:{key:"chevron",kind:"chevron"}},841408:(t,e,o)=>{o.d(e,{mapSecondaryAttachment:()=>u});var i=o(641495),r=o(523646),a=o(995500),n=o(406610);const s="square",l=(t,e)=>{const o=t.icons;return o?o.map((t=>((t,e)=>{if(t.image_url)return{style:t.style?t.style:s,sizes:[{url:t.image_url,width:0,height:0}]};const o=t.source_id&&e[t.source_id]?e[t.source_id]:null,i=t.sizes?t.sizes:[],r=o?(0,n.getOwnerPhotoSizes)(o):i;let a=null;return r.length&&(a={style:t.style?t.style:s,sizes:r.map((t=>{const e=t.url?t.url:t.src;return{...t,url:e||""}}))}),a})(t,e))).filter((t=>!!t)):[]},d=(t,e)=>{const{owner:o,imageOwnerBySourceIdMap:r}=e,a=((t,e)=>{const o=e?(0,i.getOwnerName)(e,!0,void 0):t.title?.text?.text;return{description:t.description?.text?.text,title:o||"",isVerified:!!e?.verified}})(t,o),n=t.icons?.[0]?.name,s=l(t,r),d=t.overlay_image?.image?.name;return{content:a,icon:n,image:s[0],badge:d}},c=t=>{switch(t){case r.RestrictionIconFileName.CLOCK:return"recent_outline";case r.RestrictionIconFileName.FORBIDDEN:return"block_outline";case r.RestrictionIconFileName.DELETED:case r.RestrictionIconFileName.PRIVATE:return t;default:return"hide_outline"}},u=(t,e,o)=>{const i=t.compact,n=d(i,o);switch(t.type){case a.WallpostAttachmentType.ALBUM:{const e=t.album?.thumb?.restrictions;return e?{...n,icon:e.blur?"hide_outline":"block_outline"}:n}case a.WallpostAttachmentType.ARTICLE:return"available"===t.article?.state?n:{...n,restricted:!0};case a.WallpostAttachmentType.VIDEO:case a.WallpostAttachmentType.CLIP:{const e=t.video?.restriction;return e?{content:{title:e.title},icon:c(e.icon_name),restricted:!0,multiline:!0}:n}case a.WallpostAttachmentType.PHOTO:{const e=t.photo?.restrictions;return e?{content:{title:e.title},icon:e.blur?"hide_outline":"block_outline",restricted:!0,multiline:!0}:n}case a.WallpostAttachmentType.MINI_APP:return t.mini_app&&t.mini_app.app?.app_status!==r.MiniAppStatus.AVAILABLE?{content:{title:t.mini_app.description},icon:"hide_outline",restricted:!0}:n;case a.WallpostAttachmentType.PODCAST:case a.WallpostAttachmentType.AUDIO:{const o=void 0!==t.podcast,i=t.audio?t.audio:t.podcast,r=+(i?.region_restrictions?i?.region_restrictions:0),a=!!(i?.content_restricted?i?.content_restricted:r),s=o&&i?.podcast_info?.is_donut;return{...n,content:{...n.content,titleAfterIcon:i?.is_explicit?e:void 0},restricted:a,isDonut:s}}case a.WallpostAttachmentType.AUDIO_PLAYLIST:{const o=t.audio_playlist,i=!!o?.restriction;return{...n,content:{...n.content,titleAfterIcon:o?.is_explicit?e:void 0},restricted:i}}default:return n}}},839185:(t,e,o)=>{o.d(e,{MEDIA_GRID_FEATURES:()=>d,PRIMARY_ATTACHMENT_FEATURES:()=>c,getMediaGridBackgroundType:()=>l,getPrimaryAttachmentBackgroundType:()=>s});var i=o(540462),r=o(575753),a=o(105330);const n=()=>r.browser.chrome?"svg":r.browser.safari?"backdrop_blur":(0,a.isMvk)()?"blur":"backdrop_blur",s=()=>(0,i.partConfigEnabled)("single_photo_background_blur_enabled")?"blur":(0,i.partConfigEnabled)("single_photo_backdrop_blur_enabled")?n():"gray_fields",l=()=>(0,i.partConfigEnabled)("media_grid_with_gray_fields_enabled")?"gray_fields":(0,i.partConfigEnabled)("media_grid_single_image_blur_enabled")?n():"gray_fields",d={isHeightLimitEnabled:(0,i.partConfigEnabled)("feed_redesign_web_mvk_grid_height_limit_enabled"),isFullWidthEnabled:(0,i.partConfigEnabled)("media_grid_fullscreen_enabled")},c={isHeightLimitEnabled:!1,isFullWidthEnabled:(0,i.partConfigEnabled)("media_grid_fullscreen_enabled")}},523646:(t,e,o)=>{o.d(e,{MiniAppStatus:()=>r,RestrictionIconFileName:()=>i});const i={AGE:"hide_outline",CLOCK:"recent_outline",DELETED:"delete_outline",FORBIDDEN:"do_not_disturb_outline",INFO:"info_outline",PRIVATE:"lock_outline"},r={ADMIN:-1,BANNED:0,AVAILABLE:1,PARTIALLY_AVAILABLE:2}},113086:(t,e,o)=>{o.d(e,{useAttachmentsByGroup:()=>n});var i=o(296540),r=o(995500);const a=[r.WallpostAttachmentType.AUDIO,r.WallpostAttachmentType.LINK,r.WallpostAttachmentType.PHOTO,r.WallpostAttachmentType.VIDEO,r.WallpostAttachmentType.CLIP,r.WallpostAttachmentType.DOC,r.WallpostAttachmentType.ALBUM,r.WallpostAttachmentType.ARTICLE,r.WallpostAttachmentType.POLL,r.WallpostAttachmentType.MINI_APP],n=(t,e)=>(0,i.useMemo)((()=>{const o=[],i=[],r=[];let n;return t?.forEach((t=>{switch(t.style){case"compact":o.push(t);break;case"full":switch(e?.primary_mode){case"single":(t=>a.includes(t.type))(t)&&(n=t);break;case"carousel":r.push(t);break;default:i.push(t)}}})),{secondary:o,primary:n,grid:i,carousel:r}}),[t,e?.primary_mode])},608524:(t,e,o)=>{function i(t){return function(t){return"restrictions"in t&&!!t.restrictions}(t)?t.restrictions:void 0}function r(t){return t.blur?{kind:"blur",is_permanent:!1,blur_restriction:t}:{kind:"geo",is_permanent:!0,geo_restriction:t}}o.d(e,{photoGetRestriction:()=>r,photoGetRestrictionsAny:()=>i})},995500:(t,e,o)=>{o.d(e,{WallpostAttachmentType:()=>i});const i={ALBUM:"album",APP:"app",ARTICLE:"article",ARTIST:"artist",AUDIO:"audio",AUDIO_PLAYLIST:"audio_playlist",CLIP:"clip",CURATOR:"curator",DOC:"doc",DONUT_LINK:"donut_link",EVENT:"event",GEO:"geo",GRAFFITI:"graffiti",GROUP:"group",LINK:"link",MARKET:"market",MARKET_ALBUM:"market_album",MINI_APP:"mini_app",NARRATIVE:"narrative",NOTE:"note",PAGE:"page",PHOTO:"photo",PHOTOS_LIST:"photos_list",PODCAST:"podcast",POLL:"poll",POSTED_PHOTO:"posted_photo",PRETTY_CARDS:"pretty_cards",SITUATIONAL_THEME:"situational_theme",STICKER:"sticker",TEXTLIVE:"textlive",TEXTPOST:"textpost",TEXTPOST_PUBLISH:"textpost_publish",VIDEO:"video",VIDEO_PLAYLIST:"video_playlist"}},811362:(t,e,o)=>{o.d(e,{PrimaryAttachmentAlbum:()=>c});var i=o(474848),r=o(428613),a=o(173928),n=o(866467),s=o(422124),l=o(8520),d=o(540462);const c=({url:t="",album:e,onClick:o})=>{const{title:c,thumb:u,size:h}=e,{hasBlur:m,disclaimer:_,disclaimerType:p}=(0,s.getAlbumRestrictions)(u),A=(0,n.langReplace)(n.getLang("pages_albums_label_long",Number(h)),{size:String(h)}),g=(0,a.getAlbumCover)(u,p);return(0,i.jsx)(r.PrimaryAttachmentAlbum,{onClick:o,url:t,title:(0,l.decodeHTMLEntities)(c),hasBlur:m,hiddenAlbumLabel:"",disclaimer:_,disclaimerType:p,cover:g,albumInfoLabel:A,borderRadius:(0,d.partConfigEnabled)("feed_react_post")?0:void 0})}},852708:(t,e,o)=>{o.d(e,{PrimaryAttachmentArticle:()=>A});var i=o(474848),r=o(460759),a=o(753457),n=o(654813),s=o(8520),l=o(866467),d=o(296540),c=o(957994),u=o(773058),h=o(745007),m=o(115208),_=o(540462),p=o(116534);const A=({article:t,descriptionLinesClamp:e,trackCode:o,onArticleHover:A,onFavoriteToggleSuccess:g,onFavoriteToggleError:f,url:y="",isCompact:v=!1,ownerFullNameGen:w,ratio:P,action:b,restrictions:C})=>{const{title:S="",photo:E,is_favorite:I,id:T,owner_id:k,lead_description:L}=t,[x,R]=(0,d.useState)(I?"added":"idle"),M=E&&E.sizes&&(0,s.getPhotoSize)(E.sizes,1/0)?.url,O=w?(0,l.langReplace)(l.getLang("pages_articles_label_long"),{author:w}):l.getLang("pages_articles_label");if((0,_.partConfigEnabled)("feed_react_post")){const e=C??(0,p.getArticleRestriction)(t.owner_id,t.owner_name,t.state,t.donut,t.url,void 0,!0),o=b??(0,m.getAttachmentAction)(S,y,!0);o&&!o.ariaLabel&&(o.ariaLabel="");const r={mode:"feed",title:S||"",sizes:t.photo?.sizes,caption:t.owner_name?(0,l.langReplace)(l.getLang("pages_articles_label_long"),{author:t.owner_name}):l.getLang("pages_articles_label"),maxImageWidth:u.MAX_IMAGE_WIDTH,maxContainerWidth:u.MAX_IMAGE_WIDTH,restriction:e?.restriction,onMouseEnter:()=>A?.(t),onRestrictedClick:e?.onRestrictionClick,action:o,ratio:P};return(0,i.jsx)(h.SnippetAttachment,{...r})}const W=(0,i.jsx)(r.PrimaryAttachmentArticle,{state:"available",url:y,cover:M,title:S,description:L,descriptionLines:e,onHover:()=>A?.(t),favoriteState:x,onFavoriteToggle:async e=>{e.preventDefault();const i="added"===x;R(i?"removing":"adding");try{i?await(0,c.api)("fave.removeArticle",{article_id:T,owner_id:k,track_code:o}):await(0,c.api)("fave.addArticle",{url:t.url,track_code:o}),R(i?"idle":"added"),g?.(!i)}catch(t){R(i?"added":"idle"),f?.(t)}},favoriteButtonText:"added"===x?l.getLang("fave_delete"):l.getLang("fave_add"),articleInfoLabel:O,deletedArticleLabel:l.getLang("pages_article_snippet_deleted_long"),paidArticleLabel:l.getLang("pages_articles_donut_access_title"),protectedArticleLabel:l.getLang("pages_articles_snippet_protected"),blockedArticleLabel:l.getLang("pages_articles_snippet_banned"),readArticleButtonText:l.getLang("pages_articles_read_article_button")});return v?(0,i.jsx)(a.AdaptivityProvider,{...n.ADAPTIVITY_PROVIDER_COMPACT_PROPS,children:W}):W}},773058:(t,e,o)=>{o.d(e,{MAX_IMAGE_WIDTH:()=>i});const i=550},452046:(t,e,o)=>{function i(){return!!window.vk.id&&0!==window.vk.id}o.d(e,{canAddOrDeleteAudio:()=>i})},17924:(t,e,o)=>{o.d(e,{PrimaryAttachmentLink:()=>h});var i=o(474848),r=o(296540),a=o(993139),n=o(957994),s=o(866467),l=o(83874),d=o(745007),c=o(115208),u=o(540462);const h=({url:t,snippet:{title:e,photo:o,caption:h,is_favorite:m,rating:_,seller_product:p},isPrimarySingle:A,trackCode:g,onFavoriteToggle:f,onFavoriteToggleError:y,ratio:v,action:w})=>{const[P,b]=(0,r.useState)(m?"added":"idle"),C=(0,r.useMemo)((()=>{if(_||p?.owner_name)return{stars:_?.stars,reviewsCountText:_?.reviews_count?s.getLang("communityreview_community_info_review_count",_.reviews_count):s.getLang("communityreview_community_info_no_reviews")}}),[_,p]);if(!e||!o||!h)return null;if((0,u.partConfigEnabled)("feed_react_post")){const r=w??(0,c.getAttachmentAction)(e,t,!0);r&&!r.ariaLabel&&(r.ariaLabel="");const a={mode:"feed",title:e,sizes:o.sizes,caption:h||"",maxImageWidth:l.MAX_IMAGE_WIDTH,maxContainerWidth:l.MAX_IMAGE_WIDTH,action:r,ratio:v};return(0,i.jsx)(d.SnippetAttachment,{...a})}return(0,i.jsx)(a.PrimaryAttachmentLink,{title:e,ownerName:p?.owner_name,photo:o,url:t,caption:h,captionFaviconLink:p?.favicon_link,favoriteState:P,onFavoriteToggle:async e=>{e.preventDefault();const o="added"===P;b(o?"removing":"adding");try{o?await(0,n.api)("fave.removeLink",{link:t,track_code:g}):await(0,n.api)("fave.addLink",{link:t,track_code:g}),b(o?"idle":"added"),f(!o)}catch(t){b(o?"added":"idle"),y?.(t)}},hasSingleAttachment:A,textLinkGo:s.getLang("wall_attachments_link_go"),textTooltip:"added"===P?s.getLang("fave_delete"):s.getLang("fave_add"),rating:C})}},83874:(t,e,o)=>{o.d(e,{MAX_IMAGE_WIDTH:()=>i});const i=550},173928:(t,e,o)=>{o.d(e,{getAlbumCover:()=>r});var i=o(8520);function r(t,e){return!t?.sizes||e&&"sensitive"!==e?void 0:(0,i.getPhotoSize)(t?.sizes,1/0)?.url}},422124:(t,e,o)=>{function i(t){let e,o,i=!1;if(t?.restrictions){const{restrictions:r}=t;i=1===r.blur,e=3===r.disclaimer_type?"sensitive":"blocked",o=r.title}return{hasBlur:i,disclaimer:o,disclaimerType:e}}o.d(e,{getAlbumRestrictions:()=>i})},935205:(t,e,o)=>{o.d(e,{canPageShowGif:()=>r,extractHash:()=>a,getDocFullId:()=>n});var i=o(538522);const r=t=>"gif"===t.ext&&Boolean(t.preview?.video),a=t=>{if(!t.url)return"";try{return new URL(t.url).searchParams.get("hash")??""}catch{}return""},n=t=>(0,i.joinRawId)({ownerId:t.owner_id,itemId:t.id})},32912:(t,e,o)=>{o.d(e,{makeLinkWrappedUrl:()=>n,toRelativeURL:()=>s});var i=o(34231),r=o(22421),a=o(905366);const n=(t="",e,o)=>{const a=encodeURIComponent(encodeURI(decodeURI(t)));return(0,r.makeUrl)((0,i.wrapAway)(a,!0),{track_code:o??"",post:e,el:"snippet"},!1)};function s(t){return(0,a.toMaybeVKSiteURLRelativePath)(t,{allowAnySubdomainAsCurrent:!0})}},388026:(t,e,o)=>{o.d(e,{getPhotoAriaLabel:()=>r});var i=o(866467);const r=(t,e,o)=>{if(e&&o&&1!==o){return[i.getLang("global_wall_photo_group").replace("{number}",String(e)).replace("{count}",String(o)),t].filter(Boolean).join(", ")}return[i.getLang("global_wall_photo"),t].filter(Boolean).join(", ")}},116534:(t,e,o)=>{o.d(e,{getArticleRestriction:()=>s});var i=o(866467),r=o(6898),a=o(468073),n=o(172479);const s=(t,e,o,s,l,d,c)=>{if(!o&&!s)return;const{navigate:u,showDonutSubscribePopup:h}=d??{};let m,_;switch(o){case"banned":m="blocked";break;case"deleted":m="deleted";break;case"paid":case"protected":m="restricted";break;default:m=void 0}if(m){const p={type:m};if("protected"===o){let o;t&&a.Ranges.isGroupId(t)?o={id:t,name:e}:t&&a.Ranges.isUserId(t)&&(o={id:t,first_name:e});const r=t?(0,n.getOwnerUrl)(o)??l:l;r&&(_=()=>{d?.navigate?d?.navigate(r):window.nav.go(r)},p.actionText=i.getLang("public_subscribe"))}if("paid"===o){let e;if(s?.is_donut&&"open_url"===s.placeholder?.button.action?.type&&(e=s.placeholder?.button.action?.url??l,e&&s.placeholder?.button.action?.away_params)){const t=(0,r.toQueryString)(s.placeholder?.button.action?.away_params),o=e.includes("?")?"&":"?";e=`${e}${o}${t}`}h&&t?_=e=>{h?.(e,t)}:u&&e?_=()=>{u(e)}:e&&(_=()=>{window.nav.go(e)}),p.actionText=s?.placeholder?.button.title}return p.text=(t=>{switch(t){case"protected":return i.getLang("pages_articles_snippet_protected");case"banned":return i.getLang("pages_articles_snippet_banned");case"paid":return i.getLang("pages_articles_donut_access_title");case"deleted":return i.getLang("pages_article_snippet_deleted_long");default:return}})(o),"paid"===o&&s?.placeholder?.text&&(p.text=s.placeholder.text),c&&"protected"===o&&(_=void 0,p.actionText=void 0),{restriction:p,onRestrictionClick:_}}}},115208:(t,e,o)=>{o.d(e,{NO_POST_ID:()=>r,THUMB_TYPE_ALBUM:()=>l,THUMB_TYPE_DOC:()=>a,THUMB_TYPE_MARKET_ALBUM:()=>d,THUMB_TYPE_PHOTO:()=>n,THUMB_TYPE_VIDEO:()=>s,addThumbsInData:()=>y,deleteThumbInData:()=>f,getAttachmentAction:()=>v,getThumbByIndex:()=>g,getThumbsMediaItems:()=>_,isDocSecondaryEnabled:()=>u,isOnlyNotPhotoThumbData:()=>p,isPrimaryGifAndOtherDocSecondaryEnabled:()=>c,isValidThumbType:()=>h,moveThumbsInData:()=>A});var i=o(540462);const r="no_post_id",a="doc",n="photo",s="video",l="album",d="market_album",c=()=>(0,i.partConfigEnabled)("web_posting_photo_doc_thumb_secondary"),u=()=>(0,i.partConfigEnabled)("web_posting_doc_thumb_secondary");function h(t){const e=[n,s];return(0,i.partConfigEnabled)("attachments_primary_mode_web_feature")||e.push(l,d),u()||e.push(a),!!~e.indexOf(t.toString())}const m=([t,,e])=>t!==a||u()?h(t):"editable"in e&&function(t){return t.editable&&("gif"!==t.ext&&!c()||"gif"===t.ext&&c())}(e),_=t=>t?.filter(m)??[],p=t=>0===t?.filter((t=>t[0]===n)).length??!1;const A=(t,e,o)=>{const i=_(o),r=o.map((t=>h(t[0])?void 0:t)),a=i[t];return i.splice(t,1),i.splice(e,0,a),r.map((t=>t||i.shift()))},g=(t,e)=>_(e)[t],f=(t,e)=>{const o=g(t,e);return e.filter((t=>t!==o))},y=(t,e)=>{const[o,i]=t,r=e.findIndex((([t,e])=>t===o&&e===i));return r<0?e.push(t):e[r]=t,e},v=(t,e,o)=>{if(e)return{href:e,ariaLabel:t,isExternal:o}}},513109:(t,e,o)=>{o.d(e,{addAudio:()=>i});const i=(0,o(897630).createMethod)("audio.add")},181155:(t,e,o)=>{o.d(e,{deleteAudio:()=>i});const i=(0,o(897630).createMethod)("audio.delete")},897630:(t,e,o)=>{o.d(e,{createMethod:()=>r});var i=o(957994);function r(t){return e=>(0,i.api)(t,e)}},115706:(t,e,o)=>{o.d(e,{apiRadioToAudioTuple:()=>r});var i=o(898848);const r=(t,e)=>[t.id,0,t.stream_url??"",(0,i.clean)(t.name),"",0,0,0,"",0,0,e??"",{radio:!0,externalStream:!0},"",t.logo_url||t.logo_png_url||"",{},"","","",!1,t.track_code||"",0,0,!0,"",!1,""]},245778:(t,e,o)=>{o.d(e,{audioTupleToApiAudio:()=>n});var i=o(898848),r=o(915570),a=o(482310);const n=t=>{if(!t)return null;const[e,o,n,s,l,d,c,,,,,,,u,,h,m,_,p,A,g,f,y,,v,w]=t,{urlHash:P}=(0,r.getAudioHashesFromString)(u),b=(0,a.getAudioExtra)(t);return{access_key:v||P||"",ads:h,artist:(0,i.unclean)(l||""),id:e,owner_id:o,url:n,title:(0,i.unclean)(s),performer:(0,i.unclean)(l),duration:d,album_id:c,subtitle:(0,i.unclean)(m),main_artists:_||void 0,featured_artists:p||void 0,album:A?{owner_id:A[0],id:A[1],access_key:A[2],title:""}:void 0,track_code:g,content_restricted:f,album_part_number:y,audio_chart_info:w||void 0,dislike:b?.dislike??!1}}},915570:(t,e,o)=>{o.d(e,{getAudioHashesFromString:()=>r});var i=o(587952);const r=t=>{if(!t)return{};const[e,o,r,a,n,s,l]=t?.split(i.AUDIO_PLAYER_ADAPTER_HASHES_SEPARATOR);return{addHash:e,editHash:o,actionHash:r,deleteHash:a,replaceHash:n,urlHash:s,restoreHash:l}}},65465:(t,e,o)=>{var i;o.d(e,{AudioPlayerAdapterPlaylistType:()=>i}),function(t){t.CURRENT="current",t.PLAYLIST="playlist",t.MY="my",t.ALBUM="album",t.TEMP="temp",t.RECOM="recoms",t.SEARCH="search",t.FEED="feed",t.LIVE="live",t.WALL="wall",t.RECENT="recent",t.RADIO="radio"}(i||(i={}))},364318:(t,e,o)=>{o.d(e,{AudioPlayerProvider:()=>c});var i=o(474848),r=o(807043),a=o(738313),n=o(296540),s=o(392358),l=o(150585);const d=t=>t?`module:${t}`:"",c=t=>{const{children:e,platformAudioPlayer:o,ownerId:c}=t,[u,h]=(0,n.useState)(a.AudioPlayerStatus.NO),[m,_]=(0,n.useState)(null),[p,A]=(0,n.useState)(null),[g,f]=(0,n.useState)(0),[y,v]=(0,n.useState)(0),[w,P]=(0,n.useState)(d(c)),b=()=>{_(o?.getCurrentAudio()||null),A(o?.getCurrentPlaylist()||null),f(o?.getCurrentAudioProgress()||0),v(o?.getCurrentAudioVolume()||0)},C=()=>{h(a.AudioPlayerStatus.INIT),b()},S=()=>{b()},E=()=>{h(a.AudioPlayerStatus.LOADING),b()},I=()=>{h(a.AudioPlayerStatus.PLAYING),b()},T=()=>{h(a.AudioPlayerStatus.PAUSED),b()},k=()=>{b()},L=(0,l.throttle)((()=>{f(o?.getCurrentAudioProgress()||0)}),1e3),x=()=>{h(a.AudioPlayerStatus.STOPPED),b()},R=()=>{h(a.AudioPlayerStatus.ENDED),b()},M=()=>{o?.unsubscribe(s.events.INIT,C,w),o?.unsubscribe(s.events.VOLUME,S,w),o?.unsubscribe(s.events.PLAY_REQUESTED,E,w),o?.unsubscribe(s.events.PLAY,I,w),o?.unsubscribe(s.events.PAUSE,T,w),o?.unsubscribe(s.events.PLAYLIST_CHANGED,k,w),o?.unsubscribe(s.events.PROGRESS,L,w),o?.unsubscribe(s.events.STOP,x,w),o?.unsubscribe(s.events.ENDED,R,w)};(0,n.useEffect)((()=>{P(d(c))}),[c]),(0,n.useEffect)((()=>(o?.subscribe(s.events.INIT,C,w),o?.subscribe(s.events.VOLUME,S,w),o?.subscribe(s.events.PLAY_REQUESTED,E,w),o?.subscribe(s.events.PLAY,I,w),o?.subscribe(s.events.PAUSE,T,w),o?.subscribe(s.events.PLAYLIST_CHANGED,k,w),o?.subscribe(s.events.PROGRESS,L,w),o?.subscribe(s.events.STOP,x,w),o?.subscribe(s.events.ENDED,R,w),M)),[o,w]),(0,n.useEffect)((()=>{o&&(o.isPlaying()?h(a.AudioPlayerStatus.PLAYING):o.getCurrentAudio()?h(a.AudioPlayerStatus.PAUSED):h(a.AudioPlayerStatus.NO)),b()}),[]);const O={platformAudioPlayer:o,status:u,currentAudio:m,currentPlaylist:p,currentAudioProgress:g,currentAudioVolume:y,audioPlayerContext:w};return(0,i.jsx)(r.AudioPlayerContext.Provider,{value:O,children:e})}},807043:(t,e,o)=>{o.d(e,{AudioPlayerContext:()=>a});var i=o(296540),r=o(738313);const a=(0,i.createContext)({status:r.AudioPlayerStatus.NO,currentAudio:null,currentPlaylist:null,currentAudioProgress:0,currentAudioVolume:0,audioPlayerContext:""})},738313:(t,e,o)=>{var i;o.d(e,{AudioPlayerStatus:()=>i,RADIO_PLAYLIST_ID:()=>r}),function(t){t.NO="no",t.INIT="init",t.LOADING="loading",t.PLAYING="playing",t.PAUSED="paused",t.ENDED="ended",t.STOPPED="stopped"}(i||(i={}));const r=-110},29560:(t,e,o)=>{o.d(e,{useAudioPlayer:()=>a});var i=o(296540),r=o(807043);const a=()=>(0,i.useContext)(r.AudioPlayerContext)},879500:(t,e,o)=>{o.d(e,{convertWebFeedRefToStatsScreen:()=>s,sendCarouselClickEvent:()=>a,sendFeedOpenAudioStats:()=>n});var i=o(666994),r=o(317216);o(774622);function a(t,e,o){if(!e||!o)return;let a=null;1===t?a=r.EventItemType.CLICK_NEXT:-1===t?a=r.EventItemType.CLICK_PREVIOUS:0===t&&(a=r.EventItemType.CLICK_PRETTY_CARD),a&&i.feedInteractionItemStatCollector.logEvent({track_code:e,ref:o,item:r.FeedInteractionItemType.WALL_ITEM},a)}function n(t,e){t&&e&&i.feedInteractionItemStatCollector.logEvent({track_code:t,ref:e,item:r.FeedInteractionItemType.WALL_ITEM},r.EventItemType.OPEN_AUDIO)}function s(t){return["feed_news_top","feed_top"].includes(t)?"feed_top":["feed_news_recent","feed_recent","feed"].includes(t)?"feed_recent":["feed_recommended_top","feed_recommended_recent","feed_recommendations","feed_suggestions","recommended"].includes(t)?"feed_recommended":"other"}},426903:(t,e,o)=>{o.d(e,{ALBUM_ID_DEFAULT_PHOTO:()=>r,ALBUM_ID_PROFILE_PHOTO:()=>i,ALBUM_ID_SAVED_PHOTO:()=>n,PHOTOS_ARCHIVE_ALBUM_ID:()=>l,PHOTOS_MAX_COUNT_SEND_IN_ONE_REQUEST:()=>c,PHOTOS_WITH_ME_ALBUM_ID:()=>d,PHOTO_STREAM_ALBUM_ID:()=>s,WALL_TEMP_ALBUM_ID:()=>a});const i=-6,r=-7,a=-14,n=-15,s=-183,l=-185,d=-9e3,c=100},749366:(t,e,o)=>{o.d(e,{FeedPostAttachmentsAnalytics:()=>n});var i=o(317216),r=o(580403),a=o(666994);class n extends r.PostClickAnalytics{createInteractionEventSender(t){return()=>{const{trackCode:e,ref:o}=this.eventData;e&&a.feedInteractionItemStatCollector.logEvent({track_code:e,ref:o,item:i.FeedInteractionItemType.WALL_ITEM},t)}}constructor(t){super(),this.eventData=t}}},167717:(t,e,o)=>{o.d(e,{FeedStatsAudioPlayerAdapterProxy:()=>r});const i=(0,o(558137).makeSharedState)("feed-audio-player-stats",(()=>({prevAudio:void 0})),{version:0});class r{playAudio(t,e,o,r){const{prevAudio:a}=i(),n=t.id!==a?.id;i().prevAudio=t,this.attachPlayerEventHandler({isAudioChanged:n,attachElement:this.rootElement}),this.audioPlayerAdapter.playAudio(t,e,o,r)}constructor(t,e,o){Object.getOwnPropertyNames(Object.getPrototypeOf(t)).filter((t=>!this[t])).forEach((e=>{const o=t[e];o&&(this[e]="function"==typeof o?o.bind(t):o)})),this.audioPlayerAdapter=t,this.rootElement=e,this.attachPlayerEventHandler=o}}},830828:(t,e,o)=>{o.d(e,{agreeBlurRestriction:()=>r});var i=o(957994);const r=t=>(0,i.api)("photos.agreeBlurRestriction",t)},724415:(t,e,o)=>{o.d(e,{FeedAttachmentProvider:()=>n});var i=o(474848),r=o(223127);const a={PrimaryAttachmentWrapper:o(31005).PrimaryAttachmentWrapper};function n({children:t}){return(0,i.jsx)(r.ModuleAttachmentProvider,{value:a,children:t})}},322650:(t,e,o)=>{o.d(e,{PollModal:()=>s});var i=o(474848),r=o(268008),a=o(742795),n=o(866467);const s=({pollId:t,trackCode:e,isActive:o,onClose:s,className:l,onShare:d,onReport:c})=>{const{ModalComponent:u}=(0,r.useAttachmentPlatformContext)();return u?(0,i.jsx)(u,{isShown:o,id:"main",onClose:s,headerContent:n.getLang("voting_voting"),children:(0,i.jsx)("div",{className:l,children:(0,i.jsx)(a.PrimaryAttachmentPollWrapper,{pollId:t,short:!1,trackCode:e,onShare:d,onReport:c,"data-testid":`poll-modal-${t}`})})}):null}},415998:(t,e,o)=>{o.d(e,{PostAttachments:()=>A});var i=o(474848),r=o(438859),a=o(821968),n=o(754908),s=o(62267),l=o(113086),d=o(849397),c=o(807775),u=o(193262),h=o(520069),m=o(223127),_=o(165794),p=o(940286);const A=(0,o(456921).observer)((({item:t,attachmentsExpanded:e=!1,onRestrictedClick:o,onShowMoreClick:A,findOwner:g,feedV3Redesign:f,showSnackbar:y,children:v,video:w,gif:P})=>{const b=(0,n.getPostRawId)(t),{attachments:C,attachments_meta:S,compact_attachments_before_cut:E}=t,{primary:I,secondary:T,grid:k,carousel:L}=(0,l.useAttachmentsByGroup)(C,S),{PrimaryAttachmentWrapper:x}=(0,m.useModuleAttachmentContext)(),R=(0,p.usePostSharedState)(),M=(0,i.jsxs)(i.Fragment,{children:[I&&(0,i.jsx)(x,{mode:(0,s.isPrimaryPhotoDoc)(I)?"stretch":"none",children:(0,i.jsx)(h.PrimaryAttachment,{postId:b,adData:t?.ad_data,attachment:I,video:w,trackCode:t.track_code,findOwner:g,onRestrictedClick:o,showSnackbar:y,ratio:"photo"===I.type?S?.ratio:void 0,gif:P})}),Boolean(k.length)&&(0,i.jsx)(x,{mode:"stretch",children:(0,i.jsx)(a.MediaGrid,{postId:b,attachments:k,onRestrictedClick:o})}),Boolean(L.length)&&(0,i.jsx)(x,{children:(0,i.jsx)(_.Carousel,{gap:.1,spacing:0,showCounter:!0,showArrows:!0,children:L.map(((e,r)=>(0,i.jsx)(d.Carousel.Item,{className:"attachmentCarousel__slide",children:(0,i.jsx)(h.PrimaryAttachment,{index:r,count:L.length,mode:"carousel",postId:b,adData:t?.ad_data,attachment:e,trackCode:t.track_code,video:w,ratio:S?.carousel_ratio||c.Ratio.SQUARE,findOwner:g,onRestrictedClick:o,showSnackbar:y,onClose:R.setCurrentSlideIndex})},(0,u.extractId)(e))))})})]}),O=(0,i.jsx)(i.Fragment,{children:Boolean(T.length)&&(0,i.jsx)(r.SecondaryAttachmentList,{postId:b,findOwner:g,attachments:T,initialExpanded:e,maxAttachmentsBeforeCut:E,onShowMoreClick:A,feedV3Redesign:f})});return v?.({primary:M,secondary:O})??(0,i.jsxs)(i.Fragment,{children:[M,O]})}))},300122:(t,e,o)=>{o.d(e,{PostAttachments:()=>i.PostAttachments});var i=o(415998)},198966:(t,e,o)=>{o.d(e,{PrimaryAttachment:()=>C});var i=o(474848),r=o(62267),a=o(866467),n=o(17924),s=o(664331),l=o(852708),d=o(296540),c=o(468073),u=o(520069),h=o(811362),m=o(303800),_=o(753457),p=o(807775),A=o(268008),g=o(32912),f=o(993361),y=o(582703),v=o(989047),w=o(935205),P=o(540462),b=o(820826);const C=({index:t,count:e,ratio:o,postId:C,trackCode:S,attachment:E,findOwner:I,onRestrictedClick:T,showSnackbar:k,mode:L="primary",video:x,adData:R,gif:M,onClose:O})=>{const{action:W,onArticleHover:D,restrictions:N}=(0,A.useAttachmentPlatformContext)(),B=W(C,L)({attachment:E}),F=N?.(E),j=(0,d.useMemo)((()=>E.article?.owner_id&&c.Ranges.isUserId(E.article.owner_id)?I(E.article.owner_id):null),[E]);if(E.audio)return(0,i.jsx)(m.Div,{mode:"vertical",spacing:16,children:(0,i.jsx)(m.Div,{mode:"vertical",spacing:4,children:(0,i.jsx)(_.AspectRatio,{ratio:o??p.Ratio.SQUARE,children:(0,i.jsx)(r.PrimaryAttachmentAudio,{audio:E.audio})})})});if(E.link){const t=t=>{t&&k({layout:"horizontal",action:a.getLang("search_goto"),content:a.getLang("fave_link_snippet_added_text"),onActionClick:()=>window.nav.go("/bookmarks?type=link")})},e=(0,i.jsx)(n.PrimaryAttachmentLink,{url:(0,g.makeLinkWrappedUrl)(E.link.url,C,S),trackCode:S,snippet:E.link,isPrimarySingle:"primary"===L,onFavoriteToggle:t,onFavoriteToggleError:t=>k({isError:!0,content:(0,s.getAPIErrorMessage)(t)}),ratio:o,action:B});return(0,P.partConfigEnabled)("feed_react_post")?e:(0,i.jsx)(m.Div,{mode:"vertical",spacing:16,children:(0,i.jsx)(m.Div,{mode:"vertical",spacing:4,children:(0,i.jsx)(_.AspectRatio,{ratio:o??("primary"===L?p.Ratio.WIDE:p.Ratio.SQUARE),children:e})})})}if(E.photo||E.doc)return(0,b.isWallWallpostAttachmentGif)(E)&&(0,w.canPageShowGif)(E.doc)?(0,i.jsx)(y.PrimaryAttachmentGif,{index:t,count:e,ratio:o,postId:C,attachment:E,gifExtras:M}):(0,i.jsx)(r.PrimaryAttachmentPhotoDoc,{index:t,count:e,ratio:o,postId:C,attachment:E,onRestrictedClick:T,onClose:O});if((0,r.isWallWallpostAttachmentVideo)(E))return(0,i.jsx)(r.PrimaryAttachmentVideo,{index:t,count:e,ratio:o,postId:C,attachment:E,mode:L,video:x,adData:R});if((0,f.isWallWallpostAttachmentClip)(E))return(0,i.jsx)(f.PrimaryAttachmentClip,{postId:C,attachment:E});if(E.album)return B?.href?(0,i.jsx)(_.AspectRatio,{ratio:o??p.Ratio.SQUARE,children:(0,i.jsx)(h.PrimaryAttachmentAlbum,{album:E.album,url:B.href,onClick:B?.onClick})}):(console.error("Error: The URL for the album attachment was not specified."),null);if(E.article){const t=()=>{if(j?.first_name_gen&&j.last_name_gen)return`${j.first_name_gen} ${j.last_name_gen}`},e=t=>{t&&k({layout:"horizontal",action:a.getLang("search_goto"),content:a.getLang("fave_article_added_text"),onActionClick:()=>window.nav.go("/bookmarks?type=article")})},r=t=>k({isError:!0,content:(0,s.getAPIErrorMessage)(t)}),n=(0,i.jsx)(l.PrimaryAttachmentArticle,{article:E.article,url:B?.href,isCompact:!0,trackCode:S,descriptionLinesClamp:3,ownerFullNameGen:t(),onFavoriteToggleSuccess:e,onFavoriteToggleError:r,onArticleHover:D,ratio:o,action:B,restrictions:F});return(0,P.partConfigEnabled)("feed_react_post")?n:(0,i.jsx)(m.Div,{mode:"vertical",spacing:16,children:(0,i.jsx)(m.Div,{mode:"vertical",spacing:4,children:n})})}return E.poll?(0,i.jsx)(m.Div,{mode:"vertical",spacing:16,children:(0,i.jsx)(m.Div,{mode:"vertical",spacing:4,children:(0,i.jsx)(u.PrimaryAttachmentPoll,{poll:E.poll,trackCode:S,findOwner:I})})}):(0,v.isWallWallpostAttachmentMiniApp)(E)?(0,i.jsx)(v.PrimaryAttachmentMiniApp,{attachment:E,postId:C}):null}},291497:(t,e,o)=>{o.d(e,{PrimaryAttachmentPoll:()=>u});var i=o(474848),r=o(101066),a=o(266854),n=o(296540),s=o(293721),l=o(268008),d=o(951377),c=o(709097);const u=({poll:t,trackCode:e,findOwner:o})=>{const{share:u,onPollReport:h,onShowPollStats:m,onGetCode:_,onShowFullVoting:p}=(0,l.useAttachmentPlatformContext)(),{[t.id]:A}=(0,s.useStore)(r.$polls),{pollRaw:g,pollRawId:f}=(0,c.getPollRaw)(t);(0,n.useEffect)((()=>{(0,r.setPollFx)(t)}),[t]),(0,n.useEffect)((()=>{(0,a.setProfilesFx)([t.id,(t.friends||[]).map((t=>o(t.id))).filter(Boolean)])}),[t,o]);return A?(0,i.jsx)(d.PrimaryPoll,{pollId:t.id,trackCode:e,onShare:()=>{u({objectId:f,object:g,options:{can_bookmark:!1,can_to_club:!0,can_to_own:!0,object:g,mail_hash:window.cur.mail_hash}})},onReport:()=>{h(t)},onShowStats:()=>{m(t)},onGetCode:()=>{_(t)},onShowFullVoting:p&&(()=>{p&&p(t)})}):null}},520069:(t,e,o)=>{o.d(e,{PrimaryAttachment:()=>i.PrimaryAttachment,PrimaryAttachmentPoll:()=>r.PrimaryAttachmentPoll});var i=o(198966),r=o(291497)},31005:(t,e,o)=>{o.d(e,{PrimaryAttachmentWrapper:()=>c});var i=o(474848),r=o(753457),a=o(303800),n=o(105330),s=o(540462);const l=t=>{const{viewWidth:e}=(0,r.useAdaptivityWithJSMediaQueries)(),o=e<r.ViewWidth.TABLET;return(0,s.partConfigEnabled)("feed_react_post")?0:(0,n.isMvk)()?o&&"stretch"===t?0:8:0},d=()=>{const t=(0,n.isMvk)();return(0,s.partConfigEnabled)("feed_react_post")?t?8:16:t?0:12};function c({children:t,mode:e}){const o=l(e),r=d();return(0,i.jsx)(a.Div,{mode:"vertical",spacing:o,paddingTop:r,paddingBottom:0,children:t})}},942014:(t,e,o)=>{o.d(e,{PrimaryPoll:()=>l});var i=o(474848),r=o(296540),a=o(742795),n=o(322650),s=o(779638);const l=({pollId:t,trackCode:e,onShare:o,onReport:l,onShowStats:d,onGetCode:c,onShowFullVoting:u})=>{const[h,m]=(0,r.useState)(!1);return(0,i.jsx)(a.PrimaryAttachmentPollWrapper,{short:!0,pollId:t,trackCode:e,onShowFullVoting:u||(()=>{m(!0)}),onShare:o,onReport:l,onShowStats:d,onGetCode:c,"data-testid":`poll-main-${t}`,modal:(0,i.jsx)(n.PollModal,{className:s.default.primaryPollModalWrapper,pollId:t,trackCode:e,isActive:h,onClose:()=>{m(!1)},onShare:o,onReport:l})})}},951377:(t,e,o)=>{o.d(e,{PrimaryPoll:()=>i.PrimaryPoll});var i=o(942014)},709097:(t,e,o)=>{o.d(e,{getPollRaw:()=>r});var i=o(538522);const r=t=>{const e=(0,i.joinRawId)({ownerId:t.owner_id,itemId:t.id});return{pollRawId:e,pollRaw:`${t.is_board?"board_poll":"poll"}${e}`}}},796484:(t,e,o)=>{o.d(e,{getPostSharedState:()=>r});var i=o(160649);const r=t=>t&&window.cur?.postSharedState?.[t]?window.cur.postSharedState[t]:new i.PostSharedState},985136:(t,e,o)=>{o.d(e,{initPostAttachmentBlock:()=>l});var i=o(260152),r=o(8520),a=o(338329),n=o(513776),s=o(796484);function l(t,e){(0,a.tq)().setStartupHandler("PostAttachmentsBlock/init",(({payload:o})=>{if(!o.target)throw new Error("PostAttachmentsBlock: Missing target");if(!o.target.isConnected)return;const{item:a,profiles:l,groups:d,attachmentsExpanded:c,feedV3Redesign:u}=(0,r.decodeHTMLEntitiesDeep)(o.data);(0,n.setPostSharedState)(a.id);const h=o.target,m=(0,i.createReactInitiator)(t,h,{destroyAfterNavigation:!1}),_=()=>{m.isMounted()||m.render({item:a,currentUserId:window.vk.id,profiles:l,groups:d,attachmentsExpanded:c,feedV3Redesign:u,root:h,getPostSharedState:s.getPostSharedState})};_(),e?.(m,_)}))}},513776:(t,e,o)=>{o.d(e,{setPostSharedState:()=>r});var i=o(160649);function r(t){t&&window.cur&&!window.cur.postSharedState?.[t]&&(window.cur.postSharedState||(window.cur.postSharedState={}),window.cur.postSharedState[t]=new i.PostSharedState)}},973229:(t,e,o)=>{o.d(e,{useFeedAudioPlayer:()=>n});var i=o(167717),r=o(296540),a=o(540462);function n({getAudioPlayerAdapter:t,rootElement:e,attachPlayerEventHandler:o,loadAudioPlayer:n}){const s=()=>{const r=t();return r&&e&&(0,a.partConfigEnabled)("feed_open_audio_stats_for_react")?new i.FeedStatsAudioPlayerAdapterProxy(r,e,o):r},[l,d]=(0,r.useState)(s);return(0,r.useEffect)((()=>{l||n((()=>d(s)))}),[]),l}},902876:(t,e,o)=>{o.d(e,{useGroups:()=>r});var i=o(296540);const r=t=>(0,i.useMemo)((()=>new Map(t?.map((t=>[t.id,t])))),[t])},940286:(t,e,o)=>{o.d(e,{PostSharedStateProvider:()=>n,usePostSharedState:()=>s});var i=o(474848),r=o(296540);const a=(0,r.createContext)(void 0),n=({children:t,value:e})=>(0,i.jsxs)(a.Provider,{value:e,children:[" ",t," "]});function s(){const t=(0,r.useContext)(a);if(!t)throw new Error("Trying to use usePostSharedState outside of PostSharedStateProvider!");return t}},373318:(t,e,o)=>{o.d(e,{useProfiles:()=>r});var i=o(296540);const r=t=>(0,i.useMemo)((()=>new Map(t?.map((t=>[t.id,t])))),[t])},754908:(t,e,o)=>{o.d(e,{getPostRawId:()=>i.getPostRawId,initPostAttachmentBlock:()=>r.initPostAttachmentBlock});var i=o(875389),r=o(985136)},670668:(t,e,o)=>{o.d(e,{getFindOwner:()=>r});var i=o(468073);const r=({groups:t,profiles:e})=>o=>{if(o)return i.Ranges.isGroupId(o)?t.get(i.Ranges.convertGroupIdToOwnerId(o)):e.get(o)}},875389:(t,e,o)=>{o.d(e,{getPostRawId:()=>r});var i=o(538522);const r=({id:t,item_id:e,owner_id:o})=>{const r=t||e;return o&&r?(0,i.joinRawId)({ownerId:o,itemId:r}):""}},774622:(t,e,o)=>{o.d(e,{feedOpenCommentsModalCollector:()=>a});var i=o(317216),r=o(314309);const a=new class{logEvent(t,e,o){const r={...this.productionStatCollector.getBaseEvent(o),type:i.ClickProductionStatEventTypes.TYPE_FEED_OPEN_COMMENTS_MODAL,[i.ActionProductionStatEventTypes.TYPE_FEED_OPEN_COMMENTS_MODAL]:t};this.clickStatCollector.logEvent(r,e)}constructor(){this.productionStatCollector=new r.ProductionStatCollector,this.clickStatCollector=new r.ClickStatCollector(this.productionStatCollector)}}},664331:(t,e,o)=>{o.d(e,{getAPIErrorMessage:()=>r,isRequestAbortError:()=>a});var i=o(866467);const r=t=>t.error_text||t.error_msg||i.getLang("global_unknown_error"),a=t=>t instanceof DOMException&&(20===t.code||"AbortError"===t.name)},317835:(t,e,o)=>{o.d(e,{formatFileSize:()=>d});var i=o(866467),r=o(8520);const a=1024,n=Math.pow(a,2),s=Math.pow(a,3),l=Math.pow(a,4);function d(t){let e=0,o="";return t>l?(e=Math.round(t/l*1e3)/1e3,o=i.getLang("global_tb")):t>s?(e=Math.round(t/s*100)/100,o=i.getLang("global_gb")):t>n?(e=Math.round(t/n*10)/10,o=i.getLang("global_mb")):(e=Math.round(t/a),o=i.getLang("global_kb")),`${(0,r.formatNumber)(e)} ${o}`}},277136:(t,e,o)=>{o.d(e,{formatMarketAlbumSize:()=>a});var i=o(866467),r=o(10764);const a=t=>t.type===r.MarketMarketAlbumTypeEnumNames.MARKET_SERVICES||-2===t.id||-3===t.id?(0,i.langNumeric)(t.count,i.getLang("profile_X_market_services_items","raw")):(0,i.langNumeric)(t.count,i.getLang("profile_X_market_items","raw"))},661925:(t,e,o)=>{o.d(e,{formatVideoDuration:()=>a});var i=o(866467),r=o(8520);const a=(t,e)=>{switch(e){case"upcoming":return i.getLang("global_video_soon");case"started":case"waiting":return i.getLang("global_video_online");default:return(0,r.formatDuration)(t)}}},6267:(t,e,o)=>{o.d(e,{getAlbumRealId:()=>s,getAlbumUrl:()=>l,getAlbumsZeroIds:()=>n});var i=o(426903);const r={"-6":"0","-7":"00","-15":"000","-23":"0000","-62":"00000","-10":"000000","-7000":"0000000","-165":"00000000","-183":"000000000","-185":"0000000000"},a=Object.fromEntries(Object.entries(r).map((t=>t.reverse()))),n=()=>Object.keys(r).map(Number),s=t=>Number(a[t]||t),l=t=>{return t.id===i.PHOTOS_WITH_ME_ALBUM_ID?`/tag${t.owner_id}`:t.id===i.PHOTO_STREAM_ALBUM_ID?`/photos${t.owner_id}`:t.id===i.PHOTOS_ARCHIVE_ALBUM_ID?"/photos_archive":`/album${t.owner_id}_${e=t.id,r[e]||String(e)}`;var e}},406610:(t,e,o)=>{o.d(e,{getOwnerPhotoSizes:()=>i});const i=t=>[{url:t.photo_400,size:400},{url:t.photo_200,size:200},{url:t.photo_100,size:100},{url:t.photo_50,size:50}].filter((t=>!!t.url)).map((({size:t,url:e})=>({url:e,width:t,height:t})))},749740:(t,e,o)=>{o.d(e,{initCarousel:()=>y,openPhoto:()=>v,pauseVideos:()=>p});var i=o(342018),r=o(446396),a=o(32489),n=o(447208),s=o(26023),l=o(298077),d=o(335700),c=o(540462),u=o(575753),h=o(153663),m=o(92187);function _(t,e,o){return e.contains(t)&&!o.contains(t)}function p(t,e){if(!e||!t)return;const o=window.cur.videoInlinePlayer;o&&_(o.el,e,t)&&(o.pause(),o.ads.pause());const i=window.VideoYoutube?.cur?.player,r=i?.getIframe?.();i&&r&&_(r,e,t)&&i.pauseVideo()}function A(t){t.target===t.currentTarget&&"transform"===t.propertyName&&g()}function g(){window.dispatchEvent(new CustomEvent("scroll"))}function f(t,e){const{slidesCount:o,maxBulletsToDisplay:n,activeBulletIndex:l}=t,_=(0,a.fork)(r.domain,{values:[[r.$carousel,{slidesCount:o,maxBulletsToDisplay:n,activeBulletIndex:l}]],handlers:[[r.updateCarouselBulletsFx,t=>function(t,e){e.querySelector(".PrimaryAttachmentCarousel__bullet--active")?.classList.remove("PrimaryAttachmentCarousel__bullet--active"),e.querySelector(".PrimaryAttachmentCarousel__bulletCircle--big")?.classList.remove("PrimaryAttachmentCarousel__bulletCircle--big");const o=e.querySelectorAll(".PrimaryAttachmentCarousel__bullet")[t.activeBulletIndex];o?.classList.add("PrimaryAttachmentCarousel__bullet--active"),o.querySelector(".PrimaryAttachmentCarousel__bulletCircle")?.classList.add("PrimaryAttachmentCarousel__bulletCircle--big"),t.slidesCount>t.maxBulletsToDisplay&&(e.querySelector(".PrimaryAttachmentCarousel__bulletsInner").style.left=`${t.bulletsContainerOffsetX}px`);e.querySelectorAll(".PrimaryAttachmentCarousel__bulletCircle--small").forEach((t=>t.classList.remove("PrimaryAttachmentCarousel__bulletCircle--small"))),t.smallBulletsIndexes.forEach((t=>{const o=e.querySelectorAll(".PrimaryAttachmentCarousel__bullet")[t];o?.querySelector(".PrimaryAttachmentCarousel__bulletCircle")?.classList.add("PrimaryAttachmentCarousel__bulletCircle--small")}))}(t,e)]]}),f=!u.browser.safari&&(0,c.partConfigEnabled)("feed_primary_attachments_carousel_css_transitions"),y={scrollX:!1,scrollY:!1,onViewItem:(t,e)=>{(0,a.allSettled)(r.updateShownSlideIndex,{scope:_,params:e});const o=t.closest(`.${d.UI_GALLERY_CLASSNAME}`);p(t,o)},isFullSizeSlide:!f,isModernTransitionsEnabled:f,onSlide:(v="primary",w=(0,h.getTrackCodeFromPost)(e)??void 0,P=(0,h.resolveRef)(window.cur.module,window.cur.section,window.cur.subsection),(t,e)=>{"primary"===v&&"arrow"===e?.eventName&&(0,m.sendCarouselClickEventWeb)(t,w??void 0,P)})};var v,w,P;const b=new d.UIGallery(e,y),C=e.querySelector(`.${d.UI_GALLERY_CONTENT_CLASSNAME}`),S=e.querySelector(`.${d.UI_GALLERY_INNER_CLASSNAME}`);f?S?.addEventListener("transitionend",A):C?.addEventListener("scroll",g),(0,s.default)(e,".PrimaryAttachmentCarousel__bullet","click",(t=>{let e=t.delegateTarget.dataset.bulletIndex;e&&(0,a.allSettled)(r.scrollToSlide,{scope:_,params:{index:parseInt(e,10),carousel:b}})})),(0,i.pushNavDestroy)((()=>{f?S?.removeEventListener("transitionend",A):C?.removeEventListener("scroll",g),b.destroy()}))}function y(t){const{data:e,target:o}=t.payload;if(o)if(0===o.clientWidth||0===o.clientHeight){const t=(0,n.runOnceInViewport)(o,(()=>{f(e,o),t()}))}else f(e,o);else(0,l.logError)(new Error("PrimaryAttachmentCarousel >> no target for UIGallery"))}const v=(t,e,o,i,r)=>{const a=i?.closest("[data-blurred-item]");if(a&&(o.preventPhotoShowingInLayer=!0),window.cur&&i){const t=(0,h.getTrackCodeFromPost)(i);window.cur.wallPostTrackCode=t,window.cur.listId=e}window.showPhoto(t,e,{...o,onHide:()=>{i&&i instanceof HTMLElement&&i.focus()}},r)}},446396:(t,e,o)=>{o.d(e,{$carousel:()=>a,domain:()=>r,scrollToSlide:()=>l,updateCarouselBulletsFx:()=>d,updateShownSlideIndex:()=>n});var i=o(32489);const r=(0,i.createDomain)("PrimaryAttachmentCarousel"),a=r.createStore({shownSlideIndex:0,slidesCount:0,activeBulletIndex:0,bulletsContainerOffsetX:0,smallBulletsIndexes:[],maxBulletsToDisplay:5},{sid:"carouselStore"}),n=r.createEvent(),s=r.createEvent(),l=r.createEvent({sid:"scrollToSlide"}),d=r.createEffect({sid:"updateCarouselBulletsFx"}),c=r.createEffect((({carouselState:t,params:e})=>{const o=t.shownSlideIndex,i=e.index;if(i>=0&&i<=t.slidesCount-1){const t=i-o;0!==t&&e.carousel.scrollToDirection(t)}}));a.on(s,((t,e)=>({...t,slidesCount:e}))),a.on(n,((t,e)=>{let o=e,i=0,r=[];if(t.slidesCount>t.maxBulletsToDisplay){const o=t.slidesCount-1;r=[4],i=t.bulletsContainerOffsetX,e>2&&o-e>2?(i=14*(e-2)*-1,r=[e-2,e+2]):o-e<=2?(r=[o-4],i=14*(t.slidesCount-t.maxBulletsToDisplay)*-1):i=0}return{...t,shownSlideIndex:e,activeBulletIndex:o,bulletsContainerOffsetX:i,smallBulletsIndexes:r}})),(0,i.sample)({clock:l,source:a,fn:(t,e)=>({carouselState:t,params:e}),target:c}),(0,i.sample)({clock:a.updates,source:a,target:d})},365148:(t,e,o)=>{o.d(e,{WebAttachmentProvider:()=>f});var i=o(474848),r=o(268008),a=o(725567),n=o(730296),s=o(153385),l=o(975682),d=o(528593),c=o(264074),u=o(680560),h=o(749740),m=o(892848),_=o(624038),p=o(349835);const A={add:(...t)=>{window.Page?.addGif(...t)},show:(...t)=>{window.Page?.showGif(...t)},share:(...t)=>{window.Page?.shareGif(...t)}},g=t=>({action:(0,a.getAttachmentAction)(t?.postClickAnalytics?.onPhotoOpen),musicShowProgress:!0,secondaryAction:()=>({}),destroyInlineVideoPlayer:t=>{t&&(0,m.revertLastInlineVideo)(t)},onCarouselSlideChange:(t,e)=>{(0,h.pauseVideos)(e,t),setTimeout((()=>{window.dispatchEvent(new CustomEvent("scroll"))}),250)},onRestrictedPhoto:l.restrictedPhotoAction,onRestrictedAudio:u.audioRestrictionAction,maxImageWidth:510,noHorizontalPaddingOnSecondary:!0,maxContainerWidth:510,textConfig:{cutThreshold:3,underCutThreshold:2,fullPostThreshold:20},textConfigCompact:{cutThreshold:2,underCutThreshold:0,fullPostThreshold:0},ModalComponent:s.ModalComponent,share:({object:t,options:e})=>{((...t)=>{window.stManager.add([window.jsc("web/likes.js")],(()=>window.Likes.share(...t)))})(t,e)},onArticleHover:n.articleHoverAction,onPollReport:d.pollReportAction,onGetCode:d.getPollCode,onClipClick:c.clipShowAction,onShowPollStats:d.pollShowStatsAction,onCarouselNextClick:t?.postClickAnalytics?.onCarouselNextClick,onCarouselPrevClick:t?.postClickAnalytics?.onCarouselPrevClick,subscribeOnCarouselModalClose:p.handleWkViewCloseEvent,restrictions:(0,_.getAttachmentRestrictions)(t?.legacyActions),gifActions:A}),f=({children:t,options:e})=>(0,i.jsx)(r.AttachmentPlatformProvider,{value:g(e),children:t})},581861:(t,e,o)=>{o.d(e,{albumAction:()=>a});var i=o(6267),r=o(363046);const a=t=>{const e=(0,i.getAlbumUrl)(t);return{href:e,onClick:t=>{(0,r.cancelEvent)(t),window.nav.change({z:e.replace("/","")})}}}},730296:(t,e,o)=>{o.d(e,{articleAction:()=>a,articleHoverAction:()=>n});var i=o(32912),r=o(416362);const a=t=>{if(t.state&&"available"!==t.state||!t.view_url)return;return{href:(0,i.toRelativeURL)(t.view_url),ariaLabel:t.title||""}},n=t=>{t.url&&(0,r.articlePrepare)((0,i.toRelativeURL)(t.url),{})}},865679:(t,e,o)=>{o.d(e,{artistAction:()=>i});const i=t=>{if(t.domain||t.id)return{href:`/artist/${t.domain||t.id}`}}},680560:(t,e,o)=>{o.d(e,{audioRestrictionAction:()=>r});var i=o(909436);const r=t=>{const e=t.content_restricted||Number(t.region_restrictions);e&&i.AudioUtils.showAudioRestriction({...t,restrictionStatus:e,actionHash:t.access_key})}},264074:(t,e,o)=>{o.d(e,{clipShowAction:()=>a});var i=o(808315),r=o(432081);const a=(t,e)=>{(0,r.showVideo)(e,"",{autoplay:1,shortVideo:1,queue:1,addParams:{t:(0,i.timecodeToString)(t)}})}},836148:(t,e,o)=>{o.d(e,{curatorAction:()=>i});const i=t=>({href:t.url??`/music/curator/${t.id}`})},266077:(t,e,o)=>{o.d(e,{documentAction:()=>n});var i=o(538522),r=o(22421),a=o(935205);const n=({doc:t})=>{const e=(0,a.extractHash)(t),o=(0,i.joinRawId)({ownerId:t.owner_id,itemId:t.id});return{href:(0,r.makeUrl)(`/doc${o}`,{hash:e}),isExternal:!0}}},341920:(t,e,o)=>{o.d(e,{gifAction:()=>a});var i=o(22421),r=o(935205);const a=t=>{const e=(0,r.extractHash)(t),o=(0,r.getDocFullId)(t);return{href:(0,i.makeUrl)(`/doc${o}`,{hash:e}),isExternal:!0}}},906768:(t,e,o)=>{o.d(e,{marketAction:()=>a});var i=o(538522),r=o(363046);const a=t=>{const e=t.market_url??`/product${(0,i.joinRawId)({ownerId:t.owner_id,itemId:t.id})}`;return{href:e,onClick:t=>{(0,r.cancelEvent)(t),window.nav.go(e)}}}},228648:(t,e,o)=>{o.d(e,{marketAlbumAction:()=>a});var i,r=o(32912);!function(t){t[t.market=0]="market",t[t.uslugi=1]="uslugi"}(i||(i={}));const a=t=>{const e=`/${i[t.type??0]}${t.owner_id}?section=album_${t.id}`;return{href:(0,r.toRelativeURL)(e)}}},981995:(t,e,o)=>{o.d(e,{miniAppAction:()=>i});const i=t=>({href:t.app?.share_url??`/app${t.app?.id}`,isExternal:!0})},975682:(t,e,o)=>{o.d(e,{photoAction:()=>u,restrictedPhotoAction:()=>h});var i=o(538522),r=o(363046),a=o(153663),n=o(866467),s=o(734171),l=o(458840),d=o(270959),c=o(388026);const u=({postId:t,photo:e,index:o,count:n,onPhotoOpen:d,onPhotoClose:u})=>{const h=(0,c.getPhotoAriaLabel)(e.text,(o??0)+1,n),m=(0,i.joinRawId)({ownerId:e.owner_id,itemId:e.id});let _="";return _=void 0!==o&&n&&1!==n?t?`wall${t}`:e.web_view_token??"":e.web_view_token??(t?`wall${t}`:""),{ariaLabel:h,href:`/photo${m}`,onClick:t=>{(0,r.cancelEvent)(t),d?.();const o=(0,s.alQuickPhotoOptions)({photo:e})||{};window.cur&&t.target&&(window.cur.wallPostTrackCode=(0,a.getTrackCodeFromPost)(t.target),window.cur.listId=_);const i=t.currentTarget,n=(0,a.getNearestPost)(i);(0,l.showPhoto)(m,_,{...o,onHide:t=>{u?.(t),n&&n instanceof HTMLElement&&n.focus()},queue:1})}}},h=t=>{const e=t.restrictions;if(!e)return Promise.resolve(t);const{title:o,text:i}=e;return new Promise((e=>{let r=(0,d.showFastBox)({title:o},i,n.getLang("photos_restriction_button_watch"),(function(){r.hide(),e(t)}),n.getLang("global_cancel"))}))}},449594:(t,e,o)=>{o.d(e,{playlistAction:()=>a});var i=o(909436),r=o(896412);const a=t=>({onClick:e=>{(0,r.cancelEvent)(e),i.AudioUtils.showAudioPlaylist(t.owner_id,t.id,t.access_key,"feed",e)}})},53592:(t,e,o)=>{o.d(e,{podcastAction:()=>n,podcastDonutAction:()=>s});var i=o(458840),r=o(538522),a=o(896412);const n=t=>({onClick:e=>{(0,a.cancelEvent)(e),(0,i.showPodcast)(null,(0,r.joinRawId)({itemId:t.id,ownerId:t.owner_id}),e)}}),s=t=>{const e=t?.podcast_info?.restriction_button;if(e&&"open_url"===e.action?.type)return{href:e.action?.url,ariaLabel:e.title,isExternal:"internal"!==e.action?.target}}},528593:(t,e,o)=>{o.d(e,{getPollCode:()=>l,getPollModalModule:()=>d,pollReportAction:()=>s,pollShowStatsAction:()=>n});var i=o(185977),r=o(458840),a=o(164043);const n=t=>{(0,r.showWiki)({w:(0,i.getPollRawObject)(t)})},s=t=>{(0,a.showReportVotingForm)(null,{id:t.id,isBoard:t.is_board})},l=t=>{window.Wall?.votingExport(null,{id:t.id,isBoard:t.is_board})};function d(){return Promise.all([o.e(91498),o.e(89631),o.e(42135),o.e(36539)]).then(o.bind(o,802592))}},928613:(t,e,o)=>{o.d(e,{clipAction:()=>d,inlineVideoAction:()=>l,videoAction:()=>s});var i=o(363046),r=o(538522),a=o(841315),n=o(432081);const s=({postId:t,video:e,restriction:o})=>({href:(0,a.getVideoUrl)(e),ariaLabel:e.title,onClick:a=>{if((0,i.cancelEvent)(a),!e.owner_id||!e.id)return;const s=(0,r.joinRawId)({ownerId:e.owner_id,itemId:e.id});let l=e.access_key;!l&&e.album_id&&(l=(0,r.joinRawId)({ownerId:e.owner_id,itemId:e.album_id}));const d="short_video"===e.type,c={queue:!0,addParams:{post_id:t},hasRestriction:"restricted"===o?.type,autoplay:1,shortVideo:d?1:0};s&&(l||d)&&(0,n.showVideo)(s,l??"",c)}}),l=({postId:t,video:e,restriction:o})=>{let s=e.access_key,l=null;e.owner_id&&e.id&&(l=(0,r.joinRawId)({ownerId:e.owner_id,itemId:e.id}),!s&&e.album_id&&(s=(0,r.joinRawId)({ownerId:e.owner_id,itemId:e.album_id})));const d="short_video"===e.type;return{href:(0,a.getVideoUrl)(e),ariaLabel:e.title,onClick:r=>{(0,i.cancelEvent)(r),l&&(s||d)&&(0,n.showInlineVideo)(l,s,{autoplay:1,hasRestriction:"restricted"===o?.type,shortVideo:d,module:window.cur&&window.cur.module||"other",addParams:{post_id:t,promo_post_hash:e?.promo_post_hash}},r,r.currentTarget)}}},d=({clip:t})=>({onClick:()=>{if(!t.owner_id||!t.id)return;const e=(0,r.joinRawId)({ownerId:t.owner_id,itemId:t.id});(0,n.showVideo)(e,"",{autoplay:1,shortVideo:1,queue:1})}})},725567:(t,e,o)=>{o.d(e,{getAttachmentAction:()=>b});var i=o(266077),r=o(928613),a=o(581861),n=o(730296),s=o(995500),l=o(975682),d=o(193262),c=o(228648),u=o(53592),h=o(449594),m=o(836148),_=o(865679),p=o(540462),A=o(341920),g=o(906768),f=o(528593),y=o(363046),v=o(935205),w=o(981995),P=o(396445);const b=t=>(e,o="grid")=>({attachment:b,index:C,count:S,onClose:E})=>{const I=(0,d.extractRestriction)(b);switch(b.type){case s.WallpostAttachmentType.ALBUM:return(0,a.albumAction)(b.album);case s.WallpostAttachmentType.ARTICLE:return(0,n.articleAction)(b.article);case s.WallpostAttachmentType.DOC:return(0,v.canPageShowGif)(b.doc)?(0,A.gifAction)(b.doc):(0,i.documentAction)({postId:e,doc:b.doc});case s.WallpostAttachmentType.PHOTO:return(0,l.photoAction)({postId:e,photo:b.photo,index:C,count:S,onPhotoOpen:t,onPhotoClose:E});case s.WallpostAttachmentType.VIDEO:return(0,p.partConfigEnabled)("feed_video_primary_attachment_web_enable")?"grid"===o?(0,r.videoAction)({postId:e,restriction:I,video:b.video}):(0,r.inlineVideoAction)({postId:e,restriction:I,video:b.video}):void 0;case s.WallpostAttachmentType.CLIP:return b.type===s.WallpostAttachmentType.CLIP&&(0,p.partConfigEnabled)("feed_clip_primary_attachment_web_enable")?(0,r.clipAction)({clip:b.clip}):(0,r.videoAction)({postId:e,restriction:I,video:b.video});case s.WallpostAttachmentType.MARKET:return(0,g.marketAction)(b.market);case s.WallpostAttachmentType.MARKET_ALBUM:return(0,c.marketAlbumAction)(b.market_album);case s.WallpostAttachmentType.PODCAST:{const t=b.podcast?.podcast_info?.is_donut,e=b.podcast?.podcast_info?.restriction_button?.action;return t&&e?(0,u.podcastDonutAction)(b.podcast):(0,u.podcastAction)(b.podcast)}case s.WallpostAttachmentType.AUDIO_PLAYLIST:return(0,h.playlistAction)(b.audio_playlist);case s.WallpostAttachmentType.CURATOR:return(0,m.curatorAction)(b.curator);case s.WallpostAttachmentType.ARTIST:return(0,_.artistAction)(b.artist);case s.WallpostAttachmentType.POLL:return{onClick:t=>{(0,y.cancelEvent)(t),(0,f.getPollModalModule)().then((({showPollModal:t})=>{t(b.poll)}))}};case s.WallpostAttachmentType.MINI_APP:return(0,w.miniAppAction)(b.mini_app);case s.WallpostAttachmentType.DONUT_LINK:return{onClick:t=>{(0,y.cancelEvent)(t),(0,P.showDonutSubscribePopup)(t,b.donut_link?.owner_id,window.nav?.objLoc?.source,{type:"subscribe",params:{act:"subscribe_popup"}})}}}}},624038:(t,e,o)=>{o.d(e,{getAttachmentRestrictions:()=>a});var i=o(995500),r=o(116534);const a=t=>e=>{if(e.type===i.WallpostAttachmentType.ARTICLE)return(0,r.getArticleRestriction)(e.article.owner_id,e.article.owner_name,e.article.state,e.article.donut,e.article.url,t,!0)}},153385:(t,e,o)=>{o.d(e,{ModalComponent:()=>d});var i=o(474848),r=o(211413),a=o(694244),n=o(782174),s=o(63614),l=o(866467);function d({children:t,isShown:e,headerContent:o,onClose:d}){return e?(0,i.jsx)(r.MessageBoxModal,{onDestroy:d,children:({onClose:e})=>(0,i.jsxs)(a.ModalBox,{children:[(0,i.jsx)(n.ModalHeader,{onClose:e,closeAriaLabel:l.getLang("global_close"),before:o}),(0,i.jsx)(s.ModalBody,{insetLevel:0,children:t})]})}):null}},275995:(t,e,o)=>{o.d(e,{recognizeBlockState:()=>i});const i=(0,o(558137).makeSharedState)("photo_recognize_block",(()=>({block:null})),{version:0})},907589:(t,e,o)=>{o.d(e,{FEED_RECOGNIZE_PHOTO_DEFAULT_BLOCK_TYPE:()=>u,FEED_RECOGNIZE_PHOTO_POST_ID:()=>c,NUMBER_INITIALIZED_PHOTO:()=>h,PHOTO_CAROUSEL_AVATAR_CLASS:()=>l,PHOTO_CAROUSEL_CLASS:()=>i,PHOTO_CAROUSEL_HIDE_BTN_CLASS:()=>d,PHOTO_CAROUSEL_ITEM_CLASS:()=>r,PHOTO_CAROUSEL_ITEM_NO_SIZE_CLASS:()=>a,PHOTO_ELEMENT_CLASS:()=>n,PHOTO_NO_SIZE_ELEMENT_CLASS:()=>s});const i="PhotoCarousel",r="PhotoCarouselItem",a="PhotoCarouselItem--noSize",n="PhotoCarouselImage",s="PhotoCarouselItem__stub",l="PhotoCarouselBlockItem__avatar",d="PhotoCarousel__hidePost",c="tags_suggestions",u="tags_suggestions",h=4},92187:(t,e,o)=>{o.d(e,{attachPlayerEventHandler:()=>v,checkIfLinkIsValid:()=>P,feedShowMoreButtonLoadedCount:()=>b,getCommentsSortEvent:()=>I,handleViewingFeedBlocks:()=>S,handleViewingPosts:()=>C,isFeedPostDurationStatsFixEnabled:()=>y,isFeedRepliesStatsEnabled:()=>T,sendCaptionLinkClickEvent:()=>E,sendCarouselClickEventWeb:()=>w});var i=o(540462),r=o(153663),a=o(879500),n=o(821680),s=o(15614),l=o(816984),d=o(898848),c=o(335700),u=o(169530),h=o(907589),m=o(275995),_=o(683234),p=o(636576),A=o(626209),g=o(317216),f=o(666994);function y(){return(0,i.partConfigEnabled)("feed_posts_duration_stats_fix")}function v({isAudioChanged:t,attachElement:e}){if(!t||!e)return;const o=(0,r.getTrackCodeFromPost)(e),i=(0,r.resolveRefFromCur)();(0,a.sendFeedOpenAudioStats)(o,i)}function w(t,e,o){(0,a.sendCarouselClickEvent)(t,e,o)}function P(t){return"Post/ownerLinkClick"!==t?.getAttribute("data-task-click")&&!t?.closest(".PostActivityCaption, .PostActivityBar")&&!t?.closest(".ui_actions_menu_item")}const b=(t,e,o)=>{let i=document.getElementById("show_more_link"),r=i?.offsetTop??0;i&&!i.seen&&r>=e&&r<e+o&&(i.seen=Date.now(),(0,p.statlogsValueEvent)("feed_load_more_seen",(0,_.isButtonLocked)(i),t))},C=({posts:t=[],postRaws:e,el:o})=>o?((0,A.isAdWithLongImpressionOnly)(o)||(0,A.isAutoplayAd)(o)?window.Wall.triggerAdStat(o.firstElementChild,"impression"):e&&t?.push(e),t??[]):t??[],S=({el:t,index:e,ref:o,onView:i})=>{if(t)if(t.querySelector(".VideosForYouGallery"))window.FeedVideosForYou?.viewBlock(),i?.();else if(t.querySelector(".FeedVideoPostcard"))window.FeedVideoPostcard?.viewBlock(),i?.();else if(t.querySelector(".UxpollsBlock")){const e=t.querySelector(".UxpollsBlock")?.dataset.trackCode;e&&((0,n.viewUXPollsBlock)(e),i?.())}else if(t.querySelector(".feed_friends_recomm")){let r=t.querySelector(`.${s.UI_GALLERY_CLASSNAME}`);const a=r?.getAttribute("data-from");let n=r?.getAttribute("data-code");if(a&&n&&((0,l.friendsRecommLogSave)(["view_block",a,String(e),(0,d.vkNow)(),String(o??""),n],!0),i?.()),r){const t=(0,c.uiGetGallery)(r);t?.setGalleryViewed?.(),i?.()}}else t.querySelector(".js-feed_groups_recomm")?((0,u.feedInitialViewRecommendedGroupsTrigger)(t,e),i?.()):t.querySelector("#feed_mini_apps_recomm")?(window.RecommendedMiniApps.viewBlock(),i?.()):t.querySelector(`#${h.FEED_RECOGNIZE_PHOTO_POST_ID}`)&&((0,m.recognizeBlockState)().block?.viewBlock(),i?.())};function E(t,e){f.feedInteractionItemStatCollector.logEvent({track_code:t??void 0,ref:e,item:g.FeedInteractionItemType.WALL_ITEM},g.EventItemType.CAPTION_LINK_CLICK)}function I(t){return{asc:"sort_oldest",desc:"sort_latest",smart:"sort_popular"}[t]}function T(){return(0,i.partConfigEnabled)("feed_replies_stats_web")}},626209:(t,e,o)=>{o.d(e,{getFeedPosts:()=>A,isAdWithLongImpression:()=>u,isAdWithLongImpressionOnly:()=>h,isAdWithShowOff:()=>m,isAutoplayAd:()=>c,isElemViewable:()=>p,postsGetRaws:()=>d});var i=o(56973),r=o(754866),a=o(593159),n=o(153663),s=o(374339),l=o(540462);const d=t=>{if(!(t instanceof HTMLElement))return{};let e=(0,a.indexOf)((0,r.domPN)(t).children,t),o=t.firstElementChild;if(!(o instanceof HTMLElement))return{};for(;o&&o.id.startsWith("moat");)o=(0,r.domNS)(o);if(!(o instanceof HTMLElement))return{};let i,l,d,c=/^post(-?\d+_\d+)$/,u={};if("ads_feed_placeholder"===o.id)return u;const h=window.cur;u={module:(0,n.resolveRef)(h.module,h.section,h.subsection),index:e},"feed"===h.module&&"search"===h.section&&(u.q=h.q);let m=(0,s.getAdAttribute)(o,"ad-view");m&&(u["ad_"+m]=1);let _=o.getAttribute("post_view_hash");_&&(u.hash=_);let p=o.getAttribute("data-post-track-code");if(p&&!m&&(u.trackCode=p),"block_"===o.id.substr(0,6)){u[o.id]=1,u.block=o.id.substr(6);let t=(0,r.attr)(o,"data-contain");t&&t.split(",").forEach((function(t){const e=t.split(":");u[e[0]]=(0,a.intval)(e[1])||1}))}else if(l=o.id.match(c))u[l[1]]=1;else if(l=o.id.match(/^post(adsite.*)$/))u[l[1]]=1;else if(i=o.className,l=i.match(/feed_reposts_wrap(-?\d+_\d+)/)){if(d=(0,r.domFC)(o),(0,r.hasClass)((0,r.domFC)(d),"post_copy")&&(u[l[1]]=-1),(l=(0,r.domFC)(d)?.id.match(c))&&(u[l[1]]=1),(0,r.isVisible)(d=(0,r.domNS)(d)))for(d=(0,r.domFC)(d);d;d=(0,r.domNS)(d))(l=d?.id.match(c))&&(u[l[1]]=1)}else if(l=i.match(/feed_repost(-?\d+_\d+)/)){if(d=(0,r.domFC)(o),!d)return u;(0,r.hasClass)(d,"post_copy")&&(u[l[1]]=-1),(l=d.id.match(c))&&(u[l[1]]=1)}else{let t=o.id;if((0,r.hasClass)(o,"post_photos")){d=(0,r.geByClass1)("post_image",o,"a");const e=d?.querySelector?.("[data-post-id]")?.getAttribute("data-post-id");e&&(l=e.match(/^(-?\d+_p?\d+)$/),l&&(t=l[1]))}u[t]=1}return u},c=t=>{const e=t&&(0,r.domFC)(t);return e&&((0,l.partConfigEnabled)("post_adblock_protection_promo")?(0,s.getAdAttribute)(e,"ad-video-autoplay"):e.hasAttribute("data-ad-video-autoplay"))},u=t=>{const e=t&&(0,r.domFC)(t);return e&&((0,l.partConfigEnabled)("post_adblock_protection_promo")?(0,s.getAdAttribute)(e,"ad-stat-impression_long")||(0,s.getAdAttribute)(e,"ad-disabled-stat-impression_long"):e.hasAttribute("data-ad-stat-impression_long")||e.hasAttribute("data-ad-disabled-stat-impression_long"))},h=t=>{let e=t&&(0,r.domFC)(t);return e&&((0,l.partConfigEnabled)("post_adblock_protection_promo")?(0,s.getAdAttribute)(e,"ad-views-long-only"):e.hasAttribute("data-ad-views-long-only"))},m=t=>{let e=t&&(0,r.domFC)(t);return e&&((0,l.partConfigEnabled)("post_adblock_protection_promo")?(0,s.getAdAttribute)(e,"ad-stat-show_off"):e.hasAttribute("data-ad-stat-show_off"))},_=(0,i.memoizeFirstTruthy)((()=>(0,r.ge)("page_header").offsetHeight)),p=(t,e,o,i)=>{let r=_(),a=o+r,n=o+i,s=t.offsetHeight,l=t.offsetTop+r,d=l+s;return(d>a&&l<n?(Math.min(n,d)-Math.max(a,l))/s:0)>=e},A=t=>document.querySelectorAll(`${t} .feed_row`)},816984:(t,e,o)=>{o.d(e,{friendsRecommLogClear:()=>c,friendsRecommLogGet:()=>d,friendsRecommLogOnFail:()=>m,friendsRecommLogSave:()=>l,friendsRecommLogSend:()=>u,getRef:()=>s});var i,r=o(469004),a=o(593159),n=o(761520);!function(t){t.friends_recomm="friends_recomm"}(i||(i={}));const s=()=>"feed"===window.cur.module&&window.Feed?window.Feed?.getModuleRef():window.cur.module;function l(t,e=!1){const o=d();o.push(t),r.multiAccountLs.set("friends_recomm",o),u(e)}function d(t=!1,e,o=!1){const i=r.multiAccountLs.get("friends_recomm");let n=Array.isArray(i)?i:[];return e&&(n=n.filter((t=>(o?t[1]!==e:t[1]===e)&&(0,a.inArray)(t[0],["show_user_rec","open_user"])))),t&&(n=n.map((t=>t.join("|")))),n}function c(t){if(t){const e=d(!1,t,!0);e.length?r.multiAccountLs.set("friends_recomm",e):r.multiAccountLs.remove("friends_recomm")}else r.multiAccountLs.remove("friends_recomm")}function u(t=!1){!window.cur?.friendsRecommLogIdle&&window?.curNotifier?.idle_manager&&(Array.isArray(window.cur.onIdle)||(window.cur.onIdle=[]),Array.isArray(window.cur.onUnidle)||(window.cur.onUnidle=[]),window.cur.friendsRecommLogIdle=()=>{clearTimeout(window.cur.friendsRecommLog)},window.cur.onIdle.push(window.cur.friendsRecommLogIdle),window.cur.onUnidle.push(u)),clearTimeout(window.cur.friendsRecommLog),t?h():window.cur.friendsRecommLog=window.setTimeout(h,1e4)}function h(){if(window.cur.friendsRecommProcess)return;const t=d(!0);t.length&&(window.cur.friendsRecommProcess=!0,c(),n.ajax.post("al_friends.php",{act:"a_recomm_logs",logs:t},{onDone:()=>{delete window.cur.friendsRecommProcess},onFail:()=>(m(t),delete window.cur.friendsRecommProcess,!0)}))}function m(t){let e=d();e=t.map((t=>t.split("|"))).concat(e),r.multiAccountLs.set("friends_recomm",e)}},169530:(t,e,o)=>{o.d(e,{blockInstanceSetForFeedRowContent:()=>n,feedInitialViewRecommendedGroupsTrigger:()=>a});var i=o(335700);const r="__RecommendedGroups";function a(t,e){const o=t.querySelector(".js-feed_groups_recomm"),a=t.querySelector(".ui_gallery");if(!o||!a)return void console.error(new Error("RecommendedGroups: missing block container for view"),o,a);const n=a.getAttribute("data-code")||"",s=o[r]??void 0;if(!s)return void console.error(new Error("RecommendedGroups: missing block instance"),o,a);const l="number"==typeof e?e:void 0;s.viewBlock(n,l);const d=(0,i.uiGetGallery)(a);d&&d.getVisibleItems().forEach((t=>{s.onViewGroup(t[0])})),a.visible=!0}function n(t,e){t[r]=e}},734171:(t,e,o)=>{o.d(e,{alQuickPhotoOptions:()=>a});var i=o(608524);const r=new Set(["w","x","y","z"]);function a({photo:t}){const e={},o=function(t){const e={};return t.sizes?.forEach((t=>{(t?.url??t?.src)&&t.type&&(e[t.type]=t)})),e}(t);Object.entries(o).forEach((([t,o])=>{o&&r.has(t)&&(e[t]=o.url,e[`${t}_`]=[o.url,o.width,o.height])}));const a=function(t){const e=(0,i.photoGetRestrictionsAny)(t);if(!e)return;const o={photoRaw:`${t.owner_id}_${t.id}`},r=(0,i.photoGetRestriction)(e);if("blur"===r.kind){const{blur_restriction:t}=r;return{...o,restrictionBlur:!0,restrictionTitle:t.title,restrictionText:t.text,restrictionButton:t.button?.title}}const{geo_restriction:a}=r;return{...o,restrictionGeo:!0,restrictionTitle:a.title,restrictionText:a.text,restrictionButton:a.button?.title}}(t);return{temp:{base:"",...e,...a}}}},665579:(t,e,o)=>{o.d(e,{PostAttachmentsBlock:()=>v,PostAttachmentsBlockWrapped:()=>w});var i=o(474848),r=o(364318),a=o(830828),n=o(724415),s=o(300122),l=o(902876),d=o(373318),c=o(670668),u=o(365148),h=o(237145),m=o(865708),_=o(753457),p=o(296540),A=o(312912),g=o(940286),f=o(749366),y=o(153663);function v({groups:t,profiles:e,item:o,attachmentsExpanded:r,children:h,video:m,postClickAnalytics:_,legacyActions:g,gif:f}){const y=(0,d.useProfiles)(e),v=(0,l.useGroups)(t),w=(0,p.useMemo)((()=>({postClickAnalytics:_,legacyActions:g})),[_,g]),P=(0,p.useCallback)((0,c.getFindOwner)({groups:v,profiles:y}),[v,y]);return(0,i.jsx)(u.WebAttachmentProvider,{options:w,children:(0,i.jsx)(n.FeedAttachmentProvider,{children:(0,i.jsx)(s.PostAttachments,{item:o,video:m,attachmentsExpanded:r,onRestrictedClick:a.agreeBlurRestriction,findOwner:P,showSnackbar:A.showSnackbar,feedV3Redesign:!0,gif:f,children:h})})})}function w({groups:t,profiles:e,currentUserId:o,item:a,attachmentsExpanded:n,root:s,getPostSharedState:l,gif:d}){const[c]=(0,p.useState)((()=>new f.FeedPostAttachmentsAnalytics({trackCode:(0,y.getTrackCodeFromPost)(s)??"",ref:(0,y.resolveRefFromCur)()??""}))),u=(0,h.useFeedAudioPlayerOnWeb)(s);return(0,i.jsx)(m.AppRootProvider,{platform:_.Platform.VKCOM,children:(0,i.jsx)(r.AudioPlayerProvider,{ownerId:o,platformAudioPlayer:u,children:(0,i.jsx)(g.PostSharedStateProvider,{value:l(a.id),children:(0,i.jsx)(v,{profiles:e,groups:t,item:a,attachmentsExpanded:n,gif:d,postClickAnalytics:c})})})})}},312912:(t,e,o)=>{o.d(e,{showSnackbar:()=>r});var i=o(432465);function r({action:t,content:e,onActionClick:o,isError:r}){(0,i.showSnackbar)({action:{label:t,onClick:o},text:e,type:r?"error":void 0})}},131798:(t,e,o)=>{o.d(e,{PostAttachmentsBlock:()=>i.PostAttachmentsBlock,PostAttachmentsBlockWrapped:()=>i.PostAttachmentsBlockWrapped});var i=o(665579)},237145:(t,e,o)=>{o.d(e,{useFeedAudioPlayerOnWeb:()=>s});var i=o(973229),r=o(983567),a=o(650110),n=o(92187);function s(t){return(0,i.useFeedAudioPlayer)({getAudioPlayerAdapter:()=>{const t=(0,r.getAudioPlayer)();return t?new a.WebAudioPlayerAdapter(t):void 0},rootElement:t,attachPlayerEventHandler:n.attachPlayerEventHandler,loadAudioPlayer:t=>{window.stManager.add([window.jsc("web/audio.js")],t)}})}},821680:(t,e,o)=>{o.d(e,{clickUXPollsBlock:()=>a,viewUXPollsBlock:()=>r});var i=o(636576);function r(t){(0,i.statlogsValueEvent)("uxpolls_view",t)}function a(t){(0,i.statlogsValueEvent)("uxpolls_click",t)}},580403:(t,e,o)=>{o.d(e,{PostClickAnalytics:()=>i});class i{constructor(){this.onCarouselNextClick=this.createInteractionEventSender("click_next"),this.onCarouselPrevClick=this.createInteractionEventSender("click_previous"),this.onPhotoOpen=this.createInteractionEventSender("open_photo"),this.onOpenGeoFeed=this.createInteractionEventSender("open_geo_feed"),this.onOpenNearbyPhoto=this.createInteractionEventSender("open_nearby_photo")}}},160649:(t,e,o)=>{o.d(e,{PostSharedState:()=>r});var i=o(327813);class r{get currentSlideIndex(){return this._currentSlideIndex}constructor(){this._currentSlideIndex=0,this.setCurrentSlideIndex=t=>{this._currentSlideIndex=t},(0,i.makeAutoObservable)(this)}}},896412:(t,e,o)=>{function i(t){t.preventDefault(),t.stopPropagation()}o.d(e,{cancelEvent:()=>i})},49568:(t,e,o)=>{o.d(e,{checkEvent:()=>r});var i=o(596597);function r(t){return!!(t&&t instanceof MouseEvent)&&!(0,i.isMainClick)(t)}},236132:(t,e,o)=>{o.d(e,{getElementCrossOrigin:()=>i});const i=t=>"string"!=typeof t||t.startsWith("data:")||t.startsWith("blob:")||function(t){const e=location.origin,o=new URL(t,e).origin;return o===e}(t)?null:"Anonymous"},596597:(t,e,o)=>{function i(t){return!("click"!==t.type&&"mousedown"!==t.type&&"mouseup"!==t.type||0!==t.button||t.ctrlKey||t.shiftKey||t.altKey||t.metaKey)}o.d(e,{isMainClick:()=>i})},677587:(t,e,o)=>{o.d(e,{loadImage:()=>r});var i=o(236132);const r=(t,e)=>new Promise(((o,r)=>{const a=new Image;a.crossOrigin=(0,i.getElementCrossOrigin)(t),e&&(a.dataset.name=e),a.onerror=()=>{const e=t?.startsWith("data:")?"<dataURL>":t;r(new Error(`Failed to load image's URL: ${e}`))},a.onload=()=>{o(a)},a.src=t}))},484114:(t,e,o)=>{o.d(e,{useSyncEffect:()=>a});var i=o(296540),r=o(8520);function a(t,e){const o=(0,i.useRef)([]);(0,r.isEqual)(o.current,e)||(o.current=e,t())}},103881:(t,e,o)=>{o.d(e,{Icon24AddOutline:()=>i});var i=(0,o(844990).makeIcon)("Icon24AddOutline","add_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="add_outline_24"><g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z" /><path fill="currentColor" fill-rule="nonzero" d="M12 3a.9.9 0 0 1 .9.9v7.2h7.2a.9.9 0 1 1 0 1.8l-7.2-.001V20.1a.9.9 0 1 1-1.8 0V12.9l-7.2.001a.9.9 0 1 1 0-1.8h7.2V3.9A.9.9 0 0 1 12 3" /></g></symbol>',24,24,!1,void 0)},779638:(t,e,o)=>{o.d(e,{default:()=>i});const i={primaryPollModalWrapper:"PrimaryPoll__primaryPollModalWrapper--R9hjf"}},26023:(t,e,o)=>{o.d(e,{default:()=>a});const i=new WeakMap;function r(t,e,o,r){var a,n;if(!t&&!i.has(e))return!1;const s=null!==(a=i.get(e))&&void 0!==a?a:new WeakMap;if(i.set(e,s),!t&&!i.has(e))return!1;const l=null!==(n=s.get(o))&&void 0!==n?n:new Set;s.set(o,l);const d=l.has(r);return t?l.add(r):l.delete(r),d&&t}const a=function t(e,o,i,a,n){if("string"==typeof e&&(e=document.querySelectorAll(e)),"function"!=typeof e.addEventListener){const r=Array.prototype.map.call(e,(e=>t(e,o,i,a,n)));return{destroy(){r.forEach((t=>t.destroy()))}}}const s=e,l=Boolean("object"==typeof n?n.capture:n),d=t=>{const e=t.target.closest(o);e&&(t.delegateTarget=e,t.currentTarget.contains(t.delegateTarget)&&a.call(s,t))},c=JSON.stringify({selector:o,type:i,capture:l}),u=r(!0,s,a,c),h={destroy(){s.removeEventListener(i,d,n),r(!1,s,a,c)}};return u||s.addEventListener(i,d,n),h}}}]);try{stManager?.done("dist/web/chunks/4c0cc5bf.e0fd87a6.js")}catch(t){}