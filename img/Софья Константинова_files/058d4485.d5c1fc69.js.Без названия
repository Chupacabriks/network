"use strict";(self.webpackChunkvkweb=self.webpackChunkvkweb||[]).push([[95903],{623868:(e,_,t)=>{function i(){return{icon:'<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g id="playlist_24__Page-2" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="playlist_24__playlist_24"><path id="playlist_24__Shape" d="M0 0h24v24H0z"/><path d="M13 6.88c0-.48-.4-.88-.88-.88H2.88C2.4 6 2 6.4 2 6.88v.24c0 .48.4.88.88.88h9.24c.49 0 .88-.4.88-.88v-.24Zm0 4c0-.48-.4-.88-.88-.88H2.88c-.49 0-.88.4-.88.88v.24c0 .48.4.88.88.88h9.24c.49 0 .88-.4.88-.88v-.24ZM2 15.12v-.24c0-.48.4-.88.88-.88h4.23c.5 0 .89.4.89.88v.24c0 .48-.4.88-.89.88H2.88c-.49 0-.88-.4-.88-.88Zm15 .7c0 3.74-.99 4.64-3.77 5.13-1.48.26-3.23-.48-3.23-2.8 0-1.15.72-2.23 2.2-2.51 1.12-.22-.43.05 2.12-.42.62-.12.69-.34.69-.81L15 12.56V5.98c0-1.1.83-1.5 2.6-1.85 0 0 2.34-.34 3.82-.61.33-.06.58.06.58.44V7.4c0 .37-.15.54-.53.6-1.5.27-3.99.65-3.99.65-.33.08-.48.32-.48.65v6.51Z" id="playlist_24__Mask" fill="currentColor"/></g></g></svg>',name:"playlist_24"}}t.d(_,{getIcon24Playlist:()=>i})},413855:(e,_,t)=>{function i(){return{icon:'<svg width="56" height="56" viewBox="0 0 56 56" xmlns="http://www.w3.org/2000/svg"><g id="playlist_outline_56__Icons-56/playlist_outline_56" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="playlist_outline_56__playlist_outline_28"><path id="playlist_outline_56__playlist_outline_56" d="M0 0h56v56H0z"/><path d="M39 38.93c0 4.55-1.94 7.97-5.07 9.62-2.84 1.5-6.24 1.22-8.22-.76-2.04-2.04-2.3-5.5-.58-8.3C27 36.44 30.77 34.61 36 34.5V16.76a6.88 6.88 0 0 1 5.03-6.68c1.08-.36 3.24-.92 6.5-1.67l1.64-.37A1.5 1.5 0 0 1 51 9.5v4.2a6.7 6.7 0 0 1-4.97 6.48L39 22.05Zm-3-1.42h-.4c-4 .18-6.67 1.53-7.91 3.54-1.02 1.66-.88 3.6.14 4.62.98.98 2.96 1.14 4.7.22 2.12-1.11 3.47-3.5 3.47-6.96V37.5ZM27.5 22a1.5 1.5 0 0 1 0 3h-19a1.5 1.5 0 0 1 0-3h19ZM48 11.38a83.8 83.8 0 0 0-6.03 1.54l-.21.08c-1.93.71-2.8 2.05-2.76 4.33v1.62l6.25-1.67A3.7 3.7 0 0 0 48 13.71ZM30.5 10a1.5 1.5 0 0 1 0 3h-22a1.5 1.5 0 0 1 0-3h22Z" id="playlist_outline_56__Icon-Color" fill="currentColor" fill-rule="nonzero"/></g></g></svg>',name:"playlist_outline_56"}}t.d(_,{getIcon56PlaylistOutline:()=>i})},993110:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{AudioPage:()=>AudioPage,currentAudioPage:()=>currentAudioPage});var _vkontakte_internal_domains__WEBPACK_IMPORTED_MODULE_54__=__webpack_require__(694132),_vkontakte_internal_domains__WEBPACK_IMPORTED_MODULE_62__=__webpack_require__(628592),_web_di__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(319756),_shared_evbus__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(338329),_shared_lib_browser__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(575753),_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__=__webpack_require__(983567),_web_lib_fx__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(939646),_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(636576),_shared_lib_date__WEBPACK_IMPORTED_MODULE_64__=__webpack_require__(353557),_shared_audio_formatters_formatAudioTime__WEBPACK_IMPORTED_MODULE_63__=__webpack_require__(948188),_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(226220),_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(246429),_web_lib_scroll__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(672277),_web_lib_stats__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(568129),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(972332),_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(392358),_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(972623),_web_audio_player_stat_onAdditionalEvent__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(752740),_web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(150681),_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(138586),_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(898848),_web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(586573),_web_legacy_ui_slider__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(602754),_web_lib_feature_boxes__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(788789),_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(754866),_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(270959),_web_indexer_indexer__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(542789),_web_lib_utils__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(449299),_web_grid_sorted__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(955377),_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(683234),_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(102088),_web_lib_feature_tooltips__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(568775),_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(342879),_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(909436),_shared_audio_enums__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(867366),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(593159),_web_audio_catalog_CatalogController__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(855776),_web_audio_components_FullscreenBanner__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(581789),_icons_desktop__WEBPACK_IMPORTED_MODULE_56__=__webpack_require__(413855),_icons_desktop__WEBPACK_IMPORTED_MODULE_57__=__webpack_require__(138431),_icons_desktop__WEBPACK_IMPORTED_MODULE_58__=__webpack_require__(740361),_icons_desktop__WEBPACK_IMPORTED_MODULE_59__=__webpack_require__(493782),_icons_desktop__WEBPACK_IMPORTED_MODULE_60__=__webpack_require__(623868),_icons_desktop__WEBPACK_IMPORTED_MODULE_61__=__webpack_require__(597825),_icons_desktop__WEBPACK_IMPORTED_MODULE_66__=__webpack_require__(600222),_web_components_ui_gallery__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__(335700),_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__(8520),_shared_audio_utils_isRadio__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__(22021),_shared_audio_utils_getAudioExtra__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__(482310),_player_radiostation_unfollowRadiostation__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__(598268),_player_radiostation_followRadiostation__WEBPACK_IMPORTED_MODULE_38__=__webpack_require__(509215),_shared_audioplayer_AudioPlayerAdapter_audioTuple_audioTupleToAudioObject__WEBPACK_IMPORTED_MODULE_39__=__webpack_require__(423015),_web_audio_components_AutoplayBlock__WEBPACK_IMPORTED_MODULE_40__=__webpack_require__(784818),_web_audio_ui_AudioAdActionsModal_AudioAdActionsModalController__WEBPACK_IMPORTED_MODULE_41__=__webpack_require__(7971),_shared_ranges__WEBPACK_IMPORTED_MODULE_42__=__webpack_require__(810068),_shared_lib_js_logger__WEBPACK_IMPORTED_MODULE_43__=__webpack_require__(298077),_web_audio_player_playlist_addAudioPlaylistToMyAudioPlaylists__WEBPACK_IMPORTED_MODULE_44__=__webpack_require__(793473),_web_audio_services_AudioPage__WEBPACK_IMPORTED_MODULE_45__=__webpack_require__(655146),_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__=__webpack_require__(540462),_AudioCatalogVkMixBlockTq__WEBPACK_IMPORTED_MODULE_47__=__webpack_require__(335423),_web_audio_services_AudioLongtap_AudioLongtapTooltip__WEBPACK_IMPORTED_MODULE_48__=__webpack_require__(927848),_spa_web_routes_audio_services_AudioSectionEffects__WEBPACK_IMPORTED_MODULE_49__=__webpack_require__(460167),_AudioPlayerBlockTq__WEBPACK_IMPORTED_MODULE_50__=__webpack_require__(390552),_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_51__=__webpack_require__(459899),_PlaylistLoadingProvider__WEBPACK_IMPORTED_MODULE_65__=__webpack_require__(331600),_player_radiostation_RadiostationNavigationEventsHandling__WEBPACK_IMPORTED_MODULE_52__=__webpack_require__(830632),_vkontakte_internal_plugins__WEBPACK_IMPORTED_MODULE_67__=__webpack_require__(951652),_web_audio_catalog_AudioCatalogStatsCollector__WEBPACK_IMPORTED_MODULE_53__=__webpack_require__(530351);const audioNavScreenProvider=new _vkontakte_internal_domains__WEBPACK_IMPORTED_MODULE_54__.AudioNavScreenProvider,SLIDER_TIMEOUT=1e4;let sectionsToUpdate=[];function currentAudioPage(e){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.gpeByClass)("_audio_page_layout",e);return!!_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)(_,"audioPage")}function AudioPage(e,_){const t=_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_51__.AudioPageProxy.ensure();(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)(e,"audioPage",this),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)(cur.lang||{},_.langs),(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().langs=_.langs,this._data=_,this._ownerId=_.ownerId,_.playlists&&_.playlists.length&&(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().addWithReplacePlaylists(_.playlists.filter(Boolean)),this.isLayer()||(cur.audioPage=this,_web_audio_services_AudioLongtap_AudioLongtapTooltip__WEBPACK_IMPORTED_MODULE_48__.AudioLongtapTooltip.ensure().getHints()),this.isLayer()&&uiSearch.init("audio_search_layer"),_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.toggleAudioHQBodyClass(),this._els={pageContainer:e,sections:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_sections",e),playerWrap:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_player_wrap",e),player:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_player",e),contentBlock:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_content_block",e),scrollWrap:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_content_block_wrap",e),searchSectionAudios:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_search__local_audios_list",e),searchSectionAudiosHeader:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_section_search__local_audios_header",e),searchSectionPlaylists:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_search__local_playlists_list",e),searchSectionPlaylistsHeader:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_search__local_playlists_header",e),searchNoLocalResults:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_local_no_results",e),searchGlobalBlocks:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_global_search__blocks",e),searchGlobalCommunitiesPlace:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_global_search__communities_place",e),searchGlobalPlaylistsPlace:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_global_search__playlists_place",e),searchGlobalArtistsPlace:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_global_search__artists_place",e),searchGlobalAudiosBlock:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_global_search__audios_block",e),searchGlobalAudiosBlockHeader:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_global_search__audios_header",e),searchGlobalAudiosList:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_global_search__audios_list",e),searchInput:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ui_search_field",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_search",e)),footer:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page__footer",e),footerNowPlayingInfo:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page__footer_now_playing",e),footerClearNowPlayingButton:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page__footer_clear_playlist",e)},this.isLayer()&&(this._scroll=new _web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_16__.default(this._els.scrollWrap,{global:!0,stopScrollPropagation:!0,stopScrollPropagationAlways:!0})),this._readyAudio=this._data.readyAudio;const i=this._data.readyPlaylist;i&&(this._pagePlaylist=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getPlaylist(i.type,i.ownerId,i.id),this._pagePlaylist.mergeWith(i)),!this._readyAudio&&this._pagePlaylist&&(this._readyAudio=this._pagePlaylist.getAudioAt(0)),this._data.playlistCoverUploadOptions&&(cur.audioCoverUploadOptions=cur.audioCoverUploadOptions||{},cur.audioCoverUploadOptions[this._ownerId]=this._data.playlistCoverUploadOptions),this.isLayer()||(cur.module=_.module||"audio",cur.oid=this._ownerId,+this._ownerId==+vk.id?cur.submodule="my":_shared_ranges__WEBPACK_IMPORTED_MODULE_42__.Ranges.isGroupId(this._ownerId)?cur.submodule="group_list":cur.submodule="user_list"),vk.id&&this._initPlayer(),this.initNavigation(),t.emitter.emit(_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_51__.AudioPageEventType.AudioRecomsOnboardingShowRequested,{reason:_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_51__.AudioRecomsOnboardingShowRequestedEventReason.AudioPageInit}),this.catalogController=new _web_audio_catalog_CatalogController__WEBPACK_IMPORTED_MODULE_31__.CatalogController(e),this.showSection(_.initSection,null,this._data.onlySkeleton),_.initSection||this.catalogController.initBlocksManually();const o=new URLSearchParams(location.search);this.defaultSection=!o.get("section")&&_.initSection||"general",this._initSearchParams(),this.promoAlbumSlideInit(),this._els.searchInput&&this._els.searchInput.focus(),this.isLayer()||this.isPodcastPage()||!nav.objLoc.q||"search_playlists"===nav.objLoc.section||this._els.searchInput&&(this._els.searchInput.value=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.winToUtf)(nav.objLoc.q),this._showSearchSection(nav.objLoc)),this.updateCurrentPlayingInfo(),(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().setStatusExportInfo(this._data.export),this.updateStatusExportControls(),this._initKeyEvents(),this._initMusicPlaylistDeletionEvents(),window.onAudioPageLoaded&&(window.onAudioPageLoaded.call(this),delete window.onAudioPageLoaded),this.updateShuffleButton(),this.loadMarketItemsCarousel(),t.emitter.emit(_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_51__.AudioPageEventType.Updated),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("audio_adding_radiostation_events_enabled")&&_player_radiostation_RadiostationNavigationEventsHandling__WEBPACK_IMPORTED_MODULE_52__.RadiostationNavigationEventsHandling.ensure(),(0,_web_di__WEBPACK_IMPORTED_MODULE_0__.ensureDIRootWebContainer)().resolve(_spa_web_routes_audio_services_AudioSectionEffects__WEBPACK_IMPORTED_MODULE_49__.AudioSectionEffects).activate()}(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_1__.tq)().setStartupHandler("AudioPlayerBlock/init",_AudioPlayerBlockTq__WEBPACK_IMPORTED_MODULE_50__.AudioPlayerBlockTq),(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_1__.tq)().setStartupHandler("AudioCatalogVkMixBlock/init",_AudioCatalogVkMixBlockTq__WEBPACK_IMPORTED_MODULE_47__.AudioCatalogVkMixBlockTq),AudioPage.address="audio",AudioPage.initedFromAudioTs=!1,AudioPage.updateSearchHighlight=function(e){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_playlist",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.gpeByClass)("_audio_layout",this));(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(_,"audio_search_focused","focus"===e.type)},AudioPage.onSearchFocused=function(e){AudioPage.updateSearchHighlight(e)},AudioPage.prototype.updatePlaylistsCounter=function(e){if(cur.audioPage&&e===cur.audioPage.getOwnerId()){let e;if(e=cur.audioPage._els.pageContainer.querySelector(".CatalogBlock__own_only_playlists_header .CatalogBlock__title"),e){const _=cur.audioPage._data.playlists.length;e.innerHTML=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(_,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.curLang("audio_playlists_count_title")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.gpeByClass)("_audio_page_section_layout",e),"audio_section_empty",!_)}}},AudioPage.getCoverImage=function(e,_){let t="";if(e)t=`<img alt="${(0,_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_34__.escape)(_)}" width='143px' height='143px' src="${e}" loading='lazy' />`;else{const{icon:e}=(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_56__.getIcon56PlaylistOutline)();t=`<div class="audio_pl_cover_placeholder">${e}</div>`}return t},AudioPage.setCoverImageElem=function(e,_,t){if(_){const i=e.querySelector(".audio_pl_cover_placeholder"),o=e.querySelector("img");o&&e.removeChild(o),i&&e.removeChild(i);const s=new Image;s.src=_,s.setAttribute("alt",(0,_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_34__.escape)(t)),s.setAttribute("width","143px"),s.setAttribute("height","143px"),s.setAttribute("loading","lazy"),e.appendChild(s)}else{const _=e.querySelector("img");if(_){e.removeChild(_);const{icon:t}=(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_56__.getIcon56PlaylistOutline)(),i=document.createElement("div");i.classList.add("audio_pl_cover_placeholder"),i.innerHTML=t,e.appendChild(i)}}},AudioPage.deletePlaylist=function(e,_,t){const i=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST,e,_);let o=AudioPlayer.getLang("audio_sure_delete_playlist_box_text");o=o.replace("{name}",i.getTitle()),o='<div style="overflow: hidden; text-overflow: ellipsis;">'+o+"</div>",(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showFastBox)({title:AudioPlayer.getLang("audio_sure_delete_playlist_box_title")},o,AudioPlayer.getLang("audio_sure_delete_playlist_box_yes"),function(){ajax.post("al_audio.php?act=delete_playlist",{hash:t,playlist_owner_id:e,playlist_id:_,page_owner_id:cur.audioPage?cur.audioPage.getOwnerId():0},{onDone:AudioPage.onMusicPlaylistDeleted,onFail:()=>!0}),AudioPage.onMusicPlaylistDelete(e,_)}.bind(this),_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_cancel"))},AudioPage.onMusicPlaylistDelete=(e,_)=>{const t=(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.getBoxQueue)();if(t&&t.hideAll(!0),layers&&layers.fullhide&&layers.fullhide(),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass)("_audio_pl_"+e+"_"+_),(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.re)(this)})),window.location.pathname.includes(`/music/playlist/${window.vk.id}`))return window.history.length>2?void window.history.back():void document.location.replace(`https://${window.vk.apiConfigDomains.domain}/music?section=${cur.audioPage.defaultSection}`);if(cur.audioPage){if(cur.audioPage._data.playlists=cur.audioPage._data.playlists.filter((function(t){return!(t.id==_&&t.owner_id==e)})),!cur.audioPage._data.playlists.length)return void nav.reload();cur.audioPage.updatePlaylistsCounter&&cur.audioPage.updatePlaylistsCounter(e)}},AudioPage.onMusicPlaylistDeleted=e=>{if(cur.audioPage){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section__all",cur.audioPage.getPageContainer()),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_block__playlists_items",_);if(_&&t){const _=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(t,"max-items"));if(e&&t.children.length<_){const{thumb:_,title:i}=e;e.cover_image=AudioPage.getCoverImage(_,i),t.appendChild((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.se)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.getTemplate)("audio_pl_item",e)))}t.children.length||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.gpeByClass)("_audio_page_section_layout",t),"no_playlists"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.re)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.gpeByClass)("_audio_page_titled_block",t)))}}},AudioPage.setNavScreen=function(e,_){audioNavScreenProvider.setPage(e,_)},AudioPage.prototype.getCurrentSection=function(){return this._currentSection},AudioPage.prototype.getOwnerPlaylists=function(){return this._data.playlists},AudioPage.loadPlaylists=function(ownerId,totalCount,skipFirstChunk,forAttachBox,onDone){const chunkSize=50,chunks=[];(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(totalCount)&&(onDone=totalCount,totalCount=void 0,skipFirstChunk=!1),cur.playlistsCache=cur.playlistsCache||{};const cacheKey=ownerId+"_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(skipFirstChunk);if(cur.playlistsCache[cacheKey])return onDone(cur.playlistsCache[cacheKey]);function onAllLoaded(){let e=[];(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)(chunks,(function(_,t){t&&(e=e.concat(t))})),cur.playlistsCache=cur.playlistsCache||{},cur.playlistsCache[cacheKey]=e,onDone&&onDone(e)}function _loadChunk(chunkIndex,_cb){const groupId=cur.group_id||(_shared_ranges__WEBPACK_IMPORTED_MODULE_42__.Ranges.isGroupId(cur.oid)?-cur.oid:0);ajax.post("al_audio.php?act=owner_playlists",{owner_id:ownerId,group_id:groupId,offset:chunkIndex*chunkSize,is_attach:forAttachBox?1:0},{onDone:function(playlists,totalCount,additionalData){additionalData.templates_script&&eval(additionalData.templates_script),additionalData.langs&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)(cur.lang,additionalData.langs),additionalData.audio_playlist_cover_upload_options&&(cur.audioCoverUploadOptions=cur.audioCoverUploadOptions||{},cur.audioCoverUploadOptions[ownerId]=additionalData.audio_playlist_cover_upload_options),chunks[chunkIndex]=playlists,_cb(totalCount)},onFail:function(e){if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(boxLoader),e)return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showFastBox)({title:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_error")},e),!0}})}function _loadAllChunks(e,_,t){const i=Math.ceil(e/chunkSize);if(i&&i-_!=0){const e=new callHub(t,i-_);for(let t=_;t<i;t++)_loadChunk(t,(function(){e.done()}))}else t()}(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.isUndefined)(totalCount)?_loadChunk(0,(function(e){_loadAllChunks(e,1,onAllLoaded)})):_loadAllChunks(totalCount,skipFirstChunk?1:0,onAllLoaded)},AudioPage.prototype.getOwnerId=function(){return+this._ownerId},AudioPage.prototype.getPageContainer=function(){return this._els.pageContainer},AudioPage.prototype.getCurrentSectionEl=function(){return this.catalogController.currentSection&&this.catalogController.currentSection.getSectionElement()},AudioPage.prototype.reloadGeneralSectionData=function(e=null){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(boxLoader),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(boxLayerWrap),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.boxRefreshCoords)(boxLoader),this.showSection("general",(()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(boxLoader),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(boxLayerWrap),e?.()}),!1,!0)},AudioPage.prototype.canAddToGroup=function(){return this._data.canAudioAddToGroup},AudioPage.prototype.canEditGroup=function(){return this._data.canEdit},AudioPage.prototype.updateCurrentPlayingInfo=function(){if(!this.isLayer())return;const e=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)(),_=e.getCurrentPlaylist();let t=_?_.getTitle():"";if(_&&null!==_.getTitleLang()&&window.langConfig&&window.langConfig.id!==_.getTitleLang()&&ajax.post("al_audio.php?act=get_playlist_info",{owner_id:_.getOwnerId(),playlist_id:_.getAlbumId(),access_hash:_.getAccessHash()},{onDone:t=>{_.updatePlaylist(t)&&(e.saveStateCurrentPlaylist(),this.updateCurrentPlayingInfo())},onFail:()=>{}}),t){let e=_.getOriginalPlaylistRawId();if(_.getBlockId()){t=`<a href="${`/audio?section=recoms_block&type=${_.getBlockId()}`}"\n                  class="audio_page__footer_now_playing_link">\n                  ${t}\n                </a>`}else if(e||_.getType()===_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST&&0!==_.getAlbumId()){let i,o,s;e?(e=e.split("_"),i=e[0],o=e[1],s=e[2]||""):(i=_.getOwnerId(),o=_.getAlbumId(),s=_.getAccessHash()||"");t=`<a href="${nav.toStr((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)({},nav.objLoc,{z:"audio_playlist"+i+"_"+o+(s?"/"+s:"")}))}"\n                  class="audio_page__footer_now_playing_link"\n                  onclick="if (checkEvent(event)) { return true } else { AudioUtils.showAudioPlaylist(${i}, ${o}, '${s}'); return cancelEvent(event) }">\n                  ${t}\n                </a>`}this._els.footerNowPlayingInfo.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_current_playing_from").replace("{playlist}",t)}else{const e=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getCurrentAudio();if(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isPodcast(e)){const _=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_podcast_playing");this._els.footerNowPlayingInfo.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_current_playing_from").replace("{playlist}",_.replace("{name}",e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER]))}else this._els.footerNowPlayingInfo.innerHTML=""}this._els.footerClearNowPlayingButton.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_clear_current_playlist"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggle)(this._els.footer,!!_)},AudioPage.prototype.onSearchFiltersChanged=function(e){const _=window.radioBtns["audio_search_type_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(this.isLayer())],t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(this._searchSortFilter.selectedItems()[0][0]),i={performer:_.val?1:null,lyrics:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_fltr_with_lyrics",this._els.pageContainer),"on")?1:null,sort:t?1:null};this.syncParametersUI(i);let o=e&&(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isObject)(e)?e:i;this.isLayer()&&(o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)({},this._prevLoc,o)),nav.change(o,!1,{fromSearch:!0,filtersChanged:!0})},AudioPage.prototype._initSearchParams=function(){window.radioBtns["audio_search_type_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(this.isLayer())]={els:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass)("_audio_search_type",this._els.pageContainer),keep:this.isLayer()};const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_fltr_sort",this._els.pageContainer);e&&(this._searchSortFilter=new window.Dropdown(e,this._data.sortFilters,{big:1,zeroPlaceholder:!0,onChange:this.onSearchFiltersChanged.bind(this)})),this.isLayer()||this.syncParametersUI(nav.objLoc)},AudioPage.prototype.syncParametersUI=function(e){const _="audio_search_type_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(this.isLayer()),t=window.radioBtns[_];t&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.radiobtn)(t.els[e.performer?1:0],!!e.performer,_);const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_fltr_with_lyrics",this._els.pageContainer);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(i,"on",!!e.lyrics);const o={performer:AudioPlayer.getLang("audio_performers_only"),lyrics:AudioPlayer.getLang("audio_search_with_text"),sort:AudioPlayer.getLang("audio_search_by_length")},s=this._els.searchInput;(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)(["performer","lyrics","sort"],(function(_,t){uiSearch.toggleFilter(s,t,o[t],!!e[t])}))},AudioPage.onFilterRemoved=function(e,_,t){const i=currentAudioPage(_);(function(){switch(e){case"performer":const e="audio_search_type_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(this.isLayer()),_=window.radioBtns[e];(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.radiobtn)(_.els[0],0,e);break;case"sort":const t=this._searchSortFilter.options.defaultItems[0][0];this._searchSortFilter.selectItem(t,!1);break;case"lyrics":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_fltr_with_lyrics",this._els.pageContainer),"on")}t||this.onSearchFiltersChanged()}).apply(i)},AudioPage.prototype._showSearchSection=function(e){const _=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("audio_player_redesign_web_enabled")||(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("redesign_audio_player_tooltip_dislikes_web_enabled");this._toggleSearchProgress(!0);const t=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST,this.getOwnerId(),_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.DEFAULT_PLAYLIST_ID);if(_||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player2")){const _=e.globalQuery||e.q;this._sectionData={q:_,performer:e.performer};const t=void 0!==e.fromSuggestsAcceptId;t||(this._cur_qid=(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_8__.generateQID)()),this.showSection("search",function(){if(_){const i=this._data.sectionData.search?this._data.sectionData.search.qid:0;(0,_web_lib_stats__WEBPACK_IMPORTED_MODULE_8__.saveSearchAttemptStats)(_web_lib_stats__WEBPACK_IMPORTED_MODULE_8__.serviceAudio,0,!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.isVisible)(this._els.searchNoLocalResults),_,i,void 0,void 0,void 0,void 0,t&&e.fetchedQuery,void 0,void 0,e.fromSuggestsAcceptId)}this._toggleSearchProgress(!1)}.bind(this))}else t.loadAll(function(){this._toggleSearchProgress(!1),this._doShowSearchSection(e)}.bind(this))},AudioPage.prototype._toggleSearchProgress=function(e){this._els.searchInput&&!this._muteSearch&&(e?uiSearch.showProgress(this._els.searchInput):uiSearch.hideProgress(this._els.searchInput))},AudioPage.prototype._doShowSearchSection=function(e){const _=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)();if(e&&(this._prevSearchParams=e),!(e=e||this._prevSearchParams))return;let t=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.replaceEntities)(e.q)+(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.replaceEntities)(e.globalQuery||"");(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)(["performer","lyrics","sort"],(function(_,i){t+=e[i]||0})),t+=this._ownerId,this._toggleSearchProgress(!0);const i=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST,this._ownerId,_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.DEFAULT_PLAYLIST_ID);function o(){i.search(e,function(i){let o="";const s=this._data.playlistsIndex?this._data.playlistsIndex.search(e.q):[];if(this.showSection("search"),s.length){let e="";(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)(s,(function(_,t){t.cover_image=AudioPage.getCoverImage(t.thumb,t.title),e+=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.getTemplate)("audio_pl_item",t)})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(this._els.searchSectionPlaylistsHeader),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(this._els.searchSectionPlaylists),o=+this._ownerId===vk.id?_.langs.audio_found_your_local_playlists:_shared_ranges__WEBPACK_IMPORTED_MODULE_42__.Ranges.isUserId(this._ownerId)?_.langs.audio_found_user_local_playlists:_.langs.audio_found_group_local_playlists,this._els.searchSectionPlaylistsHeader.innerHTML=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(s.length,o),this._els.searchSectionPlaylists.innerHTML=e}else(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchSectionPlaylistsHeader),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchSectionPlaylists);const a=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_SEARCH,vk.id,(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_22__.hashCode)(t));a.mergeWith({list:i,searchParams:{globalQuery:e.globalQuery||e.q,performer:e.performer,lyrics:e.lyrics,sort:e.sort}}),a.setLocalFoundCount(i.length),i.length||s.length?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchNoLocalResults):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(this._els.searchNoLocalResults),o=vk.id===+this._ownerId?_.langs.audio_no_local_results:_shared_ranges__WEBPACK_IMPORTED_MODULE_42__.Ranges.isUserId(this._ownerId)?_.langs.audio_no_user_local_results:_.langs.audio_no_group_local_results,this._els.searchNoLocalResults.innerHTML=o.replace("{query}","<strong>"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clean)(e.q)+"</strong>")),i.length||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchSectionAudiosHeader),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchSectionAudios)),this._pagePlaylist=a,this._toggleSearchProgress(!1)}.bind(this))}i.loadAll(function(){clearTimeout(this._onSilendLoadedTO),this._onSilendLoadedTO=setTimeout(function(){o.call(this)}.bind(this))}.bind(this))},AudioPage.prototype.showFriendMusic=function(e,_){return(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_4__.statlogsValueEvent)("audio_friends_block","click_friend"),this.isLayer()?nav.go({0:"/audios"+_},!1,{friendId:_}):nav.go("/audios"+_,e),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(e)},AudioPage.prototype._deinitNavigation=function(){cur.nav.pop(),this._navigationInited=!1},AudioPage.PageSections=["recoms_audio","recoms_block","search_block","recoms_personal","my"],AudioPage.followedRadioClassName="audio_page_player_follow_radiostation--followed";const layerSectionsToMainFrame=["search_block","search_playlists","recoms_block"];function isAdPlayingWithChoices(){const e=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)();return e.ads.isActive&&!!e.ads.getCurrentAd()}function makeAudioAdMoreLink(){const e=document.createElement("a");return e.href="#",e.classList.add("audio_page_player_ad_more_link"),e.innerHTML=`${_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_audio_ad_more")} ${(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_66__.getIcon12Dropdown)().icon}`,e.addEventListener("click",(e=>{e.preventDefault();const{currentTarget:_}=e,t=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)(),i=_web_audio_ui_AudioAdActionsModal_AudioAdActionsModalController__WEBPACK_IMPORTED_MODULE_41__.AudioAdActionsModalController.ensure();i.isOpen(_)?i.close(_):i.open(_,t.ads.getCurrentAd())})),e}function makeAudioDisableAdsLink(){const e=document.createElement("a");return e.href="/vk_music",e.classList.add("audio_page_player_ad_disable_link"),e.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_audio_ads_off"),AudioPage.initedFromAudioTs||(0,_shared_lib_js_logger__WEBPACK_IMPORTED_MODULE_43__.logError)(new Error("AudioPage inited bypassing entrypoint")),e.addEventListener("click",(e=>{e.preventDefault(),(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_4__.statlogsValueEvent)("audio_web_ad_link","click"),nav.go(e.currentTarget.href)})),e}function makeAudioAdPerformerDivider(){const e=document.createElement("span");return e.innerHTML=" · ",e.classList.add("audio_page_player_ad_performer_divider"),e}function checkMyMusicCreationBlockActionEnabled(){return(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("create_my_music_playlist_button_in_carousel")}AudioPage.prototype.initNavigation=function(){this._navigationInited||this.isPodcastPage()||(this._navigationInited=!0,this._prevLoc={},!this.isLayer()&&nav.objLoc.popup&&"recoms_onboarding"===nav.objLoc.popup&&_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_51__.AudioPageProxy.ensure().emitter.emit(_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_51__.AudioPageEventType.AudioRecomsOnboardingShowRequested,{reason:_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_51__.AudioRecomsOnboardingShowRequestedEventReason.Navigation}),cur.nav.push(function(e,_,t,i){const o=this._ignoreResetedSearch;if(delete this._ignoreResetedSearch,o&&i.fromSearch)return!1;if(i.isLayer&&!this.isLayer())return!1;if(t.popup&&"recoms_onboarding"===t.popup)return _web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_51__.AudioPageProxy.ensure().emitter.emit(_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_51__.AudioPageEventType.AudioRecomsOnboardingShowRequested,{reason:_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_51__.AudioRecomsOnboardingShowRequestedEventReason.Navigation}),nav.setLoc(t),!1;if(t.screen)return;if(this.isLayer()&&!1!==this._prevLoc){_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clone)(this._prevLoc),e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clone)(t);for(let i in _)_.hasOwnProperty(i)&&(_[i]&&void 0===t[i]?e[i]=!1:_[i]==t[i]&&delete e[i])}if(!e||!Object.keys(e).length)return;let s;if(this._deleteDeletedAudios(),this.isLayer()){s=!t.q&&!!_.q&&t.section===_.section?this.prevSection||this.defaultSection:t.section}else s=t.section||this.defaultSection;let a=!1;return 0===t[0].indexOf("podcasts")&&(s="podcast"),i.tab||i.fromSearch||!1===e.q&&1===Object.keys(e).length||i.searchPerformer?a=!1:i.friendId&&this.isLayer()?(s="friend",this.resetSection(s),this._sectionData={friend_id:i.friendId},a=!1):(2!==Object.keys(e).length||!1!==e.q||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.isUndefined)(e[0]))&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.isUndefined)(e[0])?"signal"===t.section||"signal"===_.section?a=!0:((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.inArray)(e.section,AudioPage.PageSections)||e.hasOwnProperty("block")||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.inArray)(_.section,AudioPage.PageSections)&&!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.inArray)(e.section,AudioPage.PageSections))&&(!this.isLayer()||layerSectionsToMainFrame.includes(t.section)||e.hasOwnProperty("block")?a=!0:(a=!1,this._sectionData={audio_id:e.audio_id},s="recoms",delete this._currentSection)):a=!0,a?(this.catalogController&&this.catalogController.destroy(),!0):(t.q?(this._els.searchInput&&!i.fromSearch&&(this._els.searchInput.value=t.q,(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.triggerEvent)(this._els.searchInput,"keyup",{},!0),this.lastQuery=t.q),this._showSearchSection((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)({},t,i))):(this._ignoreResetedSearch=!1===e.q,this._els.searchInput&&uiSearch.reset(this._els.searchInput,!0),this.showSection(s),this._switchTab(s)),this.isLayer()?this._prevLoc=t:nav.setLoc(t),(i.back||i.hist||i.nav)&&this.syncParametersUI(t),!1)}.bind(this)))},AudioPage.prototype._deleteDeletedAudios=function(){_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.deleteDeletedAudios()},AudioPage.prototype._switchTab=function(e){if(this.isPodcastPage())return;const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_tab__"+e,this._els.pageContainer);_?uiTabs.switchTab((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domFC)(_)):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ui_tab_sel",this._els.pageContainer),"ui_tab_sel")},AudioPage.prototype.onLayerHide=function(){const e=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("audio_player_redesign_web_enabled")||(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("redesign_audio_player_tooltip_dislikes_web_enabled");this._deinitNavigation(),this._deinitKeyEvents(),this._onSectionOut(),delete this._currentSection,this._muteSearch=!0,(e||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player2"))&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchNoLocalResults),setTimeout((()=>uiSearch.reset(this._els.searchInput)),1e3)},AudioPage.prototype.updateLayerHeight=function(){let e=700;e=Math.min(e,window.innerHeight-150),e=Math.max(e,400),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.isVisible)(this._els.footer)&&(e-=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getSize)(this._els.footer)[1]),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(this._els.scrollWrap,{height:e}),this._els&&this._els.scrollWrap&&"function"==typeof this._els.scrollWrap.updateScroll&&this._els.scrollWrap.updateScroll()},AudioPage.prototype.scrollToCurrentTrack=function(){const e=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getCurrentAudio(),_=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getPlaylistQueue();if(this._audioRowsAutoList&&e&&_.indexOfAudio(e)>=0){let e=10;for(;e--;){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_CURRENT_CLS,this._audioRowsAutoList.getListEl());if(e){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getXY)(e)[1];this._scroll.scroller.scrollTop=_-(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_7__.scrollGetY)()-300,this._scroll.update(),this._layerStartInit=!1;break}this._audioRowsAutoList.drawMore(),(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().updateCurrentPlaying()}}},AudioPage.prototype.onLayerShow=function(e){this._layerStartInit=!0;const _=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getCurrentPlaylist(),t=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isPodcast((0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getCurrentAudio());if(t)this.showSection("podcast");else if(_)this.showSection("current");else if(e){(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getPlaylistQueue().isEmpty()&&"current"===e?this.showSection("all"):this.showSection(e)}else this.showSection("all");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_tab__current",this._els.pageContainer),"unshown",!_||t),this.initNavigation(),this.updateCurrentPlayingInfo(),this._initKeyEvents(),this.updateLayerHeight(),this.updateShuffleButton(),this.scrollToCurrentTrack(),delete this._muteSearch},AudioPage.prototype.resetSection=function(e){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section__"+e,this._els.sections);this.catalogController.deleteSection(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.re)(_)},AudioPage.prototype.isUpdateRequested=function(e){return Array.isArray(sectionsToUpdate)&&sectionsToUpdate.includes(e+this.getOwnerId())},AudioPage.prototype.requestUpdate=function(e,_=""){sectionsToUpdate=e.map((e=>e+_))},AudioPage.prototype.showSection=function(e,_,t,i){const o=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("audio_player_redesign_web_enabled")||(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("redesign_audio_player_tooltip_dislikes_web_enabled");!i&&this._currentSection&&this._currentSection!==this.prevSection&&(this.prevSection=this._currentSection),this.isPodcastPage()&&(e="podcast"),"search"!==this._currentSection||"all"!==e&&"current"!==e||uiSearch.reset(this._els.searchInput,!0),this._data.onlySkeleton||layers.fullhide&&layers.fullhide(),this._switchTab(e);const s=o||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player2")&&"search"===e||this.isUpdateRequested(e),a=this._data.sectionData&&this._data.sectionData[e]||{};if(a.name=e,!this.isLayer()&&(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("audio_nav_screens_web")){const{sectionId:e}=a;e&&audioNavScreenProvider.catalogSectionId!==e&&audioNavScreenProvider.setPage(_vkontakte_internal_domains__WEBPACK_IMPORTED_MODULE_54__.AudioNavScreenPageType.Catalog,e)}if(!i&&this._currentSection===e&&"search"!==this._currentSection)return void((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(_)&&_());if((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("search_audio_catalog_web")&&"search"===e&&!this.isLayer())return;this._currentSection=e;const l=this.findSectionElement(e);if(t||(this._data.onlySkeleton=!1),!i&&l&&(!s||!1===t)&&!this._data.onlySkeleton){if((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass)("_audio_section",this._els.pageContainer),(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this)})),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchGlobalBlocks),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchGlobalCommunitiesPlace),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchGlobalPlaylistsPlace),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchGlobalArtistsPlace),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchGlobalAudiosBlock),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(l),(o||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player2"))&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.searchNoLocalResults),"search"===e&&!l.innerHTML)){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(this._els.searchNoLocalResults);const e=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)(),_=vk.id===+this._ownerId?e.langs.audio_no_local_results:_shared_ranges__WEBPACK_IMPORTED_MODULE_42__.Ranges.isUserId(this._ownerId)?e.langs.audio_no_user_local_results:e.langs.audio_no_group_local_results,t=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.winToUtf)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clean)(a.searchParams?.globalQuery??""));this._els.searchNoLocalResults.innerHTML=_.replace("{query}","<strong>"+t+"</strong>")}if(this._onSectionOut(),delete cur._back,"podcast"!==e&&(this.catalogController.setSection(e,l,a||{}),!this.isLayer()&&_shared_ranges__WEBPACK_IMPORTED_MODULE_42__.Ranges.isUserId(window.vk.id)&&_web_audio_components_FullscreenBanner__WEBPACK_IMPORTED_MODULE_32__.FullscreenBanner.initiate(a.sectionId)),this._destroyAutoplayBlock(),this._onSectionOut((()=>{this.catalogController.disableSection(e)})),this.isLayer()||(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getCurrentPlaylist()||!a.title||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setDocumentTitle)(a.title),!["podcast","current"].includes(e))return(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(_)&&_(),void(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().updateCurrentPlaying();switch(e){case"current":this._initSection_current(l,a,!0);break;case"podcast":this._initSection_podcast(l,a)}return(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().updateCurrentPlaying(),void((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(_)&&_())}let n=this._ownerId,r=!1;if("podcast"===e&&!this.isPodcastPage()){const e=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getCurrentAudio()||this._readyAudio;n=e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID];(0,_shared_audio_utils_getAudioExtra__WEBPACK_IMPORTED_MODULE_36__.getAudioExtra)(e).voiceAssistant&&(r=!0)}if(this.isUpdateRequested(e)&&(sectionsToUpdate=null),r)return void setTimeout((()=>{const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.se)(`<div class="audio_section _audio_section _audio_section__${e} audio_section__${e} clear_fix audio_w_covers">\n        <div class="page_block audio_block">\n          <div class="audio_page__audio_rows _audio_page__audio_rows">\n            <div class="audio_page__audio_rows_list _audio_page__audio_rows_list audio_w_covers"></div>\n          </div>\n        </div>\n      </div>`);this._els.sections.appendChild(t),delete this._currentSection,this.showSection(e,_,!1)}));let d="",u={};if((i||this._data.onlySkeleton)&&a.sectionId)d="/audio?act=load_catalog_section",u.section_id=a.sectionId;else{d="al_audio.php";const _={act:"section",section:e,owner_id:n,is_layer:this.isLayer()?1:0,claim:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(nav.objLoc.claim)};"search"===e&&(_.query_id=this._cur_qid),u={...this._sectionData,..._}}ajax.post(d,u,{onDone:(t,i)=>{this._data.sectionData=this._data.sectionData||{};this.findSectionElement(e)&&t&&this.resetSection(e),this._data.sectionData[e]=i;const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.se)('<div class="audio_section _audio_section _audio_section__'+e+" audio_section__"+e+' clear_fix audio_w_covers">'+t+"</div>");if(this._els.sections.appendChild(o),delete this._currentSection,this.showSection(e,_,!1),this.scrollToAnchor(),(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("audio_adding_radiostation_events_enabled")){(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().notify(_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.NAVIGATE_TO_SECTION,i?.sectionId)}},onFail:()=>!0}),delete this._sectionData},AudioPage.prototype._onSectionOut=function(e){e?(this._onSectionOutCbs=this._onSectionOutCbs?this._onSectionOutCbs:[],this._onSectionOutCbs.push(e)):((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)(this._onSectionOutCbs||[],(function(e,_){_()})),this._onSectionOutCbs=[])},AudioPage.prototype.scrollToAnchor=function(){const e=window.location.hash;if(!e)return;const _=e.replace("#",""),t=document.getElementById(_),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getSize)("page_header")[1]||48,o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getSize)("playerWrap")[1]||56,s=window.innerWidth>999?o:0,a=t.getBoundingClientRect().top+window.scrollY-i-s;t&&setTimeout((()=>window.scrollTo({top:a,behavior:"smooth"})),50)},AudioPage.prototype.findSectionElement=function(e){const[_]=this._els.sections.getElementsByClassName("_audio_section__"+e);return _},AudioPage.prototype.onPlaylistsReorder=function(e,_,t){const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(e,"raw-id"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(t,"raw-id");ajax.post("al_audio.php",{act:"reorder_playlist",owner_id:this.getOwnerId(),playlist_id:i.split("_")[1],prev_playlist_id:o?o.split("_")[1]:0,hash:this._data.reorderHash},{onFail:()=>!0})},AudioPage.prototype._initSection_current=function(e,_){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)(this._els,{audioRows:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page__audio_rows_list",e),audioRowsMore:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_more_rows",e),friendsBlock:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_friends_list_wrap",e),friendsBlockContent:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_friends_list_content",e)});const t=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getCurrentPlaylist();if(!t&&!this.retriedCurrent)return this.retriedCurrent=!0,setTimeout((()=>this._initSection_current(e,_)));this.isLayer()&&(this._scroll=new _web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_16__.default(this._els.scrollWrap,{global:!0,stopScrollPropagation:!0,stopScrollPropagationAlways:!0})),t&&(this._pagePlaylist=t,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(this._els.audioRows,"playlist-id",t.getId()));const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_friends_search",e);i&&uiSearch.init(i),this._initAudioRowsAutoList(!0),setTimeout((()=>this._initFixedFriendsBlock(e)))},AudioPage.prototype.drawMore=function(){this._audioRowsAutoList&&this._audioRowsAutoList.drawMore()},AudioPage.prototype.scrollIntoView=function(e,_){this._scroll.scrollIntoView(e,_)},AudioPage.prototype._initSection_podcast=function(e,_){(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)(this._els,{audioRows:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page__audio_rows_list",e),audioRowsMore:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("podcast_episodes_more",e)});let t=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getCurrentPlaylist();if(!t){const e=_.playlistData;e&&(t=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getPlaylist(e.type,e.ownerId,e.id),t.getAudiosCount()||(t.mergeWith(e),t.load()))}t&&(this._pagePlaylist=t,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(this._els.audioRows,"playlist-id",t.getId())),this._initAudioRowsAutoList(),this._data.reverse||this._enableAudioRowsSorter()},AudioPage.prototype.setPagePlaylist=function(e){this._pagePlaylist=e},AudioPage.prototype._initFixedFriendsBlock=function(){if(!this._els.friendsBlock)return;this._isFixed=!1,this._isDraggable=!1,this._initialPos=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getXY)(this._els.friendsBlock);const e=this.isLayer(),_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getSize)("page_header")[1],t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getSize)(this._els.playerWrap)[1],i=e?13:15;this._fixedThreshold=e?_+t+i:this._initialPos[1]-_-t-i;const o=e?this._scroll.scroller:window;if(this._fixedThreshold<0)return;(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(window,"resize",this._resizeHandler=()=>{this._initialPos=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getXY)(this._els.friendsBlock)}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(o,"scroll",this._scrollHandler=()=>{this._moveFriendsBlock()});const s=this;AudioPage.onUpdateDraggablePosition=()=>{s._isDraggable=!0,s._moveFriendsBlock(),requestAnimationFrame((()=>s._isDraggable=!1))},AudioPage.forceFix=()=>{const e=s._els.friendsBlockContent.getBoundingClientRect();if(!(e.width>0&&e.height>0))return;const _=s.isLayer()?s._scroll.scroller.scrollTop:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_7__.scrollGetY)();s._els.friendsBlockContent.style.transform=`translate(0,${Math.max(0,_-s._fixedThreshold-9)}px)`,s._unfixedFriendsBlock()},this._onSectionOut((()=>{this._scrollHandler&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(o,"scroll",this._scrollHandler),this._resizeHandler&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window,"resize",this._resizeHandler),this._fixedBlockScrollHandler&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(this._els.friendsBlockContent,"mousewheel",this._fixedBlockScrollHandler),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(this._els.friendsBlockContent,"audio_friends_fixed")}))},AudioPage.prototype._moveFriendsBlock=function(){const e=this.isLayer()?this._scroll.scroller.scrollTop:(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_7__.scrollGetY)(),_=this._els.friendsBlockContent.getBoundingClientRect(),t=_.width>0&&_.height>0;this._isDraggable&&t?(this._els.friendsBlockContent.style.transform=`translate(0,${Math.max(0,e-this._fixedThreshold-9)}px)`,this._unfixedFriendsBlock()):(this._els.friendsBlockContent.style.transform="",e>this._fixedThreshold?this._fixedFriendsBlock():this._unfixedFriendsBlock())},AudioPage.prototype._fixedFriendsBlock=function(){this._isFixed||(this._initialPos=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getXY)(this._els.friendsBlock),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(this._els.friendsBlock,"audio_friends_fixed"),this._isFixed=!0,this.isLayer()&&(this._fixedBlockScrollHandler=(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(this._els.friendsBlockContent,"mousewheel",(e=>(this._scroll.scroller.scrollTop=this._scroll.scroller.scrollTop+e.deltaY,(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(e))))))},AudioPage.prototype._unfixedFriendsBlock=function(){this._isFixed&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(this._els.friendsBlock,"audio_friends_fixed"),this._isFixed=!1,this._fixedBlockScrollHandler&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(this._els.friendsBlockContent,"mousewheel",this._fixedBlockScrollHandler))},AudioPage.prototype.playPlaylist=function(e,_,t,i){const o=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)(),s=o.getCurrentPlaylist(),a=o.getPlaylist(e,_,t);s&&s.equals(a)&&o.isPlaying()?o.pauseByButton():a.load(0,(function(){o.playList({audio:a.getAudiosList()[0],playlist:a,context:i})}))},AudioPage.prototype.playShuffledBlockPlaylist=function(e){const _=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)(),t=_.getPlaylistByBlockId(e)||new _web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist({hasMore:!0,blockId:e});t.clean(),t.loadByBlockId("",(function(e){_.playShuffledList({audio:e.getAudiosList()[0],playlist:e,context:e.getContext()})}))},AudioPage.prototype.saveAsPlaylist=async function(e){const _=document.querySelector(".audio_page_save_as_playlist_button"),t=document.querySelector(".audio_page_save_as_playlist_button_text");_.disabled=!0;const i=document.querySelector("#audio_page_save_as_playlist_icon_create"),o=document.querySelector("#audio_page_save_as_playlist_icon_delete"),s=(0,_web_audio_services_AudioPage__WEBPACK_IMPORTED_MODULE_45__.ensureAudioPageMyAudioPlaylistsService)();s.setUserId(vk.id);const a=s.$myAudioPlaylistsIdentitiesMap.getState()[e];if(a){try{await s.deleteFx({blockId:e,id:a.id}),o.classList.add("audio_page_save_as_playlist_icon_hide"),i.classList.remove("audio_page_save_as_playlist_icon_hide"),t.textContent=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_save_as_playlist_button")}catch(e){console.error("[AudioPage saveAsPlaylist]",e)}finally{_.disabled=!1}return}const l=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getPlaylistByBlockId(e)||new _web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist({hasMore:!0,blockId:e});l.clean(),l.loadByBlockId("",(async function(a){try{await(0,_web_audio_player_playlist_addAudioPlaylistToMyAudioPlaylists__WEBPACK_IMPORTED_MODULE_44__.addAudioPlaylistToMyAudioPlaylists)(e,a,s),i.classList.add("audio_page_save_as_playlist_icon_hide"),o.classList.remove("audio_page_save_as_playlist_icon_hide"),t.textContent=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_save_as_playlist_delete_button")}catch(e){console.error("[AudioPage saveAsPlaylist]",e)}finally{_.disabled=!1}}))},AudioPage.prototype.playBlockPlaylist=function(e,_=null){const t=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)(),i=t.getCurrentPlaylist(),o=t.getPlaylistByBlockId(e)||new _web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist({hasMore:!0,blockId:e});if(i&&i.equals(o)&&t.isPlaying())t.pauseByButton();else{const e=o.getContext()||_&&_.dataset.context||"";o.loadByBlockId("",(_=>{t.playList({audio:_.getAudiosList()[0],playlist:_,context:e})}))}},AudioPage.prototype.onAudioRowsReorder=function(e,_,t,i){const o=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)(),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(_,"full-id"),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(i,"full-id"),l=o.getPlaylistQueue(),n=this.getPageCurrentPlaylist();let r=(e?l:n).indexOfAudio(s),d=(e?l:n).indexOfAudio(a);a?d++:d=0,l.moveAudio(r,d),e&&o.saveStateCurrentPlaylist(),this.isPodcastPage()?ajax.post("al_podcasts.php",{act:"a_reorder_episodes",hash:this._data.audiosReorderHash,oid:this.getOwnerId(),episode_id:s?s.split("_")[1]:0,next_episode_id:a?a.split("_")[1]:0},{onFail:()=>!0}):e||ajax.post("al_audio.php",{act:"reorder_audios",hash:this._data.audiosReorderHash,owner_id:this.getOwnerId(),audio_id:s?s.split("_")[1]:0,next_audio_id:a?a.split("_")[1]:0},{onFail:()=>!0})},AudioPage.prototype._enableAudioRowsSorter=function(e){(this._data.audiosReorderHash||e)&&(this._audioRowsSorter&&this._audioRowsSorter.destroy(),this._audioRowsSorter=new _web_grid_sorted__WEBPACK_IMPORTED_MODULE_23__.default(this._els.audioRows,"",{wrapNode:this.isLayer()?this._scroll.scroller:void 0,onReorder:(_,t,i)=>this.onAudioRowsReorder(e,_,t,i)}),this._onSectionOut(function(){this._audioRowsSorter&&this._audioRowsSorter.destroy()}.bind(this)))},AudioPage.prototype._disableAudioRowsSorter=function(){this._audioRowsSorter&&this._audioRowsSorter.disable()},AudioPage.prototype._initAutoplayBlock=function(e,_){(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getPlaylistQueue().isAutoplaySupported&&(this._els.autoplayBlock||(this._els.autoplayBlock=new _web_audio_components_AutoplayBlock__WEBPACK_IMPORTED_MODULE_40__.AutoplayBlock),this._els.autoplayBlock.init(e,_))},AudioPage.prototype._destroyAutoplayBlock=function(){this._els.autoplayBlock?.destroy()},AudioPage.prototype._onCurrentSectionNeedRows=async function(e,_){const t=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getPlaylistQueue();e(await t.getAudios(_,_+_shared_audio_enums__WEBPACK_IMPORTED_MODULE_29__.AUDIO_PLAYER_ENUMS.AUDIO_QUEUE_MAX_AUDIOS_COUNT))},AudioPage.prototype._initAudioRowsAutoList=function(e=!1){if(!this._els.audioRows)return;const _=this.isPodcastPage()||"podcast"===this._currentSection,t=this._pagePlaylist;this._els.audioRows.innerHTML="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(this._els.audioRows,"audio_owner_list_canedit",!_&&!!this._data.canEdit),this._audioRowsAutoList&&this._audioRowsAutoList.destroy(),this._audioRowsAutoList=new _web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_13__.default(this._els.audioRows,{scrollNode:!!this._scroll&&this._scroll.scroller,onRendered:function(){(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().updateCurrentPlaying()},onNoMore:function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(this._els.audioRowsMore),e&&this._initAutoplayBlock(this.getCurrentSectionEl(),this._scroll)}.bind(this),offset:0,onNeedRows:function(i,o,s,a,l){const n=[],r=(e=[])=>{e.forEach((e=>{n.push(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.drawAudio(e))})),i(n),0===o&&this._audioRowsSorter&&this._audioRowsSorter.update(),0===o&&1===n.length&&l.drawMore()};_?((0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.lockButton)(this._els.audioRowsMore),this._loadPodcastEpisodes(o,function(e){r((e||[]).slice(o)),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.unlockButton)(this._els.audioRowsMore)}.bind(this))):e?this._onCurrentSectionNeedRows(r,o):t&&t.load(o,(()=>{const e=t.getAudiosList();r(e)}))}.bind(this)}),this._onSectionOut(function(){this._destroyAutoplayBlock(),this._audioRowsAutoList.destroy(),this._els.audioRows.innerHTML=""}.bind(this))},AudioPage.prototype._loadPodcastEpisodes=function(e,_){let t;const i=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getCurrentAudio()||this._readyAudio;let o={};try{o=JSON.parse(i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_EXTRA])}catch(e){}if(o&&o.externalAudio){let e=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getCurrentPlaylist();return void _(e._ref._list)}t=this.isPodcastPage()?this._ownerId:i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID],cur._podcastsEpisodes=cur._podcastsEpisodes||{},cur._podcastsEpisodes[t]=cur._podcastsEpisodes[t]||[];const s=cur._podcastsEpisodes[t];s.length&&e<s.length?_(s):ajax.post("al_podcasts.php",{act:"a_episodes",oid:t,episode_full_id:i?i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]+"_"+i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_ID]:"",offset:e,rev:this._data.reverse,claim:window.nav.objLoc.claim},{onDone:function(e){cur._podcastsEpisodes[t]=s.concat(e||[]),_(cur._podcastsEpisodes[t])},onFail:function(){return _(cur._podcastsEpisodes[t]),!0}})},AudioPage.prototype._destroyReadyAudio=function(){delete this._readyAudio},AudioPage.showAttachBox=function(e,_){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)()&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_item_list",(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)().bodyNode),"offset")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_item_list",(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)().bodyNode),"offset",0),1===vk.widget?(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showBox)("al_audio.php",{act:"choose_box",owner_id:e,options:JSON.stringify(_)}):AudioPage.editPlaylist(e,_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.DEFAULT_PLAYLIST_ID,"attach",_)},AudioPage.editPlaylist=function(e,_,t,i){if(vk.widget)for(let e in i)i.hasOwnProperty(e)&&((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isString)(i[e])?i[e]=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clean)(i[e]):(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(i[e])?delete i[e]:i[e]=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(i[e]));let o,s;if("edit"===t&&i&&(i.audioAttachSwitchOwnerId=!1),i&&i.audioAttachSwitchOwnerId&&(cur.audioAttachSwitchOwnerId=i.audioAttachSwitchOwnerId),t=t||"edit",_)o=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST,e,_);else if(cur.audioPage){const e=cur.audioPage._data.maxPlaylistsCount;if((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isArray)(cur.audioPage._data.playlists)&&cur.audioPage._data.playlists.length>=e){const _=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(e,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.curLang("audio_playlists_limit_error")).replace("{limit}",e);return void new _web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.MessageBox({title:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_error")}).content(_).setButtons("Ok",(function(){(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)().hide()})).show()}}const a=(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.showBoxLoader)();(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_22__.parallel)((e=>{window.stManager.add(["audio.css",window.jsc("web/indexer.js"),window.jsc("web/auto_list.js"),window.jsc("web/grid_sorter.js"),"edit"===t&&window.jsc("web/upload.js")],e).catch((e=>{throw i&&i.onFail&&i.onFail(e),e}))}),(e=>{o?(o.setForceReload(!0),o.loadAll(e,t)):e()}),(_=>{if(cur.audioPage&&cur.audioPage.getOwnerId()===+e&&!i?.promotedAudios&&(s=cur.audioPage.getOwnerPlaylists()),i?.promotedAudios){const e=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)();s=[],i.addAudio=[],i.promotedAudios.forEach(((t,o,s)=>{const a=e.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST,t[0],t[1]);0===a.getAudiosCount()&&void 0===a.getTotalCount()?a.load((()=>{i.addAudio.push(...a.getAudiosList()),o===s.length-1&&_()})):(i.addAudio.push(...a.getAudiosList()),o===s.length-1&&_())}))}else s?_():AudioPage.loadPlaylists(e,void 0,!1,"attach"===t,(e=>{s=e,_()}))}),(()=>{(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.isBoxLoadingCancelled)(a)||(i&&i.onDone&&i.onDone(),AudioPage._openEditPlaylist(t,e,_,s,i))}))},AudioPage.initBoxEls=function(e){return{boxContent:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_pl_edit_box",e.bodyNode),playlistNameInput:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ape_pl_input",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ape_pl_title",e.bodyNode)),playlistDescriptionInput:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ape_pl_input",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ape_pl_description",e.bodyNode)),playlistDiscoverToggle:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ape_discover_checkbox",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ape_pl_discover",e.bodyNode)),playlistUpdateIdInput:e.bodyNode.querySelector("#ape_pl_to_update_id"),playlistUpdateTimeInput:e.bodyNode.querySelector("#ape_pl_to_update_time"),playlistUpdateCutInput:e.bodyNode.querySelector("#ape_pl_to_update_cut"),playlistUpdateFilterInput:e.bodyNode.querySelector("#ape_pl_to_update_filter"),stat:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_pl_stat",e.bodyNode),uploadCoverButtonWrapper:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_cover",e.bodyNode),uploadCoverInput:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_cover_upload",e.bodyNode),errorMsg:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_error_msg",e.bodyNode),header:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_header",e.bodyNode),search:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_search",e.bodyNode),searchInput:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_field",e.bodyNode),addAudiosButton:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ape_add_audios_btn",e.bodyNode),addAudiosFromPlaylistsButton:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ape_add_pl_audios_btn",e.bodyNode),listWrap:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_list_wrap",e.bodyNode),list:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_item_list",e.bodyNode),globalResults:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_item_global_results",e.bodyNode),globalResultsList:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_item_global_list",e.bodyNode),emptyPlaceholder:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_audios_empty_list",e.bodyNode),emptyPlaylistsPlaceholder:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_audios_empty_playlists_list",e.bodyNode),emptyGlobalPlaceholder:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_audios_empty_global_list",e.bodyNode)}},AudioPage._openEditPlaylist=function(e,_,t,i,o){let s,a,l,n,r,d,u;const c=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)(),E=c.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_TEMP,_,(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.irand)(0,999999));if((0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)()){r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_item_list",(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)().bodyNode),"offset"),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.val)("ape_edit_playlist_search");const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_item_list",(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)().bodyNode);e&&(u=e.scrollTop)}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(boxLoader),(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)()||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(boxLayerWrap),cur.apLayer&&(n=cur.apLayerPlaylistId,layers.fullhide()),o=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)({audioPickerButtonText:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_add_media"),playlistPickerButtonText:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_attach_playlist_button"),canPlaylistAttach:!1,onAudioChoose:_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.onAudioChoose,onPlaylistChoose:_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.onPlaylistChoose},o),cur.onChooseAudio=o.onAudioChoose,cur.onChoosePlaylist=o.onPlaylistChoose;const h=!t||t===_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.DEFAULT_PLAYLIST_ID,P="attach"===e,p=!!o?.promotedAudios;let g,y=!1,b=!1,A=!1,D=!1,M=0,O=null,C=!0,m=!1,w=0,I=0;i=i.filter((e=>e.id!==_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.DEFAULT_PLAYLIST_ID&&e.size>0));const L=new _web_indexer_indexer__WEBPACK_IMPORTED_MODULE_21__.vkIndexer(i,(e=>e.title)),T=i.length>0;let B=!1;h&&!P||p?o.addAudio&&E.pushAudio(o.addAudio):(B=c.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST,_,t),E.pushAudio(B.getAudiosList()),E.mergeWith({title:B.getTitle(),description:B.getDescription(),rawDescription:B.getRawDescription(),coverUrl:B.getCoverUrl(),editHash:B.getEditHash(),noDiscover:B.getNoDiscover()}));const f=P?_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_choose_audio_title"):t?_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_edit_playlist_title"):_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_new_playlist_title");function v(e){if(e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)(e)){let _=" "+(e+"|")+((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.parseLatin)(e)||"")+((0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.parseCyr)(e)||"");_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)(_.replace(/\)/g,"").replace(/&/,"&amp;")),D=new RegExp("(\\s|^)("+_.replace(_web_indexer_indexer__WEBPACK_IMPORTED_MODULE_21__.vkIndexer.delimiter,"|").replace(/(^\||\|$|\?)/g,"")+")","gi")}else D=!1;H(b,"playlists"!==y,e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.emptyGlobalPlaceholder)}function R(){o.onClose&&o.onClose(),C||(E.clean(),c.deletePlaylist(E),n&&_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.showAudioPlaylist(n[0],n[1]))}function U(_){if(!m||_||"attach"===e)return!0;let i,o;return t?(i=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_edit_playlist_cancel_confirm_text"),o=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_edit_playlist_cancel_confirm_yes")):(i=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_new_playlist_remove_confirm_text"),o=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_new_playlist_remove_confirm_continue")),(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showFastBox)(_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_warning"),i,o,(()=>{C=!1,(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)().hide(),s.hide(!0)}),_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_cancel")),!1}function W(){return(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)(a.searchInput.value)}function K(_){const t=E.indexOfAudio(_)>=0?"ape_selected":"",i=_;D&&((_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clone)(i))[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_TITLE]=_[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_TITLE].replace(D,"$1<em>$2</em>"),_[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER]=_[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER].replace(D,"$1<em>$2</em>"));let s="";if("edit"===e){s=`<div class="ape_check">\n        <div class="ape_check--unchecked">${(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_57__.getIcon24CheckCircleOff)().icon}</div>\n        <div class="ape_check--checked">${(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_58__.getIcon24CheckCircleOn)().icon}</div>\n      </div>`}else{let e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(i);if(o&&o.wiki){s='<div role="button" class="ape_attach" onclick="'+`editorChooseAudio(\n        '${(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clean)(e.performer)}',\n        '${(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clean)(e.title)}',\n        ${e.duration},\n        '${e.fullId}',\n        '${e.url}',\n        ${e.duration},\n        this)`+'">'+o.audioPickerButtonText+"</div>"}else{e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clean)(JSON.stringify(e));s=`<div role="button" class="ape_attach" onclick="cur.onChooseAudio(event, this, ${e}, ${(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.clean)(JSON.stringify(i))})">${o.audioPickerButtonText}</div>`}}return'<div class="ape_audio_item_wrap _ape_audio_item '+t+'">'+s+_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.drawAudio(_)+"</div>"}function S(){clearTimeout(w);const e=W();e&&(w=setTimeout((function(){w=!1,A=c.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_SEARCH,vk.id,(0,_web_lib_utils__WEBPACK_IMPORTED_MODULE_22__.hashCode)(e+"no conflict")),A.mergeWith({searchParams:{globalQuery:e},hasMore:!0});let _=0;l&&(_=l.getOffset(),l.destroy()),l=new _web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_13__.default(a.list,{scrollNode:a.list,onNeedRows:function(e,t){t-=_,A.load(t,(function(){const _=[],i=A.getAudiosList();if(0==+t&&i.length&&_.push('<div class="ape_list_header">'+_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_edit_playlist_global_results")+"<div>"),i.length){const e=Math.min(i.length,t+20);for(let o=t;o<e;o++)i[o]&&_.push(K(i[o]))}A.getAudiosCount()||l&&l._offset?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.emptyGlobalPlaceholder),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.list)):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.emptyGlobalPlaceholder),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.list)),e(_)}))}}),l.drawMore()}),300),O=null)}function k(){s.setOptions({title:'<div class="back _back"><span class="back__icon">'+(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_59__.getIcon24ChevronLeft)().icon+"</span>"+_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_back")+"</div>",bodyStyle:"padding: 0"})}function x(){let e="";cur.audioAttachSwitchOwnerId&&cur.audioAttachOriginalOwnerId&&(e='<span class="dvd"></span><a class="tab_link" onclick="cur.audioAttachSwitch()">',e+=_shared_ranges__WEBPACK_IMPORTED_MODULE_42__.Ranges.isGroupId(E.getOwnerId())?_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_choose_wall_to_my_audios"):_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_choose_wall_to_group_audios"),E.getOwnerId()===cur.audioAttachOriginalOwnerId?cur.audioAttachSwitch=function(){AudioPage.showAttachBox(cur.audioAttachSwitchOwnerId,o)}:cur.audioAttachSwitch=function(){AudioPage.showAttachBox(cur.audioAttachOriginalOwnerId,o)},e+="</a>"),s.setOptions({title:f+e,bodyStyle:"padding: 0"})}function N(){const e=a.boxContent.getBoundingClientRect();if(e.height&&e.width){const _=a.list.getBoundingClientRect();(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(a.list,{height:e.height-(_.y-e.y)})}}function H(e,_,t){b=e,_&&b?t?b.search({q:t},(function(e){F(!0,e)})):F(!0,b.getAudiosList(),e):F(!1,t?L.search(t):i),q("initial"===y&&!t)}function F(e,_,t){a.list.innerHTML="",l&&l.destroy(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.list),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.emptyPlaceholder),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.emptyGlobalPlaceholder),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.emptyPlaylistsPlaceholder),N();let i=0;l=new _web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_13__.default(a.list,{scrollNode:a.list,onNoMore:function(){0===i&&(W()?e||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.list),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.emptyPlaylistsPlaceholder)):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.list),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.emptyPlaceholder))),p?function(){clearTimeout(I);const e=W();e&&(I=setTimeout((function(){I=!1;let _=0;l&&(_=l.getOffset(),l.destroy()),l=new _web_auto_list_auto_list__WEBPACK_IMPORTED_MODULE_13__.default(a.list,{scrollNode:a.list,onNeedRows:function(t,i){i>_?t([]):(i-=_,ajax.post("/audio?act=load_catalog_section",{section_id:o.audioSectionId,search_query:e},{onDone:function(){const e=arguments[1]?.playlist?.list||[],_=[];0==+i&&e.length&&_.push('<div class="ape_list_header">'+_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_edit_playlist_global_results")+"<div>"),e.length&&e.forEach((e=>{_.push(K(e))})),e&&e.length?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.emptyGlobalPlaceholder),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.list)):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.list),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.emptyGlobalPlaceholder)),t(_)},onFail:function(e){return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showFastBox)({title:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_error"),width:350},e),!0}}))}}),l.drawMore()}),100),O=null)}():e&&S()},onNeedRows:function(o,s){let a=r||20;const l=t&&t.hasMore()?s+a:Math.min(_.length,s+a);if(l>_.length&&t&&t.hasMore())t.load(s+a,(a=>{const n=G((_=t.getAudiosList()).slice(s,l),e);i+=n.length,o(n)}));else{const t=G(_.slice(s,l),e);i+=t.length,o(t)}},onRendered:e=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)(a.list,"offset",e),u&&r&&(a.list.scrollTop=u,r=0,u=0)}})}function G(e,_){const t=(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_60__.getIcon24Playlist)().icon,i=(0,_icons_desktop__WEBPACK_IMPORTED_MODULE_61__.getIcon24ChevronRight)().icon;return e.map((e=>{if(_)return K(e);const o='<div class="ape_pl_item_inner"><span class="ape_pl_title">'+(D?e.title.replace(D,"$1<em>$2</em>"):e.title)+'</span> <span class="ape_pl_size">'+(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(e.size,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.curLang("audio_playlist_audios_count"),!0).replace("{count}",e.size)+"</span></div>";return`<div class="ape_pl_item"\n                        data-playlist-access-hash="${e.access_hash}"\n                        data-playlist-owner-id="${e.owner_id}"\n                        data-playlist-id="${e.id}">\n                          <div class="ape_pl_item__icon_playlist">${t}</div>\n                          ${o}\n                          <div class="ape_pl_item__icon_chevron">${i}</div>\n                        </div>`}))}function q(e){g||(g=new _web_grid_sorted__WEBPACK_IMPORTED_MODULE_23__.default(a.list,"ape_audio_item_wrap",{wrapNode:a.list,onReorder:function(e,_){let t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_row",e),"full-id");const i=E.indexOfAudio(t);let o;_?(t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_row",_),"full-id"),o=E.indexOfAudio(t)):o=E.getAudiosCount(),E.moveAudio(i,o)}})),e?g.enable():g.disable()}function Y(t,l){if("default"===t&&cur.audioPage&&cur.audioPage._data.addBanned)(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showFastBox)({title:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_error")},cur.audioPage._data.addBannedText);else{switch(y=t,s.removeButtons(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(a.list,"view",t),t){case"initial":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.header),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.addAudiosFromPlaylistsButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.addAudiosButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.search),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.globalResults),H(E,!0),j(),x();break;case"default":const t=c.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST,_,_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.DEFAULT_PLAYLIST_ID);(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.disableEl)(a.addAudiosButton),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.showProgress)(a.addAudiosButton),t.load((function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.enableEl)(a.addAudiosButton),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.hideProgress)(a.addAudiosButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.header),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.search),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggle)(a.addAudiosFromPlaylistsButton,T),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.addAudiosButton),"edit"===e?k():x(),H(t,!0,d),N(),"edit"===e&&j()}));break;case"playlists":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.header),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.search),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.addAudiosFromPlaylistsButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.addAudiosButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.globalResults),k(),H(i);break;case"playlist":(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.header),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.search),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.addAudiosFromPlaylistsButton),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.addAudiosButton),k(),H(l,!0),P&&function(e){if(!o.canPlaylistAttach)return;function _(_){cur.onChoosePlaylist(_,e)}s.addButton(o.playlistPickerButtonText,_,"ok",!0)}(l),"edit"===e&&j()}N(),a.searchInput.value="",(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.elfocus)(a.searchInput),D=!1,O=null,clearTimeout(w),c&&c.updateCurrentPlaying&&c.updateCurrentPlaying()}}function j(){s.addButton(_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_save_playlist_button"),$,"ok",!0)}function V(e){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domClosest)("ape_pl_item",e.target);if(_){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(_,"playlist-id"),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(_,"playlist-owner-id"),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(_,"playlist-access-hash"),s=c.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST,i,t,o);(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.showProgress)(_),s.load((function(){(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.hideProgress)(_),Y("playlist",s)}))}if(e.target.closest(".ape_check")){function l(e,_){if(cur.audioPage&&cur.audioPage._data.addBanned)return void(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showFastBox)({title:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_error")},cur.audioPage._data.addBannedText);const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(e,"ape_selected",_),i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_row",e),o=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.getAudioFromEl(i);t?E.pushAudio(o,0):E.removeAudio(o)}const n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domClosest)("_ape_audio_item",e.target);if(e.shiftKey&&O){let r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domChildIndex)(O),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domChildIndex)(n);const u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domPN)(n);if(r>d){const p=d;d=r,r=p}const h=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hasClass)(O,"ape_selected");for(let g=r;g<=d;g++)l(u.children[g],h)}else l(n),O=n;z(),J()}if(P&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hasClass)(e.target,"artist_link")){if(e.metaKey&&_shared_lib_browser__WEBPACK_IMPORTED_MODULE_2__.browser.mac||e.ctrlKey)return;const y=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(e.target,"performer")||(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)(e.target.innerText);y&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.val)(a.searchInput,y),uiSearch.onChanged(a.searchInput),v(y))}return(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(e)}function z(){const e=E.getAudiosCount(),_=E.getTotalDuration();let t;if(e){let i;t=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(e,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.curLang("audio_edit_playlist_audios_info")),t=t.replace("{count}",e);const o=_%60,s=Math.floor(_/60)%60,a=Math.floor(_/3600);_<60?i=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(_,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.curLang("audio_total_dur_seconds")):_<3600?(i=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(s,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.curLang("audio_total_dur_minutes")),o&&(i+=" "+(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(o,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.curLang("audio_total_dur_seconds")))):(i=(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(a,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.curLang("audio_total_dur_hours")),s&&(i+=" "+(0,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.langNumeric)(s,_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.curLang("audio_total_dur_minutes")))),t+='<span class="dvd">'+i+"</span>"}else t=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_edit_playlist_no_audios");a.stat.innerHTML=t}function $(e){let t=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.val)(a.playlistNameInput));t=t.replace(/[\u200B-\u200D\uFEFF]/g,"");const i=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.val)(a.playlistDescriptionInput)),l=+(a.playlistDiscoverToggle&&a.playlistDiscoverToggle.classList.contains("on"));if(a.playlistUpdateIdInput&&(t=`${(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)(a.playlistUpdateIdInput.value)}_${a.playlistUpdateTimeInput.valueAsNumber}_${a.playlistUpdateCutInput.valueAsNumber}`),!t)return Y("initial"),void(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.notaBene)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.ge)("ape_pl_name"));const n=[];(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)(E.getAudiosList(),(function(e,_){n.push(_[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]+"_"+_[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_ID]+"_"+_[_shared_audio_enums__WEBPACK_IMPORTED_MODULE_29__.AUDIO_PLAYER_ENUMS.AUDIO_ITEM_ACCESS_KEY])}));const r=o.newPlaylistHash||cur.audioPage&&cur.audioPage._data.newPlaylistHash||"",d={hash:h?r:B.getEditHash(),owner_id:_,playlist_id:h?0:B.getPlaylistId(),title:t,description:i,Audios:n.join(","),cover:(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isObject)(M)?JSON.stringify(M):M};a.playlistUpdateIdInput&&(d.update_id=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)(a.playlistUpdateIdInput.value),d.update_time=(a.playlistUpdateTimeInput.valueAsNumber+6e4*(new Date).getTimezoneOffset())/1e3,d.update_cut=a.playlistUpdateCutInput.valueAsNumber,d.update_filter=a.playlistUpdateFilterInput.classList.contains("on")?1:0),null!==l&&(d.no_discover=l),ajax.post("al_audio.php?act=save_playlist",d,{showProgress:()=>(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.lockButton)(e),onDone:(e,t)=>{o?.onSavePlaylistDone?.();h&&!document.querySelector(".CatalogSection ._audio_page__playlists")?nav.reload():((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass)("_audio_pl_"+e.ownerId+"_"+e.id),(function(){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_pl__cover",this);if(_){AudioPage.setCoverImageElem(_,e.coverUrl,e.title);const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_pl_grid_covers_wrap",this);t&&(t.innerHTML=e.coverUrl?"":e.gridCovers)}const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_pl__title",this);if(t){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_item__title",t);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.val)(_||t,e.title)}const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_pl__stats_count",this);i&&(i.innerHTML=e.totalCount)})),h&&cur.audioPage&&_==cur.audioPage.getOwnerId()&&["all","my_playlists"].includes(cur.audioPage._currentSection)&&((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)(cur.audioPage._els.pageContainer.querySelectorAll(".CatalogBlock__my_playlists ._audio_page_block__playlists_items"),(function(){const{thumb:e,title:_}=t,i={...t,cover_image:AudioPage.getCoverImage(e,_)},o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.se)((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.getTemplate)("audio_pl_item",i));let s=this;const a=checkMyMusicCreationBlockActionEnabled();if(s.classList.contains(_web_components_ui_gallery__WEBPACK_IMPORTED_MODULE_33__.UI_GALLERY_CLASSNAME)){const e=(0,_web_components_ui_gallery__WEBPACK_IMPORTED_MODULE_33__.uiGetGallery)(s);let _=document.createElement("div");if(_.classList.add("ui_gallery_item"),_.appendChild(o),a){let t=!1;const i=e.getItems()?.at(0);i&&(t=Boolean(i.querySelector(".audio_pl_create_my_music_playlist_button"))),e.addItems([_],t?1:0)}else e.addItems([_],0)}else{let e=s.firstChild;a&&Boolean(e.querySelector(".audio_pl_create_my_music_playlist_button"))&&(e=s.firstChild.nextSibling),s.insertBefore(o,e);const _=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(s,"max-items"));_&&s.children.length>_&&s.removeChild(s.lastChild)}(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.gpeByClass)("_audio_page__playlists",s))})),cur.audioPage._data.playlists=cur.audioPage._data.playlists||[],cur.audioPage._data.playlists.unshift(t)),h&&cur.audioPage&&cur.audioPage.catalogController.updateSectionReorder(),cur.audioPage&&cur.audioPage.updatePlaylistsCounter&&cur.audioPage.updatePlaylistsCounter(_),B&&(B.clean(),B.mergeWith(e)),s.hide(!0),(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isFunction)(o.onPlaylistSave)&&o.onPlaylistSave(B))},onFail:()=>(s.hide(!0),!0)})}function Q(e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.coverThumb),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(a.coverThumb,"background-image","url("+e+")"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(a.uploadCoverButtonWrapper,"ape_thumb_set"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.uploadCoverButton)}function X(e){return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(a.uploadCoverButtonWrapper,"ape_thumb_set"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_cover_thumb")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.uploadCoverButton),M=-1,(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(e)}function J(){m=!0}(2===vk.widget||3===vk.widget)&&window.box&&(!boxQueue.count()&&!(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)()||cur.audioChooseBox===(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)())?(s=window.box,s.setOptions({title:f,bodyStyle:"padding: 0",width:560,onBeforeHide:R,onHideAttempt:U,hideButtons:!0})):(cur.audioChooseBox&&cur.audioChooseBox===(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)()&&(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)().hide(),s=new _web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.MessageBox({title:f,bodyStyle:"padding: 0",width:560,onBeforeHide:R,onHideAttempt:U})),cur.audioChooseBox=s,s.content((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.getTemplate)("audio_edit_playlist")),s.show(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)(s,"ownerId",_),a=AudioPage.initBoxEls(s),function(){const t=window.innerHeight;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(a.boxContent,"height",Math.min(800,Math.max(t-200,500))),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(a.addAudiosFromPlaylistsButton,"click",Y.bind(this,"playlists")),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(a.addAudiosButton,"click",Y.bind(this,"default")),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(a.list,"click",V),P&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(a.list,"audio-context","attach");(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(s.titleWrap,"click",(function(e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hasClass)(e.target,"_back")&&function(){switch(y){case"initial":break;case"default":Y("initial");break;case"playlists":Y("default");break;case"playlist":Y("playlists")}}()})),uiSearch.init("ape_edit_playlist_search",{onChange:v}),"edit"===e&&(Y("initial"),z(),function(){if(!cur.audioCoverUploadOptions||!cur.audioCoverUploadOptions[_])return;const e=cur.audioCoverUploadOptions[_],t={file_name:"photo",file_size_limit:5242880,file_types_description:"Image files (*.jpg, *.jpeg, *.png, *.gif)",file_types:"*.jpg;*.JPG;*.jpeg;*.JPEG;*.png;*.PNG;*.gif;*.GIF;*.bmp;*.BMP",onUploadStart:function(e,_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_cover_progress"))},onUploadComplete:function(e,_){(_=JSON.parse(_)).error?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.show)(a.errorMsg),N()):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)(a.errorMsg),M=_,Q(M.url),J(),N()),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_cover_progress"))},onUploadProgress:function(e,_,t){},onUploadError:function(e,_){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hide)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_cover_progress"))},clear:1,type:"photo",max_attempts:3,server:e.server,noCheck:!0,chooseBox:!0,uploadButton:!0,accept:".jpg,.jpeg,.png",filesize_hide_last:!0,label:e.button};function i(){(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.isObject)(M)&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.isVisible)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_cover_progress"))||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByTag1)("input",a.uploadCoverButtonWrapper).click()}Upload.init(a.uploadCoverButtonWrapper,e.url,e.vars,t),a.uploadCoverButton=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ape_cover_accessibility_upload_btn",s.bodyNode),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_cover_delete"),"click",X),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(a.uploadCoverButton,"click",(()=>i())),a.coverThumb=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_ape_cover_thumb")}(),E.getCoverUrl()&&Q(E.getCoverUrl()),(0,_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_5__.autosizeSetup)(a.playlistDescriptionInput,{minHeight:30,maxHeight:150,onResize:N}),a.playlistNameInput.value=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.replaceEntities)(E.getTitle()),a.playlistDescriptionInput.value=(0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.replaceEntities)(E.getRawDescription().replace(/<br>/g,"\n")),a.playlistDiscoverToggle&&a.playlistDiscoverToggle.classList.toggle("on",E.getNoDiscover()),a.playlistNameInput.addEventListener("input",J),a.playlistDescriptionInput.addEventListener("input",J),a.playlistDiscoverToggle&&a.playlistDiscoverToggle.addEventListener("click",J),a.playlistUpdateIdInput&&cur.editorialPlaylistsParams&&(a.playlistUpdateIdInput.value=cur.editorialPlaylistsParams.target_playlist,a.playlistUpdateTimeInput.valueAsNumber=1e3*cur.editorialPlaylistsParams.update_time-6e4*(new Date).getTimezoneOffset(),a.playlistUpdateCutInput.valueAsNumber=cur.editorialPlaylistsParams.update_cut,a.playlistUpdateFilterInput.classList.toggle("on",1===cur.editorialPlaylistsParams.update_filter),a.playlistUpdateFilterInput.setAttribute("aria-checked",1===cur.editorialPlaylistsParams.update_filter),a.playlistUpdateIdInput.addEventListener("input",J),a.playlistUpdateTimeInput.addEventListener("input",J),a.playlistUpdateCutInput.addEventListener("input",J),a.playlistUpdateFilterInput.addEventListener("click",J)));p?Y("playlist",E):P&&Y("default");x(),B&&"attach"!==e&&s.setControlsText(`<a onclick="AudioPage.deletePlaylist(${B.getOwnerId()}, ${B.getPlaylistId()}, '${B.getEditHash()}')">\n                              ${_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_delete_playlist")}\n                            </a>`)}(s.bodyNode),d&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.val)(a.searchInput,d),S()},AudioPage.prototype._deinitKeyEvents=function(){this._audioHQKeyEventHandler1&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window.document,"keydown",this._audioHQKeyEventHandler1),this._audioHQKeyEventHandler2&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window.document,"keyup",this._audioHQKeyEventHandler2),this._audioHQKeyEventHandler3&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window.document,"visibilitychange",this._audioHQKeyEventHandler3),this._audioHQKeyEventHandler4&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window.document,"mousedown",this._audioHQKeyEventHandler4),this._audioSeekKeyEventHandler&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window.document,"keydown",this._audioSeekKeyEventHandler)},AudioPage.prototype._initKeyEvents=function(){this._deinitKeyEvents();const e=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)(),_=()=>!this.isLayer()&&_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.getLayer().isShown();(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(window.document,"mousedown",this._audioHQKeyEventHandler4=function(e){e.ctrlKey&&(cur.ctrlMouseDown=!0,cur.ctrlPressed=!1)},!0),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(window.document,"keydown",this._audioHQKeyEventHandler1=function(e){_()||(cur.ctrlPressed=e.keyCode===_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.KEY.CTRL)}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(window.document,"keyup",this._audioHQKeyEventHandler2=function(e){_()||(e.keyCode!==_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.KEY.CTRL||cur.ctrlMouseDown)&&(delete cur.ctrlMouseDown,delete cur.ctrlPressed)}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(window.document,"keydown",this._audioSeekKeyEventHandler=function(t){const i=t.target,o=i&&(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.inArray)(i.tagName.toLowerCase(),["input","textarea"])&&""!==(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.val)(i),s=i&&i.isContentEditable,a=cur&&cur.pvShown;o||s||a||_()||!e.isPlaying()||!(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.inArray)(t.keyCode,[_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.KEY.RIGHT,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.KEY.LEFT])||cur.wallLayer||t.ctrlKey||e.seekCurrentAudio(t.keyCode===_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.KEY.RIGHT)}),cur.destroy.push((()=>this._deinitKeyEvents()))},AudioPage.prototype._initMusicPlaylistDeletionEvents=function(){const e=(0,_web_di__WEBPACK_IMPORTED_MODULE_0__.ensureDIRootWebContainer)().resolve(_vkontakte_internal_domains__WEBPACK_IMPORTED_MODULE_62__.MusicPlaylistProvider),_=({target:e})=>{AudioPage.onMusicPlaylistDelete(e.identity.ownerId,e.identity.id),AudioPage.onMusicPlaylistDeleted()};e.events.on("deleted",_),cur.destroy.push((()=>{e.events.off("deleted",_)}))},AudioPage.prototype.editFeed=function(){const e=this;(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showTabbedBox)("al_settings.php",{act:"a_edit_owners_list",list:"audio",height:lastWindowHeight},{stat:[window.jsc("web/privacy.js"),"privacy.css","ui_controls.js","ui_controls.css",window.jsc("web/indexer.js")]}),cur.onOListSave=function(_,t,i,o){const s=(0,_web_lib_box_utils__WEBPACK_IMPORTED_MODULE_6__.curBox)(),a={act:"a_ignore_olist",hash:o.hash};return _.length<t.length?a.White=_.join(","):a.Black=t.join(","),ajax.post("al_audio.php",a,{onDone:function(){s.hide();e.getCurrentPlaylist().clean(),e.refreshCurrentPage()},onFail:()=>!0,showProgress:s.showProgress,hiderogress:s.hideProgress}),!1}},AudioPage.prototype.updateStatusExportControls=function(e){const _=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)(),t=_.getStatusExportInfo();(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass)("_audio_export_status",this._els.pageContainer),(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(this,"on",t&&!!t[(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(this,"oid")])}));const i=_.hasStatusExport(),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_player_status",this._els.pageContainer);if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(o,"audio_page_player_btn_enabled",i),!e)if(this.isLayer())cur.audioPage&&cur.audioPage.updateStatusExportControls(!0);else{const e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.getLayer().getPageInstance();e&&e.updateStatusExportControls(!0)}return!1},AudioPage.prototype.updateStatusExport=function(e,_){e&&(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.checkbox)(e),_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(_);const t=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)(),i=t.getStatusExportInfo()||{};let o,s,a;if(_)i[_]?(delete i[_],o=!1):(i[_]=1,o=!0);else if(t.hasStatusExport()){for(let e in i)i.hasOwnProperty(e)&&delete i[e];o=!1}else i[_=vk.id]=1,o=!0;t.setStatusExportInfo(i),_!=vk.id&&_||(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.checkbox)("currinfo_audio",t.hasStatusExport()),this.updateStatusExportControls();const l=t.getCurrentAudio();l&&(s=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(l).fullId,a=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(l).accessKey);const n=null;t.stats.sendCurrentAudioEvent({type:_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_11__.TYPE_BROADCASTING,subtype:o?_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_11__.SUBTYPE_ON:_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_11__.SUBTYPE_OFF,targetOwnerId:_}),ajax.post("al_audio.php?act=toggle_status",{exp:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(o),oid:_,hash:vk.statusExportHash,id:s,top:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(n),access_key:a},{onFail:()=>!0})},AudioPage.prototype.playStatusAudio=function(e,_,t){const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.gpeByClass)("_audio_friend",t);(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().playLive(e,{showProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.showProgress.pbind(i),hideProgress:_web_lib_ui__WEBPACK_IMPORTED_MODULE_24__.hideProgress.pbind(i)}),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(_)},AudioPage.showActionTooltip=function(e,_){const t=[3,-8,0],i=currentAudioPage(e),o=i&&i.isLayer();(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hasClass)(e,"_audio_page_player_add")?(0,_web_lib_feature_tooltips__WEBPACK_IMPORTED_MODULE_26__.audioShowActionTooltip)(e,t,o):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hasClass)(e,"_audio_page_player_play_rate")&&(t[0]=-17),(0,_web_lib_tooltip_utils__WEBPACK_IMPORTED_MODULE_27__.showTooltip)(e,{text:_,black:1,shift:t,appendParentCls:"_audio_page_player",forcetodown:o,needLeft:o}))},AudioPage.prototype.onHide=function(){const e=this;cur.nav=cur.nav.filter((function(_){return e._nav_func!=_})),this._deinitKeyEvents()},AudioPage.prototype.showRecoms=function(e,_){if(!_){const e=this._readyAudio?this._readyAudio:(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getCurrentAudio();if(!e)return;_=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(e).fullId}(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_4__.statlogsValueEvent)("audio_recoms_by_track_button_click",!0),nav.go({0:"audio",section:"recoms_audio",audio_id:_},null,{nocur:!0})},AudioPage.prototype.onAudioUploaded=function(e,_){if(!_)return;const t=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)(),i=t.getPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_PLAYLIST,this.getOwnerId(),_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.DEFAULT_PLAYLIST_ID);i.pushAudio(_);const o=t.getCurrentPlaylist();o&&o.getSelf()==i&&o.pushAudio(_),"all"!==this._currentSection&&this.resetSection("all");let s=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(_);(0,_web_audio_player_stat_onAdditionalEvent__WEBPACK_IMPORTED_MODULE_12__.onAdditionalEvent)(null,s,{type:_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_11__.TYPE_ADDED,subtype:_shared_audio_AudioStats__WEBPACK_IMPORTED_MODULE_11__.SUBTYPE_UPLOAD,context:"on_audio_uploaded",playlistId:i.getOwnerId()+"_"+i.getPlaylistId()});let a=5;const l=this;!function e(t){--a<0||setTimeout((function(){ajax.post("al_audio.php?act=check_audio_data",{audio_owner_id:s.ownerId,audio_id:s.id},{onDone:function(i){if(!i)return;let o=i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_TITLE]!=_[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_TITLE];o=o||i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER]!=_[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_PERFORMER],o=o||i[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_FLAGS]!=_[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_FLAGS],o&&((0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().updateAudio(s.fullId,i),"all"===l._currentSection&&"audio"===cur.module&&l._initAudioRowsAutoList(),s=i),e(1.5*t)},onFail:()=>!0})}),t)}(1e3)},AudioPage.prototype.onAudioAllUploaded=function(){"all"===this._currentSection&&nav.reload()},AudioPage.prototype.uploadAudio=function(e){this._data.uploadBanned?(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showFastBox)({title:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_error")},this._data.uploadBannedText):(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showBox)("al_audio.php",(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)(e||{},{act:"new_audio",gid:_shared_ranges__WEBPACK_IMPORTED_MODULE_42__.Ranges.isGroupId(this.getOwnerId())?-this.getOwnerId():0}),{params:{width:"450px",bodyStyle:"padding: 0px; position: relative;"}})},AudioPage.prototype.editAudio=function(e,_,t){return(0,_web_lib_message_box__WEBPACK_IMPORTED_MODULE_20__.showBox)("al_audio.php",{act:"edit_audio_box",aid:_},{params:{width:"456px",bodyStyle:"padding: 20px; background-color: #F7F7F7;",hideButtons:1}}),t&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.cancelEvent)(t),!1},AudioPage.prototype.restoreRecommendation=function(e){const _=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.getAudioFromEl(e,!0),t={act:"restore_recommendation",hash:(0,_shared_audio_utils_getAudioExtra__WEBPACK_IMPORTED_MODULE_36__.getAudioExtra)(_).recom.hash,audio_id:_.fullId};nav.objLoc.audio_id&&(t.recommendation_type="query"),nav.objLoc.album_id&&(t.recommendation_type="album"),ajax.post("al_audio.php",t,{onFail:()=>!0}),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(e,"audio_row__deleted");const i=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.getAddRestoreInfo(),o=i[_.fullId].removedCurrentPos,s=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getCurrentPlaylist(),a=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getPlaylistQueue();o>=0&&s&&s.getType()==_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_RECOM&&a.addAudio(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.getAudioFromEl(e),o),delete i[_.fullId],_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.onRowOver(e,!1,!0)},AudioPage.isInRecentPlayed=function(e){const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.gpeByClass)("_audio_playlist",e);return!(!_||!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hasClass)(_,"audio_recent_rows"))&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)(_,"playlist")},AudioPage.prototype.chooseFromMyAudios=function(e){let _=!1;AudioPage.editPlaylist(vk.id,_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.DEFAULT_PLAYLIST_ID,"attach",{audioPickerButtonText:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_add"),playlistPickerButtonText:_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_add"),onClose:()=>{_&&nav.reload()},onAudioChoose:(t,i,o)=>{const s=t.ctrlKey||t.metaKey;if(ajax.post("al_audio.php?act=add",{group_id:e,audio_owner_id:o.ownerId,audio_id:o.id,hash:o.addHash},{onDone:e=>{e&&(_=!0)},onFail:()=>!0}),s)i.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_choose_added"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(i,"ape_added");else{_=!0;const e=window.__bq;if(e)for(;e.count();)e.hideLast()}}})},AudioPage.prototype.updateShuffleButton=function(){const e=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getPlaylistQueue().shuffled;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_player_shuffle",this._els.pageContainer),"audio_page_player_btn_enabled",e),this.isLayer()&&cur.audioPage&&cur.audioPage.updateShuffleButton()},AudioPage.prototype.loadMarketItemsCarousel=function(){try{Boolean(document.querySelector(".EcommAudioMarketItemsCarousel__root"))&&(0,_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_34__.asyncImportLoader)((()=>__webpack_require__.e(82915).then(__webpack_require__.bind(__webpack_require__,713600))),3)}catch(e){}},AudioPage.prototype.updatePlayerClass=function(e){const _=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("audio_player_redesign_web_enabled")||(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("redesign_audio_player_tooltip_dislikes_web_enabled"),t=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isPodcast(e),i=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isRadio(e),o=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isArticleTts(e),s=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isMarusiaTale(e),a=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isMarusiaTrack(e);if(_||((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(this._els.player,"audio_player_podcast",t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(this._els.player,"audio_player_radio_station",i),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(this._els.player,"audio_player_article_tts",o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(this._els.player,"audio_player_radio_marusia",i&&a),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(this._els.player,"audio_player_external_stream_audio",i||o||s),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(this._els.player,"audio_player_marusia_tale",s),this._updatePlaybackRate()),!this.isPodcastPage()){this.isLayer()&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_tab__current",this._els.pageContainer),"unshown",t||!(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getCurrentPlaylist());const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_tab__podcast",this._els.pageContainer);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggle)(_,t),_&&t&&(e=e||(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getCurrentAudio(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.attr)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("ui_tab",_),"href","podcasts"+e[_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.AUDIO_ITEM_INDEX_OWNER_ID]))}},AudioPage.prototype.updateRadioFollowBtn=function(){const e=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getCurrentAudio(),_=this._els.player.querySelector(".audio_page_player_follow_radiostation");_&&(_.classList.toggle(AudioPage.followedRadioClassName,(0,_shared_audio_utils_getAudioExtra__WEBPACK_IMPORTED_MODULE_36__.getAudioExtra)(e)?.fave??!1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggle)(_,(0,_shared_audio_utils_isRadio__WEBPACK_IMPORTED_MODULE_35__.isRadio)(e)&&!_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isMarusiaTrack(e)))},AudioPage.prototype.updateFaveButton=function(){const e=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getCurrentFaveStatus(),_=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_fave",this._els.player);_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(_,"activated",e)},AudioPage.prototype.toggleRepeat=function(){if(this.isPodcastPage())return;const e=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)();e.isRepeatAll()||e.isRepeatCurrentAudio()?e.toggleRepeatCurrentAudio():e.toggleRepeatAll(),this.updateRepeatButton()},AudioPage.prototype.updateRepeatButton=function(){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass)("_audio_page_player_repeat");if(e&&e.length){const _=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)(),t=_.isRepeatAll(),i=_.isRepeatCurrentAudio();(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.each)(e,((e,_)=>{_.ariaLabel=_.ariaLabel&&AudioPage.getRepeatButtonText(),_.onmouseover=_.onmouseover&&AudioPage.showActionTooltip.bind(void 0,_,AudioPage.getRepeatButtonText),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(_,"audio_page_player_btn_enabled",t),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(_,"audio_page_player_btn_repeat_one",i)}))}},AudioPage.getRepeatButtonText=function(){const e=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)(),_=e.isRepeatAll(),t=e.isRepeatCurrentAudio();let i=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_repeat_tooltip");return _?i=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_repeat_track_tooltip"):t&&(i=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("audio_dont_repeat_tooltip")),i},AudioPage.prototype.toggleShuffle=function(e){if(this.isPodcastPage())return;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(e,"audio_page_player_btn_enabled")&&(0,_shared_lib_statlogs__WEBPACK_IMPORTED_MODULE_4__.statlogsValueEvent)("audio_sort_stat","audio_sort","shuffle_player",this.isLayer()?"layer":"page");const _=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getPlaylistQueue();if(_.isEmpty())return;let t=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getCurrentAudio();const i=()=>{_.shuffled?_.resetShuffle():_.shuffle(!0),"current"===this._currentSection&&this._initAudioRowsAutoList(!0),(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().playByButton(t),this.updateShuffleButton()};t?i():_.getAudioAt(0).then((e=>{t=e,i()}))},AudioPage.prototype.toggleFave=function(e){const _=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getCurrentAudio()||this._readyAudio;_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isPodcast(_)&&AudioPlayer.podcastToggleFave(e,_)},AudioPage.prototype.changePlaybackRate=function(e,_){const t=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getCurrentAudio()||this._readyAudio;(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isPodcast(t)||_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isArticleTts(t))&&((0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().podcastChangePlaybackRate(!!_.shiftKey),this._updatePlaybackRate())},AudioPage.prototype._updatePlaybackRate=function(){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_play_rate",this._els.player);e&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.val)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_icon",e),AudioPlayer.podcastGetPlaybackRate()+"x")},AudioPage.prototype._getCurrentSearchParams=function(){const e=window.radioBtns["audio_search_type_"+(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(this.isLayer())],_=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(this._searchSortFilter.selectedItems()[0][0]);return{performer:e&&e.val?1:null,lyrics:(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_fltr_with_lyrics",this._container),"on")?1:null,sort:_?1:null}},AudioPage.searchAudios=function(e,_,t,i,o){currentAudioPage(this).searchAudios(e,_,t,i,o)},AudioPage.prototype.searchAudios=function(e,_,t,i,o){this.lastQuery!==e&&(this.lastQuery=e,this._muteSearch?delete this._muteSearch:(e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)(e),nav.change((0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.extend)(this._getCurrentSearchParams(),{q:e||null}),!1,{fromSearch:!0,globalQuery:e,fromHistory:t,isLayer:this.isLayer(),fetchedQuery:i,fromSuggestsAcceptId:o})))},AudioPage.prototype.onUserAction=function(e,_){const t=_.indexOfAudio(e);if(-1!=+t&&_.getType()===_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_SEARCH){if(!(_.getOwnerId()===vk.id&&t>=0&&t<_.getLocalFoundCount())&&_.getSearchParams()){const t=_.getSearchParams();t.globalQuery&&uiSearch.saveHistorySearch(this.searchInputEl,t.globalQuery,e.ownerId,e.id,_.getTotalCount(),_.getTotalCountHash())}}},AudioPage.prototype._updateFriendsList=function(e,_,t){if(e=(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.trim)(e),this._friendSearchInProgress=!1,!e)return;const i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_friends_list",this._els.pageContainer),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.se)('<div class="audio_friends_list _audio_friends_list" style="">'+e+"</div>");t&&(this._shownFriends=[]),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domPN)(i).appendChild(o),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.re)(i)},AudioPage.prototype.shareAudio=function(){const e=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getCurrentAudio()||this._readyAudio;e&&_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.shareAudio(!1,e)},AudioPage.prototype.showStatusTooltip=function(e){this.statusTT||(this.statusTT=!0,ajax.post("al_audio.php?act=status_tt",{},{onDone:(_,t)=>{this.statusTT=new ElementTooltip(e,{content:t,width:250,offset:[1,14],elClassWhenShown:"audio_status_tt_shown",id:"audio_status_tt",onFirstTimeShow:function(e){this.sb=new _web_legacy_ui_ui_scroll__WEBPACK_IMPORTED_MODULE_16__.default((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_status_wrap",e),{global:!0})},onShow:function(){setTimeout(function(){this.statusTT.sb.update()}.bind(this),0)}.bind(this)}),cur._onStatusExportBtn&&(this.statusTT.show(),this.statusTT.sb.update())},onFail:()=>!0}))},AudioPage.prototype.isLayer=function(){return this._data.isLayer},AudioPage.prototype.isPodcastPage=function(){return!this.isLayer()&&!!this._data.podcastPage},AudioPage.prototype.destroy=function(){this._trackSlider&&this._trackSlider.destroy(),this._volumeSlider&&this._volumeSlider.destroy(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window,"scroll",this._ev_onScroll)},AudioPage.prototype.getPageCurrentPlaylist=function(){return this._pagePlaylist},AudioPage.prototype.clearCurrentPlaylist=function(){const e=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("audio_player_redesign_web_enabled")||(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("redesign_audio_player_tooltip_dislikes_web_enabled");if(!this.isLayer())return;const _=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)();_?.notify(_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PLAYLIST_CLEAR_REQUESTED),_.deleteCurrentPlaylist(),this.updateCurrentPlayingInfo();const t=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)().getPlaylistQueue();t.clean();const i=t.autoplayQueue;i&&(i.clean(),this._destroyAutoplayBlock());const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_tab__current",this._els.pageContainer);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(o,"unshown"),"current"===this.getCurrentSection()&&(uiTabs.goTab((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domFC)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_section_tab__all",this._els.pageContainer)),null,!0),this.updateShuffleButton(),this.updateCurrentPlayingInfo(),this.updatePlayerClass(null)),this._initPlayer(!0);const s=_.getPlaylistsByType(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_MY).find((e=>e.getAudiosList().length)),a=s&&s.getAudiosList()[0];if(a&&(this._readyAudio=a,this._initPlayer(!0)),cur.audioPage){cur.audioPage._readyAudio=a,cur.audioPage._initPlayer(!0);try{const e=cur.audioPage._data.sectionData[cur.audioPage._currentSection].title;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setDocumentTitle)(e)}catch(e){}}e||this.updateStatusExport(),this.updateLayerHeight(),this._scroll.scrollTop(),_.notify(_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PLAYLIST_CLEARED)},AudioPage.prototype.setTooltipTitle=function(e){if(e.titleSet)return;const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_title_performer",e),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_title_song",e);(_.scrollWidth>_.clientWidth||t.scrollWidth>t.clientWidth)&&e.setAttribute("title",e.innerText),e.titleSet=!0},AudioPage.prototype._initPlayer=function(e){const _=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("audio_player_redesign_web_enabled")||(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("redesign_audio_player_tooltip_dislikes_web_enabled"),t=this;if(_)return t._initPlayerRedesign();const i=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)(),o=this._els.pageContainer,s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_player",o),a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_title",s),l=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_title_performer",s),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_title_song",s),r=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_title_song_title",s),d=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_title_song_subtitle",s),u=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_duration",s),c=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_player__cover",s),E=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_player_play",s),h=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_play_blind_label",E),P=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_btn_lyrics",s),p=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("_audio_page_player_add",s),g=s.querySelector(".audio_page_player_follow_radiostation");let y;function b(e){if(l)if(i.ads.isActive)r.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_audio_ad"),r.appendChild(makeAudioAdPerformerDivider()),r.appendChild(makeAudioDisableAdsLink()),l.innerHTML="",l.appendChild(makeAudioAdMoreLink()),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(s,"audio_song_is_explicit",!1);else{_web_audio_ui_AudioAdActionsModal_AudioAdActionsModalController__WEBPACK_IMPORTED_MODULE_41__.AudioAdActionsModalController.ensure().close();const _=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.getAudioPerformers(e);e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(n,"display","block"),l.innerHTML=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player2")?_:e.performer,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isPodcast(e)?r.innerHTML=`<a href="/podcast${e.fullId}" onclick="return showPodcast(this, '${e.fullId}', event, 'player');" class="audio_player_podcast_title">${e.title}</a>`:r.innerHTML=e.hasTrackPage?`<a class="audio_page_player_title_link" href="/audio${e.trackPageId}">${e.title}</a>`:e.title,d.innerHTML=e.subTitle?e.subTitle:"";let o=null;(e.coverUrl_p||(0,_shared_audio_utils_isRadio__WEBPACK_IMPORTED_MODULE_35__.isRadio)(e))&&(o=e.coverUrl_p),o?((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(c,"background-image","url("+o+")"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(c,"background-size","cover")):((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(c,"background-image",null),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(c,"background-size","")),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(s,"audio_title_long_performer",e.isLongPerformer),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(s,"audio_song_is_explicit",e.isExplicit);const a=(0,_shared_audioplayer_AudioPlayerAdapter_audioTuple_audioTupleToAudioObject__WEBPACK_IMPORTED_MODULE_39__.audioTupleToAudioObject)(i.getCurrentAudio());if(!t.isLayer()&&i.getCurrentAudio()&&a.fullId===e.fullId){const _=[e.performer,e.title].filter((e=>!!e)).join(" — ");(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setDocumentTitle)((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.replaceEntities)((0,_shared_lib_common__WEBPACK_IMPORTED_MODULE_15__.stripHTML)(_))),clearTimeout(window.pageSetTitleTimer)}n&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(n,"display","none"),l&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(l,"display","none"),requestAnimationFrame((()=>{const e=i.ads.isActive?"none":"block";n&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(n,"display",e),l&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(l,"display","block")}))}}function A(e,_){return(0,_shared_audio_formatters_formatAudioTime__WEBPACK_IMPORTED_MODULE_63__.formatAudioTime)({duration:(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.intval)(_),progress:e,negative:AudioPlayer.getDurationType()})}function D(){if(!t._trackSlider)return;const e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(i.getCurrentAudio()||t._readyAudio);if(!e)return;let _;P&&(P.disabled=!e.hasLyrics),_=_shared_ranges__WEBPACK_IMPORTED_MODULE_42__.Ranges.isGroupId(t.getOwnerId())&&t.canAddToGroup()?e.ownerId!=t.getOwnerId():e.ownerId!=vk.id,y!==_&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggle)(p,_),y=_);const o=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.getAddRestoreInfo();e&&o[e.fullId]&&"added"===o[e.fullId].state||e.ownerId===vk.id?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(p,"audio_player_btn_added"):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(p,"audio_player_btn_added"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(p,"no_transition"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClassDelayed)(p,"no_transition"),t.updateRepeatButton()}if(!this._trackSlider){const e=i.ads?.isActive?i.ads.getCurrentProgress():i.getCurrentProgress(),_=i.ads?.isActive?0:i.getCurrentBuffered(),t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_track_slider",s),o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_page_player_volume_slider",s);t&&(this._trackSlider=new _web_legacy_ui_slider__WEBPACK_IMPORTED_MODULE_17__.default(t,{value:e,backValue:_,size:1,hintClass:"audio_player_hint",withBackLine:!0,formatHint:e=>{let _=i.getCurrentAudio()||this._readyAudio;return _=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(_),(0,_shared_lib_date__WEBPACK_IMPORTED_MODULE_64__.formatTime)(Math.round(e*(_?_.duration:0)))},onEndDragging:e=>{let _=i.getCurrentAudio()||this._readyAudio;_=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(_),_&&_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isPodcast(_)&&i.podcastSetActionRef(_,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.PodcastsLogs.ACTION_SEEK,"",s),i.seekBySlider(e)}}),i.ads.isActive&&(this._trackSlider.toggleAdState(!0),this.playerToggleAdsPlaying(!0))),o&&(this._volumeSlider=new _web_legacy_ui_slider__WEBPACK_IMPORTED_MODULE_17__.default(o,{value:i.getVolume(),size:1,hintClass:"audio_player_hint",log:!0,formatHint:e=>Math.round(100*e)+"%",onChange:e=>{i.setVolume(e)}})),[_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.MUSIC_AUDIOS_ADD,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.MUSIC_PLAYLISTS_ADD,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.MUSIC_OWNERS_FOLLOW,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.MUSIC_OWNERS_UNFOLLOW,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.CURATOR_FOLLOW,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.CURATOR_UNFOLLOW,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PLACEHOLDER_REMOVE].forEach((e=>i.on(this,e,((_,t)=>{this.catalogController&&this.catalogController.emitEvent(e,t)})))),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.MUSIC_PLAYLISTS_ADD,((e,_)=>{const{playlists:t,playlistsIndex:i}=this._data;Array.isArray(t)&&t.find((e=>e.id===_.id&&e.owner_id===_.owner_id))||(t&&(t.unshift(_),i&&i.add(_)),this.updatePlaylistsCounter(vk.id))})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.AD_STARTED,((e,_)=>{this.playerToggleAdsPlaying(!0),this._trackSlider&&(this._trackSlider.toggleAdState(!0),this._trackSlider.setBackValue(0))})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.AD_COMPLETED,(()=>{this.playerToggleAdsPlaying(!1),this._trackSlider&&this._trackSlider.toggleAdState(!1)})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.START_LOADING,(()=>{this._trackSlider&&this._trackSlider.toggleLoading(!0)})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.CAN_PLAY,(()=>{this._trackSlider&&this._trackSlider.toggleLoading(!1)})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.RADIOSTATION_FOLLOW,((e,_)=>{const t=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(e);(0,_shared_audio_utils_isRadio__WEBPACK_IMPORTED_MODULE_35__.isRadio)(t)&&t.id===_&&g.classList.add(AudioPage.followedRadioClassName);const i=this._els.pageContainer.querySelectorAll(`.AudioRadiostationItem[data-id='${_}']`);Array.from(i).forEach((e=>{e.classList.add("AudioRadiostationItem--followed")}))})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.RADIOSTATION_UNFOLLOW,((e,_)=>{const t=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(e);(0,_shared_audio_utils_isRadio__WEBPACK_IMPORTED_MODULE_35__.isRadio)(t)&&t.id===_&&g.classList.remove(AudioPage.followedRadioClassName);const i=this._els.pageContainer.querySelectorAll(`.AudioRadiostationItem[data-id='${_}']`);Array.from(i).forEach((e=>{e.classList.remove("AudioRadiostationItem--followed")}))})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.ADDED,((e,_)=>{(e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(e))&&e.fullId==_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(p,"audio_player_btn_added")})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.REMOVED,((e,_)=>{(e=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(e))&&e.fullId==_&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(p,"audio_player_btn_added")})),i.on(this,[_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PLAY,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PLAY_REQUESTED],((e,_,t)=>{this._destroyReadyAudio(),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)(s,"audio",e),D(),e&&b(e),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(E,"audio_playing"),_&&!cur.audioStartReadyAudio&&(this._trackSlider&&this._trackSlider.setBackValue(0),!i.ads.isActive&&u&&(u.innerHTML=A(0,e?_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(e).duration:0)),a&&(a.setAttribute("title",""),a.titleSet=!1)),h&&(h.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_audio_play")),this.updateCurrentPlayingInfo(),this.updateShuffleButton(),this.updateFaveButton(),this.updateRadioFollowBtn()})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PAUSE,(()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(E,"audio_playing"),h&&(h.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_audio_play"))})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.STOP,(()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(E,"audio_playing"),h&&(h.innerHTML=_web_lib_lang__WEBPACK_IMPORTED_MODULE_25__.getLang("global_audio_play"))})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.BUFFERED,((e,_)=>{this._trackSlider&&this._trackSlider.setBackValue(_)})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.VOLUME,((e,_)=>{this._volumeSlider&&this._volumeSlider.setValue(_,!0)})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.ENDED,(()=>{this._trackSlider&&this._trackSlider.toggleLoading(!1)})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.UPDATE,((e,_)=>{e&&(e&&b(e),this.updatePlayerClass(e),this.updateRadioFollowBtn()),i.ads.isActive||e&&_&&u&&(u.innerHTML=A(_,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(e).duration))})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PROGRESS,((e,_,t)=>{this._trackSlider&&(this._trackSlider.toggleLoading(!1),this._trackSlider.setValue(_)),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_30__.isUndefined)(t)||isNaN(t)||!u||(u.innerHTML=A(_,t))})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.FAILED,(()=>{this._trackSlider&&this._trackSlider.toggleLoading(!1)})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.CURRENT_CHANGED,(()=>{const e=i.getCurrentAudio()||this._readyAudio;(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(this._els.player,"audio",JSON.stringify(e)),b(e),this.updatePlayerClass(e),this._trackSlider&&this._trackSlider.setValue(0)})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PLAY,(()=>{for(let e of this._playlistLoadingProvider().getSet()){const _=this._getPlaylistByQuerySelector(e);_&&_.classList.remove("audio_pl__loading")}this._playlistLoadingProvider().resetSet()})),i.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PLAYLIST_START_LOADING,((e,_,t)=>{const i=`${_}_${t}`,o=`${window.vk.id}_${t}`;this._getPlaylistByQuerySelector(i)?this._markLoadingPlaylist(i):this._getPlaylistByQuerySelector(o)&&this._markLoadingPlaylist(o)}))}const M=i.getCurrentAudio()||this._readyAudio;M&&((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.domData)(s,"audio",JSON.stringify(M)),b(M),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggleClass)(E,"audio_playing",i.isPlaying()),u&&(u.innerHTML=A(1,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(M).duration)),e&&this._trackSlider&&(this._trackSlider.setValue(0),this._trackSlider.setBackValue(0),this._trackSlider.toggleLoading(!1))),D();const O=i.getCurrentAudio()||this._readyAudio;this.updatePlayerClass(O),this.isLayer()||this._initFixedPlayer()},AudioPage.prototype._initPlayerRedesign=function(){if(!((0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("audio_player_redesign_web_enabled")||(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("redesign_audio_player_tooltip_dislikes_web_enabled")))return;const e=(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("dislikes_web_enabled")||(0,_shared_user_user_env__WEBPACK_IMPORTED_MODULE_46__.partConfigEnabled)("redesign_audio_player_tooltip_dislikes_web_enabled"),_=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)();if(!_)return;[_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.MUSIC_AUDIOS_ADD,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.MUSIC_PLAYLISTS_ADD,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.MUSIC_OWNERS_FOLLOW,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.MUSIC_OWNERS_UNFOLLOW,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.CURATOR_FOLLOW,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.CURATOR_UNFOLLOW,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PLACEHOLDER_REMOVE].forEach((e=>_.on(this,e,((_,t)=>{this.catalogController&&this.catalogController.emitEvent(e,t)})))),_.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.MUSIC_PLAYLISTS_ADD,((e,_)=>{const{playlists:t,playlistsIndex:i}=this._data;Array.isArray(t)&&t.find((e=>e.id===_.id&&e.owner_id===_.owner_id))||(t&&(t.unshift(_),i&&i.add(_)),this.updatePlaylistsCounter(vk.id))})),_.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.RADIOSTATION_FOLLOW,((e,_)=>{const t=this._els.pageContainer.querySelectorAll(`.AudioRadiostationItem[data-id='${_}']`);Array.from(t).forEach((e=>{e.classList.add("AudioRadiostationItem--followed")}))})),_.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.RADIOSTATION_UNFOLLOW,((e,_)=>{const t=this._els.pageContainer.querySelectorAll(`.AudioRadiostationItem[data-id='${_}']`);Array.from(t).forEach((e=>{e.classList.remove("AudioRadiostationItem--followed")}))})),_.on(this,[_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PLAY,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PLAY_REQUESTED],((e,_,t)=>{this._destroyReadyAudio(),this.updateCurrentPlayingInfo()})),_.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.UPDATE,((e,_)=>{e&&this.updatePlayerClass(e)})),_.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.CURRENT_CHANGED,(()=>{const e=_.getCurrentAudio()||this._readyAudio;this.updatePlayerClass(e)})),e&&(_.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.AUDIO_RESTORE_BY_DISLIKE_ACTION,((e,_)=>{if(!_)return;const t=this._els.sections.querySelectorAll(`.audio_row[data-full-id='${_}']`);Array.from(t).forEach((e=>{e.closest(".CatalogBlock__my_audios_block")||e.closest(".CatalogBlock__my_audios")?e.classList.remove("audio_row__deleted"):e.classList.add("audio_row__added")}))})),_.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.AUDIO_DELETE_BY_DISLIKE_ACTION,((e,_)=>{if(!_)return;const t=this._els.sections.querySelectorAll(`.audio_row[data-full-id='${_}']`);Array.from(t).forEach((e=>{(e.closest(".CatalogBlock__my_audios_block")||e.closest(".CatalogBlock__my_audios"))&&e.classList.add("audio_row__deleted"),e.classList.remove("audio_row__added")}))})),_.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PLAY,(()=>{for(let e of this._playlistLoadingProvider().getSet()){const _=this._getPlaylistByQuerySelector(e);_&&_.classList.remove("audio_pl__loading")}this._playlistLoadingProvider().resetSet()})),_.on(this,_shared_audio_AudioPlayerEvents__WEBPACK_IMPORTED_MODULE_10__.events.PLAYLIST_START_LOADING,((e,_,t)=>{const i=`${_}_${t}`,o=`${window.vk.id}_${t}`;this._getPlaylistByQuerySelector(i)?this._markLoadingPlaylist(i):this._getPlaylistByQuerySelector(o)&&this._markLoadingPlaylist(o)})));const t=_.getCurrentAudio()||this._readyAudio;this.updatePlayerClass(t)},AudioPage.prototype.followRadioFromPlayer=function(e){const _=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.getAudioFromEl(e,!0);if(!(0,_shared_audio_utils_isRadio__WEBPACK_IMPORTED_MODULE_35__.isRadio)(_))return;const t=_.id,i=(0,_shared_audio_utils_getAudioExtra__WEBPACK_IMPORTED_MODULE_36__.getAudioExtra)(_).faveHash;e.classList.contains(AudioPage.followedRadioClassName)?(0,_player_radiostation_unfollowRadiostation__WEBPACK_IMPORTED_MODULE_37__.unfollowRadiostation)(t,i):(0,_player_radiostation_followRadiostation__WEBPACK_IMPORTED_MODULE_38__.followRadiostation)(t,i)},AudioPage.prototype._initFixedPlayer=function(){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getSize)(this._els.playerWrap);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(this._els.playerWrap,{width:e[0],height:e[1]});const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getSize)(this._els.player);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.setStyle)(this._els.player,{width:_[0],height:_[1]});const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getSize)("page_header_wrap")[1],i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getXY)(this._els.contentBlock)[1],o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getXY)(this._els.playerWrap)[1]+(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.getSize)(this._els.playerWrap)[1]-t;let s,a,l=!1;const n=()=>{const e=(0,_web_lib_scroll__WEBPACK_IMPORTED_MODULE_7__.scrollGetY)(),_=e>i;if(e<o&&(s||l))return clearTimeout(s),clearTimeout(a),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(this._els.player,"audio_page_player_fixed_shown"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(this._els.player,"audio_page_player_fixed"),void(l=s=!1);_&&!l&&(clearTimeout(s),s=0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(this._els.player,"audio_page_player_fixed"),a=setTimeout((()=>(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.addClass)(this._els.player,"audio_page_player_fixed_shown"))),l=!0),!_&&l&&(clearTimeout(s),s=0,(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(this._els.player,"audio_page_player_fixed_shown"),s=setTimeout((()=>{(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.removeClass)(this._els.player,"audio_page_player_fixed"),s=!1}),250),l=!1)};(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(window,"scroll",n),cur.destroy.push((()=>{n&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(window,"scroll",n)}))},AudioPage.prototype.togglePlayerPlay=function(e){const _=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)();if(_.isPlaying()){const t=_.getCurrentAudio();t&&_.podcastSetActionRef(t,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.PodcastsLogs.ACTION_PAUSE,"",e),_.pauseByButton()}else{const t=this.getPageCurrentPlaylist(),i=_.getCurrentPlaylist(),o=_.getCurrentAudio(),s=_.getPlaylistQueue();let a=o||this._readyAudio;const l=()=>{if(!a)return;if(_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.isClaimedAudio(a)){a=_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.audioTupleToAudioObject(a);const e=(0,_shared_audio_utils_getAudioExtra__WEBPACK_IMPORTED_MODULE_36__.getAudioExtra)(a).claim;return void(0,_web_lib_feature_boxes__WEBPACK_IMPORTED_MODULE_18__.showAudioClaimWarning)(a,e)}let o;o=i&&-1!==s.indexOfAudio(a)?i:t&&-1!==t.indexOfAudio(a)?t:new _web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist(_web_audio_player_components_AudioPlaylist__WEBPACK_IMPORTED_MODULE_14__.AudioPlaylist.TYPE_TEMP,vk.id),this._destroyReadyAudio(),cur.audioStartReadyAudio=!0,_.podcastSetActionRef(a,_web_audio_player_utils__WEBPACK_IMPORTED_MODULE_28__.AudioUtils.PodcastsLogs.ACTION_PLAY,"",e),_.playByButton({audio:a,playlist:o})};!a&&t?s.getAudioAt(0).then((e=>{a=e,l()})):l()}},AudioPage.prototype.promoAlbumSlideInit=function(){const e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_promo");if(this.isLayer()||!e)return;const _=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_promo__items",e);if(!_||_.children.length<=1)return;this.promoAlbumSlideAutoStart(_);const t=()=>this.promoAlbumSlideAutoStop(),i=()=>this.promoAlbumSlideAutoStart(_);(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(e,"mouseenter",t),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.addEvent)(e,"mouseleave",i),window.cur&&cur.destroy.push((()=>{this.promoAlbumSlideAutoStop(),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(e,"mouseenter",t),(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_9__.removeEvent)(e,"mouseleave",i)}))},AudioPage.prototype.promoAlbumSlideAutoStart=function(e){window.cur&&(cur._promoAlbumSlideTO=setTimeout((()=>this.promoAlbumSlide(e,1)),SLIDER_TIMEOUT))},AudioPage.prototype.promoAlbumSlideAutoStop=function(){window.cur&&clearTimeout(cur._promoAlbumSlideTO)},AudioPage.prototype.promoAlbumSlide=function(e,_){const t=vk.rtl?_>0?-1:1:_<0?-1:1,i=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.gpeByClass)("audio_promo",e);if(!i)return;const o=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.geByClass1)("audio_promo__items",i);if(!o||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)(o,"sliding"))return;this.promoAlbumSlideAutoStop();const s=o.scrollLeft,a=o.offsetWidth,l=o.children,n=l.length,r=e=>vk.rtl?o.scrollWidth-e*a-a:e*a;if(!(l.length>1))return;this.promoAlbumSlideAutoStart(e);let d=!1,u=null,c=!1,E=Math.round(s/a);E+=t,E>=n||E<0?(d=l[0].cloneNode(!0),o.appendChild(d),E>=n?(c=!0,u=r(E)):E<0&&(o.scrollLeft=r(n),E=n-1,u=r(E))):u=r(E),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)(o,"sliding",!0),(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_3__.animate)(o,{scrollLeft:u},{duration:500,transition:_web_lib_fx__WEBPACK_IMPORTED_MODULE_3__.Fx.Transitions.swiftOut,onComplete:()=>{c&&(o.scrollLeft=r(0)),d&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.re)(d),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.data)(o,"sliding",!1)}})},AudioPage.prototype.handleAudioAdMoreClick=function(e){console.log(e,e.currentTarget)},AudioPage.prototype.playerToggleAdsPlaying=function(e){const _=this._els.player.classList;isAdPlayingWithChoices()&&_.toggle("audio_page_player_with_ad_choices",e),_.toggle("audio_page_player_ads_playing",e)},AudioPage.setVisibilitySectionsContent=function(e){cur.audioPage&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_19__.toggle)(cur.audioPage._els.sections,e)},AudioPage.prototype._playlistLoadingProvider=function(){return _PlaylistLoadingProvider__WEBPACK_IMPORTED_MODULE_65__.PlaylistLoadingProvider.ensure()},AudioPage.prototype._getPlaylistByQuerySelector=function(e){return document.querySelector(`._audio_pl_${e}`)},AudioPage.prototype._markLoadingPlaylist=function(e){const _=this._getPlaylistByQuerySelector(e);_&&(_.classList.add("audio_pl__loading"),this._playlistLoadingProvider().addPlaylist(e))};try{(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_1__.tq)().setInteractiveHandler("Audio/Player/LyricsButton/Click",(e=>{if(!checkMyMusicCreationBlockActionEnabled())return;const{target:_}=e.payload;if(_.disabled)return;const t=currentAudioPage(e.payload.target),i=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayer)(),o=(0,_web_audioplayer_getAudioPlayer__WEBPACK_IMPORTED_MODULE_55__.getAudioPlayerUI)(),s=i.getCurrentAudio()||t._readyAudio;s&&o.lyrics.open({audio:s,playlist:null,context:s.context})}))}catch(e){console.error(e)}try{(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_1__.tq)().setInteractiveHandler("Audio/Catalog/RecommendationsPlaylists/Playlist/OpenButton/Click",(e=>{const{target:_,dataAttrs:t}=e.payload;!_.disabled&&t.options&&_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_51__.AudioPageProxy.ensure().emitter.emit(_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_51__.AudioPageEventType.AudioRecomsOnboardingShowRequested,{reason:_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_51__.AudioRecomsOnboardingShowRequestedEventReason.RecommendationsPlaylistOpenButton,payload:JSON.parse(t.options)})}))}catch(e){console.error(e)}try{(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_1__.tq)().setInteractiveHandler("Audio/Catalog/RecommendationsPlaylists/Playlist/PlayButton/Click",(e=>{const{target:_,dataAttrs:t}=e.payload;!_.disabled&&t.options&&_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_51__.AudioPageProxy.ensure().emitter.emit(_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_51__.AudioPageEventType.AudioRecomsOnboardingShowRequested,{reason:_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_51__.AudioRecomsOnboardingShowRequestedEventReason.RecommendationsPlaylistPlayButton,payload:JSON.parse(t.options)})}))}catch(e){console.error(e)}try{(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_1__.tq)().setInteractiveHandler("Audio/Catalog/VibeRecommendationsPlaylists/Playlist/PlayButton/Click",(e=>{const{target:_,dataAttrs:t}=e.payload;!_.disabled&&t.options&&_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_51__.AudioPageProxy.ensure().emitter.emit(_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_51__.AudioPageEventType.AudioRecomsOnboardingShowRequested,{reason:_web_audio_AudioPageProxy__WEBPACK_IMPORTED_MODULE_51__.AudioRecomsOnboardingShowRequestedEventReason.VibeRecommendationsPlaylistPlayButton,payload:JSON.parse(t.options)})}))}catch(e){console.error(e)}(0,_shared_evbus__WEBPACK_IMPORTED_MODULE_1__.tq)().setInteractiveHandler("Audio/Catalog/CreateMyMusicPlaylist/Click",(e=>{const _=(0,_web_di__WEBPACK_IMPORTED_MODULE_0__.ensureDIRootWebContainer)(),t=_.resolve(_vkontakte_internal_plugins__WEBPACK_IMPORTED_MODULE_67__.AuthService),i=_.resolve(_web_audio_catalog_AudioCatalogStatsCollector__WEBPACK_IMPORTED_MODULE_53__.AudioCatalogStatsCollector);try{t.assertAuthorized();const{target:_,dataAttrs:o}=e.payload;if(_.disabled||!o.options)throw new Error("Task unavailable");const{ownerId:s,blockId:a}=JSON.parse(o.options);AudioPage.editPlaylist(s),i.logOpenMyMusicPlaylistCreationModal({blockId:a})}catch(e){console.error("CreateMyMusicPlaylist/Click task failed",e)}}))},955377:(e,_,t)=>{t.d(_,{default:()=>r});var i=t(672277),o=t(449299),s=t(754866),a=t(593159),l=t(972332);function n(e,_,t){if((0,a.isObject)(_)?t=_:this._dragElClass=_,this.options=(0,a.extend)({dragThreshold:n.DRAG_THRESHOLD_DIST},t),this._contEl=(0,s.ge)(e),this._contEl){this._excludedCount=0;for(let e=0;e<this._contEl.children.length;e++)this._contEl.children[e].getAttribute("nodrag")&&this._excludedCount++;(0,l.addEvent)(this._contEl,"mousedown",this._ev_mousedown_handler=this._onMouseDown.bind(this)),(0,s.setStyle)(this._contEl,"position","relative"),this._inited=!0,this._updateScrollbar=this._initUpdaterScrollbar()}}n.AUTO_SCROLL_DY=10,n.DRAG_THRESHOLD_DIST=0,n.AUTO_SCROLL_DISTANCE_THRESHOLD=300,n.AUTO_SCROLL_GAP=300,n.prototype.destroy=function(){this._inited&&(this._inited=!1,this._deinitEvents(!0))},n.prototype._getParentDragItemEl=function(e){let _,t=e;for(;t&&(_=(0,s.domPN)(t))!==this._contEl;)t=_;return t===this._curPlaceholderEl&&(t=null),t},n.prototype._onKey=function(e){e.keyCode===l.KEY.ESC&&this.isCurrentlyDragging()&&this._onMouseUp()},n.prototype.forceFinishDrag=function(e){this.isCurrentlyDragging()?(this.onDragFinish=e,this._onMouseUp(!0)):e()},n.prototype._onMouseDown=function(e){if(this._disabled||0!=e.button||this._curDragEl||(0,s.attr)(e.target,"nodrag")||this._dragElClass&&!(0,s.domClosest)(this._dragElClass,e.target))return;let _=e.target;for(;_&&_!==window.document;){if((0,a.intval)((0,s.domData)(_,"nodrag")))return;_=(0,s.domPN)(_)}const t=this._getParentDragItemEl(e.target);if(!t||(0,s.attr)(t,"nodrag"))return;if((0,s.re)((0,s.geByClass1)("ui_gridsorter_placeholder"),this._contEl),this._contInfo=this._contInfo||{prevSize:(0,s.getSize)(this._contEl)},this._ensureGridIsActual(),this._grid.length<=1)return;const i=window.getComputedStyle(t),o=(0,s.getXY)(t);this._initial={candidateEl:t,x:e.clientX,y:e.clientY,itemMargin:{x:parseInt(i.marginLeft),y:parseInt(i.marginTop)},shift:{x:e.pageX-o[0],y:e.pageY-o[1]}},(0,l.addEvent)(document,"mousemove",this._ev_mousemove_handler=this._onMouseMove.bind(this)),(0,l.addEvent)(document,"mouseup",this._ev_mouseup_handler=this._onMouseUp.bind(this)),(0,l.addEvent)(document,"keydown",this._ev_keydown_handler=this._onKey.bind(this)),cur.cancelClick=!1,(0,l.cancelEvent)(e)},n.prototype._dist=function(e){return Math.abs(e.clientX-this._initial.x)+Math.abs(e.clientY-this._initial.y)},n.prototype._onMouseUp=function(e){const _=this._curDragEl;let t=!e;if(!0===e&&(e=void 0),this._curDragEl){this._curDragEl=null,(0,s.removeClass)(_,"ui_gridsorter_moveable_notrans"),this._curOverCell||(this._curOverCell={el:this._curPlaceholderEl,pos:(0,s.getXY)(this._curPlaceholderEl),size:(0,s.getSize)(this._curPlaceholderEl)});const i=this._curOverCell.pos,o=this._curOverCell.el,a=this._grid[this._curDragCellIndex],n=a&&a.size;(0,s.gpeByClass)("_ape_item_list",_)&&(i[0]+=20,i[1]+=20),n&&this._isShiftToLeft&&(i[1]-=n[1]-this._curOverCell.size[1]),setTimeout((()=>{if(t){for(let e=0,_=this._grid.length;e<_;e++){const _=this._grid[e];_.dirty&&this._setPos(_.el,{left:0,top:0})}this._setPos(_,this._initialCurDragPos)}else this._setPos(_,{left:i[0],top:i[1]})})),setTimeout((()=>{if((0,s.re)(this._curPlaceholderEl),(0,s.removeClass)(this._contEl,"ui_gridsorter_cont"),this.options.dragCls&&(0,s.removeClass)(_,this.options.dragCls),!this._inited)return;let e;if(t){let e=this._grid.length;for(let _=0;_<e;_++){const e=this._grid[_];e.dirty&&this._setPos(e.el,{left:null,top:null})}this._setPos(_,{left:null,top:null,width:null,height:null})}else{let t;e=this._isShiftToLeft?(0,s.domNS)(o):o,this._contEl.insertBefore(_,e);let i=-1,a=this._initial.hasInlineSize;this._setPos(_,{left:null,top:null}),a||(0,s.setStyle)(_,{width:null,height:null});let l=this._grid.length;for(let e=0;e<l;e++){const l=this._grid[e];(l.dirty||l.el===_)&&(this._setPos(l.el,{left:null,top:null}),a||(0,s.setStyle)(l.el,{width:null,height:null}),l.pos=this._calcElementPos(l.el),l.dirty=!1),l.el===_?t=e:l.el===o&&(i=e)}if(i>=0){const e=this._grid.splice(t,1);this._grid.splice(i,0,e[0])}}(0,s.removeClass)(_,"ui_gridsorter_moveable"),this._curOverCell=this._curPlaceholderEl=null,t&&this.update(),this.options.onDragFinish&&this.options.onDragFinish(_),o!==_&&!t&&this.options.onReorder&&this.options.onReorder(_,e,(0,s.domPS)(_)),this.onDragFinish&&(this.onDragFinish(),this.onDragFinish=void 0)}),210),e&&this._dist(e)>5&&((0,l.cancelEvent)(e),cur.cancelClick=!0)}this._updateScrollbar(),this._deinitEvents(),_&&this._overEl&&this.options.onDragLeave&&this.options.onDragLeave(this._overEl,_),t||_&&this._overEl&&this.options.onDragDrop&&(t=this.options.onDragDrop(this._overEl,_)),this._overEl=null},n.prototype._deinitEvents=function(e){e&&(this._onMouseUp(),(0,l.removeEvent)(this._contEl,"mousedown",this._ev_mousedown_handler)),clearTimeout(this._autoScrollTO),this._autoScrollTO=!1,this._ev_mousemove_handler&&(0,l.removeEvent)(document,"mousemove",this._ev_mousemove_handler),this._ev_mouseup_handler&&(0,l.removeEvent)(document,"mouseup",this._ev_mouseup_handler),this._ev_keydown_handler&&(0,l.removeEvent)(document,"keydown",this._ev_keydown_handler)},n.prototype._setPos=function(e,_){this.options.noPosTransform||!this._hasTranslateFeauture&&!(this._hasTranslateFeauture=window.getComputedStyle(e).getPropertyValue("transform"))?(0,s.setStyle)(e,(0,a.extend)({transform:null},_)):null===_.left||null===_.top?(0,s.setStyle)(e,{transform:null,top:null,left:null}):(0,s.setStyle)(e,{transform:"translate("+_.left+"px, "+_.top+"px)",top:null,pos:null})},n.prototype._recalc=function(){const e=this._curDragEl,_=this._curOverCell.el;if(this._initGrid(),_===e){let _=this._grid.length;for(let t=0;t<_;t++){const _=this._grid[t];_.el!==e&&_.dirty&&(_.dirty=!1,this._setPos(_.el,{left:null,top:null}))}return}let t=0,i=!1,o=!1,s=this._grid.length;for(let t=0;t<s;t++){const o=this._grid[t];if(o.el===e){i=!0;break}if(o.el===_){i=!1;break}}this._isShiftToLeft=i;let a=i?0:this._grid.length-1,l=i?this._grid.length:-1,n=i?1:-1,r=[0,0];for(;a!==l;a+=n){const s=this._grid[a];if(2!==t)if(s.el!==e){if(s.el===_&&t++,1===t||2===t){let e=0,_=0;i?(e=o.pos[0]+r[0],_=o.pos[1]+r[1],r[0]+=s.size[0]-o.size[0],r[1]+=s.size[1]-o.size[1]):(r[0]+=o.size[0]-s.size[0],r[1]+=o.size[1]-s.size[1],e=o.pos[0]+r[0],_=o.pos[1]+r[1]),this._setPos(s.el,{left:e-s.pos[0],top:_-s.pos[1]}),s.dirty=!0}else s.dirty&&(this._setPos(s.el,{left:null,top:null}),s.dirty=!1);o=s}else t++,o=s;else s.dirty&&(this._setPos(s.el,{left:null,top:null}),s.dirty=!1),o=s}},n.prototype.disable=function(){this._disabled=!0},n.prototype.enable=function(){this._disabled=!1,this._initGrid(!0)},n.prototype.update=function(){this._disabled||this._initGrid(!0)},n.prototype._ensureGridIsActual=function(){this._initGrid()},n.prototype._needGridUpdate=function(){if(!this._grid)return 1;this._contInfo.prevSize=this._contInfo.prevSize||(0,s.getSize)(this._contEl);let e=0,_=this._contEl.children.length-this._excludedCount-(0,a.intval)(!!this._curPlaceholderEl);if(_!==this._grid.length)e=_>this._grid.length?2:1,this._contInfo.prevSize=(0,s.getSize)(this._contEl);else{let _=(0,s.getSize)(this._contEl),t=this._contInfo.prevSize;(Math.abs(t[0]-_[0])>5||Math.abs(t[1]-_[1])>5)&&(e=1),this._contInfo.prevSize=_}return e},n.prototype._initGrid=function(e){let _=e?1:this._needGridUpdate();if(!_)return;1===_&&(this._grid=[],this._contInfo&&(delete this._contInfo.pos,delete this._contInfo.size));let t=this._grid?this._grid[this._grid.length-1]:null;this._grid=this._grid||[];let i,o=!!t,a=this._contEl.children;if(!a.length)return;let l=this._getItemMargins();for(let e=this._curDragEl?this._grid.length:0,_=a.length;e<_;e++){let _=a[e];t&&_===t.el?o=!1:o||_===this._curPlaceholderEl||_.getAttribute("nodrag")||(i=(0,s.getSize)(_),i[0]+=l[0],i[1]+=l[1],this._grid.push({el:_,size:i,pos:this._calcElementPos(_)}))}},n.prototype._getRelativeMousePos=function(e){let _=this._getContPos(),t=this._getContShift();return{left:e.clientX-_[0]-t[0],top:e.clientY-_[1]-t[1]}},n.prototype._updateDraggablePosition=function(e){if(!this._curDragEl)return;let _=this._getRelativeMousePos(e),t=this._getItemShift(),i=this._getContShift(),o=this._getContSize(),a=_.top-this._initial.shift.y-t[1]+i[1];this.options.limitBottomMove&&(a=Math.min(a,o[1]+30)),(0,s.hasClass)(this._contEl,"_ape_item_list")&&(a+=this._contEl.scrollTop),this._setPos(this._curDragEl,{left:_.left-this._initial.shift.x-t[0]+i[0],top:a}),window.AudioPage&&window.AudioPage.onUpdateDraggablePosition&&window.AudioPage.onUpdateDraggablePosition()},n.prototype._getContShift=function(){if(this._contInfo=this._contInfo||{},!this._contInfo.shift){let e=window.getComputedStyle(this._contEl);this._contInfo.shift=[parseFloat(e.paddingLeft),parseFloat(e.paddingTop)]}return this._contInfo.shift},n.prototype._getContSize=function(){return this._contInfo=this._contInfo||{},this._contInfo.size=(0,s.getSize)(this._contEl),this._contInfo.size},n.prototype._getContPos=function(){return this._contInfo=this._contInfo||{},this._contInfo.pos=(0,s.getXY)(this._contEl),this._contInfo.pos[1]-=(0,i.scrollGetY)(),this._contInfo.pos},n.prototype._getItemShift=function(){if(this._contInfo=this._contInfo||{},!this._contInfo.itemShift){let e=window.getComputedStyle((0,s.domFC)(this._contEl));this._contInfo.itemShift=[parseFloat(e.marginLeft),parseFloat(e.marginTop)]}return this._contInfo.itemShift},n.prototype._getItemMargins=function(){if(this._contInfo=this._contInfo||{},!this._contInfo.itemMargins){let e=window.getComputedStyle((0,s.domFC)(this._contEl));this._contInfo.itemMargins=[parseFloat(e.marginLeft)+parseFloat(e.marginRight),parseFloat(e.marginTop)+parseFloat(e.marginBottom)]}return this._contInfo.itemMargins},n.prototype._calcElementPos=function(e){let _=this._getContShift(),t=this._getItemShift();return[e.offsetLeft-_[0]-t[0],e.offsetTop-_[1]-t[1]]},n.prototype.isCurrentlyDragging=function(){return!!this._curDragEl},n.prototype._initUpdaterScrollbar=function(){return(0,o.throttle)((e=>{const _=this.options.wrapNode||e;let t=(0,s.data)(_,"sb");t&&t.update(!1,!0)}),500)},n.prototype._onMouseMove=function(e){const _=()=>this.options.wrapNode?this.options.wrapNode.scrollTop:(0,i.scrollGetY)(),t=e=>{this.options.wrapNode?this.options.wrapNode.scrollTop=e:(0,i.scrollToY)(e,0,!1,!0)};if(this._curDragEl){this._ensureGridIsActual(),!e&&(e={clientX:this._lastMousePos.x,clientY:this._lastMousePos.y}),this._lastMousePos={x:e.clientX,y:e.clientY},this._updateDraggablePosition(e);let o=this._getContSize(),a=this._getRelativeMousePos(e),l=!1;if((0,s.hasClass)(this._contEl,"_ape_item_list")&&(a.top+=this._contEl.scrollTop),a.left>0&&a.left<o[0]&&a.top>0&&a.top<o[1]){let e=0,_=this._grid.length-1,t=50;for(;t;){let i=e+Math.floor((_-e)/2);const o=this._grid[i];if(a.left>o.pos[0]&&a.top>o.pos[1]&&a.left<o.pos[0]+o.size[0]&&a.top<o.pos[1]+o.size[1]){l=o;break}if(e===_)break;a.top<o.pos[1]||a.left<o.pos[0]&&a.top<o.pos[1]+o.size[1]?_=_===i?_-1:i:e=e===i?e+1:i,t--}}else{let e,_,t,i=this._grid.length,o=999999;for(let s=0;s<i;s++){const i=this._grid[s];_=a.left-(i.pos[0]+i.size[0]/2),t=a.top-(i.pos[1]+i.size[1]/2);const l=_*_+t*t;o>l&&(o=l,e=i)}l=e}!l||this._curOverCell&&this._curOverCell.el===l.el||(this._curOverCell=l,this._recalc());{let o,a,l,n,r=0;if(this.options.wrapNode)o=n=this.options.wrapNode,a=(0,s.getSize)(o),l=(0,s.getXY)(o),l[1]-=(0,i.scrollGetY)(),r=e.clientY;else{let _=window,t=document.documentElement,i=document.body,o=_.innerWidth||t.clientWidth||i.clientWidth,s=_.innerHeight||t.clientHeight||i.clientHeight;n=_.bodyNode,a=[o,s],l=[0,0],r=e.clientY}let d=Math.max(20,a[1]/10),u=l[1]+d-r,c=d-(l[1]+a[1]-r);if(c>0||u>0){let e=Math.min(1,u/d),i=Math.min(1,c/d);this._autoScrollTO||(this._autoScrollTO=setTimeout((()=>{this._autoScrollTO=!1;let o=_();t(o+16*(e>0?-e:i)),o!==n.scrollTop&&(this._updateScrollbar(n),this._onMouseMove())}),20))}}if(this.options.onDragOverElClass){let _=e.target;(0,s.hasClass)(_,this.options.onDragOverElClass)||(_=(0,s.gpeByClass)(this.options.onDragOverElClass,_))?this._overEl!==_&&(this._overEl&&this.options.onDragLeave&&this.options.onDragLeave(this._overEl,this._curDragEl),this.options.onDragEnter&&this.options.onDragEnter(_,this._curDragEl),this._overEl=_):(this._overEl&&this.options.onDragLeave&&this.options.onDragLeave(this._overEl,this._curDragEl),this._overEl=null)}}else if(this._dist(e)>this.options.dragThreshold){this._curDragEl=this._initial.candidateEl;let _=this._grid.length;for(let e=0;e<_;e++)if(this._grid[e].el===this._curDragEl){this._curDragCellIndex=e;break}this.options.dragCls&&(0,s.addClass)(this._curDragEl,this.options.dragCls);const t=(0,s.getSize)(this._curDragEl),i=(0,s.getXY)(this._curDragEl),o=window.getComputedStyle(this._curDragEl),a=this._getContPos();this._initial.hasInlineSize=!(!this._curDragEl.style.width&&!this._curDragEl.style.height),(0,s.setStyle)(this._curDragEl,{width:t[0],height:t[1]}),this._initialCurDragPos={left:i[0]-a[0],top:i[1]-a[1]-document.body.scrollTop},this._curPlaceholderEl=(0,s.ce)("div",{className:"ui_gridsorter_placeholder"}),(0,s.setStyle)(this._curPlaceholderEl,{width:t[0]+parseFloat(o.marginLeft)+parseFloat(o.marginRight),height:t[1]+parseFloat(o.marginTop)+parseFloat(o.marginBottom)}),this._contEl.insertBefore(this._curPlaceholderEl,this._curDragEl),(0,s.addClass)(this._curDragEl,"ui_gridsorter_moveable"),(0,s.addClass)(this._curDragEl,"ui_gridsorter_moveable_notrans"),(0,s.addClass)(this._contEl,"ui_gridsorter_cont"),this._onMouseMove(e),this._updateDraggablePosition(e),this.options.onDragStart&&this.options.onDragStart(this._curDragEl)}(0,l.cancelEvent)(e)};const r=n},402096:(e,_,t)=>{t.d(_,{ON_BOARDING_BG_RECT_ID:()=>n,default:()=>u});var i=t(754866),o=t(972332),s=t(672277),a=t(287470),l=t(250598);const n="onboarding_bg_rect",r="page_header_cont",d="onboarding";class u{initOnboardingBG(){if(!window.onboardingBG){let e='\n<div id="onboarding_layout">\n  <svg id="onboarding_bg_header" width="100%" height="49px">\n    <rect id="onboarding_bg_rect" class="GroupOnboardingBg" x="0" y="0" width="100%" height="100%" fill-opacity="0.8" fill="#000"></rect>\n  </svg>\n  <svg id="onboarding_bg" width="100%" height="100%">\n  <defs>\n    <mask id="mask" x="0" y="0" width="100%" height="100%">\n      <rect x="0" y="0" width="100%" height="100%" fill="#fff"></rect>\n      <rect id="onboarding_bg_clip" class="GroupOnboardingBgClip" x="0" y="0" width="0" height="0" fill="#000" rx="8" ry="8"></rect>\n    </mask>\n  </defs>\n  <rect id="onboarding_bg_rect" class="GroupOnboardingBg" x="0" y="42" width="100%" height="100%" mask="url(#mask)" fill-opacity="0.8"></rect>\n  </svg>\n</div>\n      ',_=(0,i.se)(e);(0,i.domInsertBefore)(_,window.layerBG),window.onboardingBGHeader=(0,i.ge)("onboarding_bg_header"),window.onboardingBG=(0,i.ge)("onboarding_bg"),window.onboardingBGRect=(0,i.ge)(n),window.onboardingBGClip=(0,i.ge)("onboarding_bg_clip"),window.cur.destroy.push((()=>{(0,i.hide)(window.onboardingBG),(0,i.hide)(window.onboardingBGHeader),(0,i.removeClass)((0,i.ge)(r),d),this.hideDarkness=!0,this.hideTT(),delete window.onboardingBG,delete window.onboardingBGHeader,delete window.onboardingBGRect,delete window.onboardingBGClip,this.opts.onBGClick&&(0,o.removeEvent)(window.onboardingBG,"click",this.opts.onBGClick)}))}this.opts.onBGClick&&(0,o.addEvent)(window.onboardingBG,"click",this.opts.onBGClick)}showTT(){const[,e]=(0,i.getXY)(this.el);this.tt=new l.ElementTooltip(this.el,this.ttParams),this.opts.highlight&&(this.addDarkness(),this.addHighlight()),this.tt.show();const _=this.tt.getContent();(0,a.isElementInViewport)(this.el)&&(0,a.isElementInViewport)(_)||(0,s.scrollToY)(e-42-this.ttParams.scrollOffset)}hideTT(){this.tt&&(this.tt.destroy(),this.removeDarkens(),this.hideDarkness&&((0,o.removeEvent)(window,"scroll"),(0,o.removeEvent)(window,"resize")),this.opts.onBGClick&&window.onboardingBG&&(0,o.removeEvent)(window.onboardingBG,"click",this.opts.onBGClick),this.opts.onHide&&this.opts.onHide())}addHighlight(){window.onboardingBGClip&&(this.highlightElement(),(0,o.addEvent)(window,"scroll",this.onScrollTT.bind(this)),(0,o.addEvent)(window,"resize",this.onResizeTT.bind(this)))}highlightElement(){let e=this.el.offsetWidth,_=this.el.offsetHeight,t=(0,i.getXY)(this.el);(0,i.attr)(window.onboardingBGClip,"width",e+this.border[1]+this.border[3]),(0,i.attr)(window.onboardingBGClip,"height",_+this.border[0]+this.border[2]),(0,i.attr)(window.onboardingBGClip,"x",t[0]-this.border[1]),(0,i.attr)(window.onboardingBGClip,"y",t[1]-this.border[0])}onResizeTT(){this.setDartToFullWidth(),this.highlightElement()}onScrollTT(){let e=this.getPageHeight();window.onboardingBG.height!=e&&this.setDartToFullHeight()}setDartToFullHeight(){(0,i.attr)(window.onboardingBG,"height",this.getPageHeight())}setDartToFullWidth(){(0,i.attr)(window.onboardingBG,"width",this.getPageWidth()),(0,i.attr)(window.onboardingBGHeader,"width",this.getPageWidth())}addDarkness(){(0,i.isVisible)(window.onboardingBG)||(this.setDartToFullHeight(),this.setDartToFullWidth(),(0,i.show)(window.onboardingBG),(0,i.isVisible)(window.onboardingBGHeader)||((0,i.show)(window.onboardingBGHeader),(0,i.addClass)((0,i.ge)(r),d)))}removeDarkens(){this.hideDarkness&&((0,i.hide)(window.onboardingBG),(0,i.hide)(window.onboardingBGHeader),(0,i.removeClass)((0,i.ge)(r),d))}ttOnHide(){this.hideTT()}show(){setTimeout(this.showTT.bind(this),1e3)}getPageWidth(){const e=document.documentElement,_=document.body;return Math.max(_.scrollWidth,e.scrollWidth,_.offsetWidth,e.offsetWidth,_.clientWidth,e.clientWidth)}getPageHeight(){const e=document.documentElement,_=document.body;return Math.max(_.scrollHeight,e.scrollHeight,_.offsetHeight,e.offsetHeight,_.clientHeight,e.clientHeight)}constructor(e,_,t={}){this.el=e,this.text=_,this.hideDarkness=!0,this.oldColor=!1;let i={autoShow:!1,noAutoHideOnWindowClick:t.noAutoHideOnWindowClick??!0,content:_ instanceof HTMLElement?_:`${_}`,cls:`feature_intro_tt tutorial_tip_tt ${(()=>{const e=t.class??"";return t.tooltipWhite?e:e+" feature_intro_blue_tt"})()}`,appendToParent:!0,onHide:this.ttOnHide.bind(this),scrollOffset:t.scrollOffset||0,align:t.align||l.ElementTooltip.ALIGN_CENTER};t.side&&(i.forceSide=t.side),t.offset&&(i.offset=t.offset),t.width&&(i.width=t.width),t.shift&&(i.centerShift=t.shift),t.border?this.border=t.border:this.border=[10,10,10,10],t.ttOnHide&&(i.onHide=t.ttOnHide),t.withCloseButton&&(i.withCloseButton=t.withCloseButton,i.onCloseButtonClick=t.onCloseButtonClick),t.align&&(i.align=t.align),this.ttParams=i,this.opts=t,this.initOnboardingBG()}}},287470:(e,_,t)=>{function i(e){const _=e.getBoundingClientRect();return _.top>=0&&_.left>=0&&_.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&_.right<=(window.innerWidth||document.documentElement.clientWidth)}function o(e,_){return`<b>${e}</b><br/>${_}`}t.d(_,{buildTooltipeContent:()=>o,isElementInViewport:()=>i})},602754:(e,_,t)=>{t.d(_,{default:()=>r});var i=t(754866),o=t(866467),s=t(593159),a=t(972332),l=t(740342);function n(e,_){if(this.constructor!=n)throw new Error("Slider was called without 'new' operator");if(!e)throw new Error("No element was provided for Slider");e=(0,i.ge)(e),this.options=_||{size:1},this.options.backValue=this.options.backValue||0;const t=100*this.options.backValue,o=`<div class="slider_slide"><div class="slider_loading_bar" style="opacity: 0; display: none;"></div> ${this.options.withBackLine?'<div class="slider_back" style="width:'+t+'%"></div>':""} <div class="slider_amount"></div> <div class="slider_handler"></div> </div>`;this._el=(0,i.ce)("div",{innerHTML:o,className:"slider",id:e.getAttribute("id")||""});const r=e.classList||[],d=this;for(let e=0,_=r.length;e<_;e++)(0,i.addClass)(this._el,r[e]);(0,s.each)(this._el.attributes,(function(e,_){"id"==_.name&&"class"==_.name||d._el.setAttribute(_.name,_.value)})),e.parentNode.replaceChild(this._el,e),(0,i.data)(this._el,"slider",this),this._amountEl=(0,i.geByClass1)("slider_amount",this._el),this._handlerEl=(0,i.geByClass1)("slider_handler",this._el),this._slideEl=(0,i.geByClass1)("slider_slide",this._el),this._backEl=(0,i.geByClass1)("slider_back",this._el),this._progressEl=(0,i.geByClass1)("slider_loading_bar",this._el),this.options.color&&((0,i.setStyle)(this._amountEl,{backgroundColor:this.options.color}),(0,i.setStyle)(this._handlerEl,{backgroundColor:this.options.color})),this.options.handlerColor&&(0,i.setStyle)(this._handlerEl,{backgroundColor:this.options.handlerColor}),this.options.backColor&&(0,i.setStyle)(this._slideEl,{backgroundColor:this.options.backColor}),(0,i.addClass)(this._el,"slider_size_"+this.options.size),this.options.debounce&&(this._onValueChangeDebounced=(0,l.debounce)(this._onValueChange,this.options.debounce)),_.formatHint&&((0,a.addEvent)(this._el,"mousemove",this._ev_onMouseOver=this._onMouseOver.bind(this)),(0,a.addEvent)(this._el,"mouseleave",this._ev_onMouseLeave=this._onMouseLeave.bind(this))),(0,a.addEvent)(this._el,"mousedown",this._ev_onMouseDown=this._onMouseDown.bind(this)),this.setValue(this.options.value||0,!this.options.fireChangeEventOnInit,!1),this.setBackValue(this.options.backValue)}n.prototype.toggleAdState=function(e){this._adState=!!e,(0,i.toggleClass)(this._el,"slider_ad_mode",!!e)},n.prototype.toggleAdMarker=function(e){e=!!e;let _=(0,i.geByClass1)("slider_ad_marker",this._el);if(e){if(!_){const e="onmouseover=\"showTooltip(this, {text: '"+o.getLang("global_audio_ad")+"', black: 1, shift: [16, 9, 10]})\"";_=(0,i.se)('<div class="slider_ad_marker_wrap" '+e+'><div class="slider_ad_marker"></div></div>'),(0,i.domPN)(this._slideEl).insertBefore(_,this._slideEl),delete this._width,(0,i.addClass)(this._el,"slider_ad_marker_shown")}}else(0,i.re)(_),delete this._width,(0,i.removeClass)(this._el,"slider_ad_marker_shown")},n.prototype.showAdMarker=function(e){const _=(0,i.se)('<div class="slider_ad_marker"></div>');(0,i.domPN)(this._slideEl).insertBefore(_,this._slideEl),delete this._width,(0,i.addClass)(this._el,"slider_ad_marker_shown")},n.prototype.isAdMode=function(){return(0,i.hasClass)(this._el,"slider_ad_mode")},n.prototype.setBlocked=function(e){this.blocked=e,(0,i.toggleClass)(this._el,"slider_blocked",e)},n.prototype.getBlocked=function(){return this.blocked},n.prototype.isBlocked=function(){return this.isAdMode()||this.getBlocked()},n.prototype.toggleLoading=function(e){e=!!e,(0,i.toggle)(this._progressEl,e),(0,i.setStyle)(this._progressEl,"opacity",e?1:0)},n.prototype.destroy=function(e){this.options.formatHint&&((0,a.removeEvent)(this._el,"mousemove",this._ev_onMouseOver),(0,a.removeEvent)(this._el,"mouseleave",this._ev_onMouseLeave),(0,a.removeEvent)(this._el,"mousedown",this._ev_onMouseDown)),(0,i.re)(this._el),(0,i.re)(this._currHintEl)},n.prototype._updateHint=function(e,_){this._currHintEl||(this._currHintEl=(0,i.se)('<div class="slider_hint" id="slider_hint"></div>'),this.options.hintClass&&(0,i.addClass)(this._currHintEl,this.options.hintClass),this._el.appendChild(this._currHintEl)),this._width=this._width||(0,i.getSize)(this._slideEl)[0];const t=this._getPos();let o=Math.round(e.pageX-t[0]);const s=this._width;if(o=_?Math.min(Math.max(0,o),s):o,o>=0&&o<=s){const e=o/s;this._currHintEl.innerHTML=this.options.formatHint?this.options.formatHint.call(this,e):e;const t=(0,i.getSize)(this._currHintEl);(0,i.setStyle)(this._currHintEl,{left:this._slideEl.offsetLeft+o-t[0]/2,top:this._slideEl.offsetTop-t[1]-10}),!_&&this._toggleHint(!0)}else!_&&this._toggleHint(!1);this.options.formatHint||this._toggleHint(!1)},n.prototype._toggleHint=function(e){this.isAdMode()&&(e=!1),(0,i.toggleClass)(this._currHintEl,"visible",e)},n.prototype._onMouseOver=function(e){n._currenSliderDrag||(0,i.hasClass)(this._el,"active")||this._updateHint(e)},n.prototype._onMouseLeave=function(e){(0,i.hasClass)(this._el,"active")||this._toggleHint(!1)},n.prototype._onMouseDown=function(e){0==e.button&&(delete cur._sliderMouseUpNowEl,this._adState||this.getBlocked()||((0,a.addEvent)(window,"mousemove",this._ev_onMouseMove=this._onMouseMove.bind(this)),(0,a.addEvent)(window,"mouseup",this._ev_onMouseUp=this._onMouseUp.bind(this)),this._width=(0,i.getSize)(this._slideEl)[0],this._onMouseMove(e),n._currenSliderDrag=this,(0,i.addClass)(this._el,"active"),(0,a.cancelEvent)(e)))},n.prototype._onMouseUp=function(e){cur._sliderMouseUpNowEl=this._el,(0,a.removeEvent)(window,"mousemove",this._ev_onMouseMove),(0,a.removeEvent)(window,"mouseup",this._ev_onMouseUp),clearTimeout(this._debounceto),this._onValueChange(),(0,i.removeClass)(this._el,"active"),n._currenSliderDrag=!1,this._toggleHint(!1),this.options.onEndDragging&&this.options.onEndDragging(this._currValue)},n.prototype._onMouseMove=function(e){const _=this._getPos();let t=Math.max(e.pageX,_[0]);t=Math.min(t,_[0]+this._width),t-=_[0],this.setValue(t/this._width,!0,!0),this._onValueChangeDebounced?this._onValueChangeDebounced():this._onValueChange(),this._toggleHint(!0),this._updateHint(e,!0),(0,a.cancelEvent)(e)},n.prototype._getPos=function(){return this._slidePos=(0,i.getXY)(this._slideEl)},n.LOGFBASE=35,n.prototype._logf=function(e){if(!this.options.log)return e;const _=n.LOGFBASE;return(Math.pow(_,e)-1)/(_-1)},n.prototype._unlogf=function(e){if(!this.options.log)return e;const _=n.LOGFBASE;return t=_,i=1+e*(_-1),Math.log(i)/Math.log(t);var t,i},n.prototype.setValue=function(e,_,t){if((0,i.hasClass)(this._el,"active")&&!t)return;const o=t?this._logf(e):e;if(this._currValue==o)return;this._currValue=o;let s=t?e:this._unlogf(e);s=100*s+"%",(0,i.setStyle)(this._amountEl,{width:s}),(0,i.setStyle)(this._handlerEl,{left:s}),!_&&this._onValueChange()},n.prototype.setBackValue=function(e){(0,i.toggleClass)(this._backEl,"slider_back_transition",e>this._backValue),this._backValue=e;const _=100*e+"%";(0,i.setStyle)(this._backEl,{width:_})},n.prototype._onValueChange=function(){this._lastValue=this._lastValue||0,this._lastValue!=this._currValue&&(this._lastValue=this._currValue,this.options.onChange&&this.options.onChange(this._currValue))};const r=n},109507:(e,_,t)=>{function i(e){switch(e.type){case"action":return e;case"link":{const{href:_,...t}=e;return{...t,type:"action",action:()=>{window.open(_,"_blank")?.focus()}}}}}t.d(_,{mapChoiceToActionChoice:()=>i})},982335:(e,_,t)=>{t.d(_,{CatalogBannerStatCollector:()=>s});var i=t(317216),o=t(314309);class s{destroy(){this.observer.disconnect(),this.observed_items.forEach(((e,_)=>this.sendViewStat(_))),this.elements.forEach((e=>e.removeEventListener("mousedown",this.clickHandler)))}addHandlers(){this.clickHandler=this.onClick.bind(this),this.elements.forEach((e=>e.addEventListener("mousedown",this.clickHandler))),this.elements.forEach((e=>this.observer.observe(e)))}onClick(e){if(e.currentTarget&&e.currentTarget instanceof HTMLElement&&e.currentTarget.parentElement&&e.currentTarget.dataset.id){const _=parseInt(e.currentTarget.dataset.id),t={type:i.ClickProductionStatEventTypes.TYPE_CATALOG_BANNER_ITEM,position:[...e.currentTarget.parentElement.children].indexOf(e.currentTarget)+1},o={type:i.EventItemType.CATALOG_BANNER,id:_,track_code:this.blockId};this.clickCollector.logEvent(t,o)}}sendViewStat(e){if(void 0!==this.observed_items[e]){const _={...this.observed_items[e],end_view:this.productCollector.getCurrentTime()},t={type:i.EventItemType.CATALOG_BANNER,id:e,track_code:this.blockId};this.viewCollector.logEvent(_,t),delete this.observed_items[e]}}onView(e){e.forEach((e=>{const _=e.target;if(_ instanceof HTMLElement&&_.parentElement&&_.dataset.id){const t=parseInt(_.dataset.id);e.isIntersecting?void 0===this.observed_items[t]&&(this.observed_items[t]={type:i.ViewProductionStatEventTypes.TYPE_CATALOG_BANNER_ITEM,start_view:this.productCollector.getCurrentTime(),end_view:"0",position:[..._.parentElement.children].indexOf(_)+1}):this.sendViewStat(t)}}))}constructor(e,_){this.blockId=_;this.observed_items=[],this.observer=new IntersectionObserver((e=>this.onView(e)),{root:null,rootMargin:"0px",threshold:.5}),this.productCollector=new o.ProductionStatCollector,this.viewCollector=new o.ViewStatCollector(this.productCollector),this.clickCollector=new o.ClickStatCollector(this.productCollector),this.elements=e,this.addHandlers()}}},241503:(e,_,t)=>{t.d(_,{BannersController:()=>s,ConsumeReason:()=>i});var i,o=t(982335);!function(e){e.Click="click",e.Close="close"}(i||(i={}));class s{getBanners(){return Array.from(this.blockContent.querySelectorAll(".BannerItem"))}setBannersEvents(){this.getBanners().forEach((e=>{if(e.dataset.id){const _=parseInt(e.dataset.id);this.addConsumableClick(e,_),this.addConsumableCloseClick(e,_)}}))}checkItems(){this.getBanners().length||this.blockContent&&this.blockContent.remove()}destroy(){this.bannerStatCollector.destroy()}onDataLoad(){}constructor(e,_){this.blockContent=e,this.blockId=_;const t=this.getBanners();this.bannerStatCollector=new o.CatalogBannerStatCollector(t,_)}}},830772:(e,_,t)=>{t(474848),t(216447),t(524598),t(454154)},118096:(e,_,t)=>{t(830772)},996544:(e,_,t)=>{t(474848),t(47677),t(800483),t(454154)},728611:(e,_,t)=>{t(996544)},160919:(e,_,t)=>{t(118096),t(728611)},646995:(e,_,t)=>{t.d(_,{AudioBroadcastIconButton:()=>l});var i=t(474848),o=t(843250),s=t(271036),a=t(723723);const l=({active:e,..._})=>(0,i.jsx)(s.IconButton,{draggable:!1,..._,children:(0,i.jsx)(o.Icon24Broadcast,{className:(0,a.getColorClass)(e?"color_icon_accent":"color_icon_secondary")})})},959633:(e,_,t)=>{t.d(_,{AudioBroadcastIconButton:()=>i.AudioBroadcastIconButton});var i=t(646995)},55287:(e,_,t)=>{t.d(_,{AudioDislikeIconButton:()=>n});var i=t(474848),o=t(346225),s=t(339414),a=t(271036),l=t(723723);const n=({added:e,..._})=>{const t=e?o.Icon24ThumbsDown:s.Icon24ThumbsDownOutline;return(0,i.jsx)(a.IconButton,{draggable:!1,..._,children:(0,i.jsx)(t,{className:(0,l.getColorClass)("color_icon_secondary")})})}},841037:(e,_,t)=>{t.d(_,{AudioDislikeIconButton:()=>i.AudioDislikeIconButton});var i=t(55287)},102883:(e,_,t)=>{t.d(_,{AudioFavoritesIconButton:()=>n});var i=t(474848),o=t(68177),s=t(524598),a=t(271036),l=t(723723);const n=({added:e,..._})=>{const t=e?o.Icon24Bookmark:s.Icon24BookmarkOutline;return(0,i.jsx)(a.IconButton,{..._,draggable:!1,children:(0,i.jsx)(t,{className:(0,l.getColorClass)("color_icon_secondary")})})}},46055:(e,_,t)=>{t.d(_,{AudioFavoritesIconButton:()=>i.AudioFavoritesIconButton});var i=t(102883)},41637:(e,_,t)=>{t.d(_,{AudioLyricsIconButton:()=>l});var i=t(474848),o=t(994492),s=t(271036),a=t(723723);const l=e=>(0,i.jsx)(s.IconButton,{draggable:!1,...e,children:(0,i.jsx)(o.Icon24TextTtOutline,{className:(0,a.getColorClass)("color_icon_secondary")})})},680596:(e,_,t)=>{t.d(_,{AudioLyricsIconButton:()=>i.AudioLyricsIconButton});var i=t(41637)},450973:(e,_,t)=>{t.d(_,{AudioRecomsIconButton:()=>l});var i=t(474848),o=t(262203),s=t(271036),a=t(723723);const l=e=>(0,i.jsx)(s.IconButton,{draggable:!1,...e,children:(0,i.jsx)(o.Icon24StarsOutline,{className:(0,a.getColorClass)("color_icon_secondary")})})},64399:(e,_,t)=>{t.d(_,{AudioRecomsIconButton:()=>i.AudioRecomsIconButton});var i=t(450973)},547725:(e,_,t)=>{t.d(_,{AudioRepeatIconButton:()=>r});var i=t(474848),o=t(14323),s=t(657967),a=t(723723),l=t(271036);const n={"not-repeat":(0,i.jsx)(o.Icon24RepeatOutline,{className:(0,a.getColorClass)("color_icon_secondary")}),repeat:(0,i.jsx)(o.Icon24RepeatOutline,{className:(0,a.getColorClass)("color_icon_accent")}),"repeat-one":(0,i.jsx)(s.Icon24Repeat1Outline,{className:(0,a.getColorClass)("color_icon_accent")})},r=({state:e,..._})=>(0,i.jsx)(l.IconButton,{draggable:!1,..._,children:n[e]})},775907:(e,_,t)=>{t.d(_,{AudioRepeatIconButton:()=>i.AudioRepeatIconButton});var i=t(547725)},675359:(e,_,t)=>{t.d(_,{AudioShareIconButton:()=>l});var i=t(474848),o=t(48269),s=t(271036),a=t(723723);const l=e=>(0,i.jsx)(s.IconButton,{draggable:!1,...e,children:(0,i.jsx)(o.Icon24ShareOutline,{className:(0,a.getColorClass)("color_icon_secondary")})})},298921:(e,_,t)=>{t.d(_,{AudioShareIconButton:()=>i.AudioShareIconButton});var i=t(675359)},926387:(e,_,t)=>{t.d(_,{AudioShuffleIconButton:()=>l});var i=t(474848),o=t(677467),s=t(271036),a=t(723723);const l=({active:e,..._})=>(0,i.jsx)(s.IconButton,{..._,draggable:!1,children:(0,i.jsx)(o.Icon24ShuffleOutline,{className:(0,a.getColorClass)(e?"color_icon_accent":"color_icon_secondary")})})},892187:(e,_,t)=>{t.d(_,{AudioShuffleIconButton:()=>i.AudioShuffleIconButton});var i=t(926387)},751344:(e,_,t)=>{t.d(_,{AudioBroadcastIconButton:()=>d.AudioBroadcastIconButton,AudioDislikeIconButton:()=>i.AudioDislikeIconButton,AudioFavoritesIconButton:()=>o.AudioFavoritesIconButton,AudioLyricsIconButton:()=>s.AudioLyricsIconButton,AudioRecomsIconButton:()=>a.AudioRecomsIconButton,AudioRepeatIconButton:()=>l.AudioRepeatIconButton,AudioShareIconButton:()=>r.AudioShareIconButton,AudioShuffleIconButton:()=>n.AudioShuffleIconButton});var i=t(841037),o=t(46055),s=t(680596),a=t(64399),l=t(775907),n=t(892187),r=t(298921),d=t(959633)},678949:(e,_,t)=>{t.d(_,{AudioRecomsIconLink:()=>l});var i=t(474848),o=t(279734),s=t(751344),a=t(55379);function l({href:e,target:_,onClick:t,...l}){return e?(0,i.jsx)(o.Link,{href:e,target:_,className:a.default.link,children:(0,i.jsx)(s.AudioRecomsIconButton,{hoverMode:"opacity",activeMode:"opacity",noPadding:!0,...l})}):t?(0,i.jsx)(s.AudioRecomsIconButton,{hoverMode:"opacity",activeMode:"opacity",noPadding:!0,...l}):function(e){throw new TypeError(`Unexpected props ${e} for component AudioRecomsIconLink`)}(l)}},766639:(e,_,t)=>{t.d(_,{AudioRecomsIconLink:()=>i.AudioRecomsIconLink});var i=t(678949)},312712:(e,_,t)=>{t.d(_,{AudioRecomsIconLink:()=>i.AudioRecomsIconLink});var i=t(766639)},207881:(e,_,t)=>{t.d(_,{AudioBroadcastIconButton:()=>i.AudioBroadcastIconButton,AudioDislikeIconButton:()=>i.AudioDislikeIconButton,AudioFavoritesIconButton:()=>i.AudioFavoritesIconButton,AudioLyricsIconButton:()=>i.AudioLyricsIconButton,AudioRecomsIconLink:()=>o.AudioRecomsIconLink,AudioRepeatIconButton:()=>i.AudioRepeatIconButton,AudioShareIconButton:()=>i.AudioShareIconButton,AudioShuffleIconButton:()=>i.AudioShuffleIconButton});var i=t(751344),o=t(312712);t(160919)},948188:(e,_,t)=>{t.d(_,{formatAudioTime:()=>o});var i=t(353557);function o({duration:e,progress:_,negative:t}){return t&&_<1?"-"+(0,i.formatTime)(Math.round(e-_*e)):(0,i.formatTime)(Math.round(_*e))}},686408:(e,_,t)=>{function i(e){let _=e.split(" ");_=_.slice(0,_.length-1);let t=_.join(" ");return t&&(t+="..."),t}function o(e,_=0){if(e.scrollHeight/e.clientHeight>1.1){let t=e.clientHeight,o=e.innerText;for(;o&&e.scrollHeight/t>1.1&&e.innerText.split(" ").length>_;)o=i(o),e.innerHTML=o}}t.d(_,{truncateMultilineText:()=>o})},961745:(e,_,t)=>{t.d(_,{useUpdateEffect:()=>o,useUpdateLayoutEffect:()=>s});var i=t(296540);const o=a(i.useEffect),s=a(i.useLayoutEffect);function a(e){return function(_,t){const o=(0,i.useRef)();e((()=>{if(o.current)return _();o.current=!0}),t)}}},255520:(e,_,t)=>{t.d(_,{initReactApp:()=>o});var i=t(440961);function o(e,_,t){e&&(i.render(_,e),t||window.cur.destroy?.push((()=>{e&&i.unmountComponentAtNode(e)})))}},335423:(e,_,t)=>{t.d(_,{AudioCatalogVkMixBlockTq:()=>l});var i=t(474848),o=t(255520),s=t(310619),a=t(502722);const l=({payload:{target:e,data:_}})=>{if(!e)throw new Error("AudioCatalogVkMixBlock: Missing target");const{items:t,block:l,needShowOnboarding:n}=_;(0,o.initReactApp)(e,(0,i.jsx)(a.AudioCatalogMusicMixBlockApplication,{id:t[0].id,backgroundAnimationUrl:t[0].background_animation_url,description:(0,s.decodeHTML)(t[0].description),header:(0,s.decodeHTML)(t[0].title),title:(0,s.decodeHTML)(t[0].stream_mix.title),style:l.layout.style||"default",needShowOnboarding:n}))}},390552:(e,_,t)=>{t.d(_,{AudioPlayerBlockTq:()=>s});var i=t(683066),o=t(142278);const s=({payload:{target:e,data:_}})=>{if(!e)throw new Error("AudioPlayerBlock: Missing target");(0,o.createReactInitiator)(i.AudioPlayerBlockApplication,e,{destroyAfterNavigation:!1}).render({initData:_})}},331600:(e,_,t)=>{t.d(_,{PlaylistLoadingProvider:()=>i});class i{static ensure(){return i.instance||(i.instance=new i),i.instance}addPlaylist(e){this.playlistLoadingSet.add(e)}getSet(){return this.playlistLoadingSet}resetSet(){this.playlistLoadingSet.clear()}constructor(){this.playlistLoadingSet=new Set}}},842372:(e,_,t)=>{t.d(_,{AudioCatalogStatsCollector:()=>c});var i=t(434518),o=t(763812),s=t(331635),a=t(132028),l=t(694132),n=t(314309),r=t(317216),d=t(847154),u=(0,o._)("_clickCollector");class c{logOpenMyMusicPlaylistCreationModal({blockId:e}={}){const _=this.navScreenProvider.catalogSectionId||void 0,t={event:{client_server_time:(0,d.getClientServerTime)(),nav_info:{track_code:_},source_info:{track_code:e}},target_nav_info:[]},o={type:r.ClickProductionStatEventTypes.TYPE_MUSIC_PLAYLIST_TAP_GOTO,[r.ClickProductionStatEventTypes.TYPE_MUSIC_PLAYLIST_TAP_GOTO]:t};(0,i._)(this,u)[u].logEvent(o,{type:r.EventItemType.MUSIC_PLAYLIST_GOTO})}constructor(e){Object.defineProperty(this,u,{writable:!0,value:void 0}),this.navScreenProvider=e;const _=new n.ProductionStatCollector;(0,i._)(this,u)[u]=new n.ClickStatCollector(_)}}c=(0,s.__decorate)([a.scope.container(),(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",[void 0===l.AudioNavScreenProvider?Object:l.AudioNavScreenProvider])],c)},530351:(e,_,t)=>{t.d(_,{AudioCatalogStatsCollector:()=>i.AudioCatalogStatsCollector});var i=t(842372)},66536:(e,_,t)=>{t.d(_,{BannersController:()=>s});var i=t(241503),o=t(761520);class s extends i.BannersController{consumeBanner(e,_){o.ajax.post("/al_audio.php?act=consume_banner",{id:e,ref:this.blockId,reason:_},{onFail:()=>!0})}addConsumableClick(e,_){e.classList.contains("BannerItem--consumable")&&e.dataset.id&&e.addEventListener("click",(()=>this.consumeBanner(_,i.ConsumeReason.Click)))}addConsumableCloseClick(e,_){const t=e.querySelector(".BannerItem__close");t instanceof HTMLElement&&(t.onclick=t=>{this.consumeBanner(_,i.ConsumeReason.Close),e.remove(),this.checkItems(),t.stopPropagation(),t.preventDefault()})}checkItems(){const e=this.getBanners();if(e.length){if(1===e.length){const e=this.blockContent.querySelectorAll(".audio_promo__control");e&&e.forEach((e=>e.remove()))}}else{const e=this.blockContent.parentElement;this.blockContent&&this.blockContent.remove(),e&&!e.childElementCount&&e.remove()}}constructor(e,_){super(e,_),this.setBannersEvents()}}},155502:(e,_,t)=>{t.d(_,{BaseController:()=>a});var i=t(963116),o=t(459831),s=t(826332);class a{fetchNext(){return this.fetchSection(this.id,this.nextFrom)}fetchSection(e,_,t={}){return this.fetchInProgress=!0,new Promise(((i,o)=>{const s={section_id:e,start_from:_,...t};window.nav.objLoc.claim&&(s.claim=window.nav.objLoc.claim),window.ajax.post("al_audio.php?act=load_catalog_section",s,{onDone:(e,_,t)=>{this.fetchInProgress=!1,i({blocks:e,data:_,blockItems:t})},onFail:()=>(o(),this.fetchInProgress=!1,!0)})}))}getId(){return this.id}static getHint(e,_){switch(_.type){case i.HintType.Tooltip:return new o.TooltipHint(_,e);case i.HintType.Highlight:return new s.HighlightHint(_,e)}return null}}},351129:(e,_,t)=>{t.d(_,{BlockController:()=>y});var i=t(150681),o=t(983567),s=t(925537),a=t(155502),l=t(948057),n=t(955377),r=t(335700),d=t(257168),u=t(66536),c=t(754866),E=t(3850),h=t(688344),P=t(761520),p=t(466247),g=t(392358);class y extends a.BaseController{initSpecificBlockController(){if(this.blockContent)switch(this.blockContent.dataset.type){case"catalog_banners":this.specificController=new u.BannersController(this.blockContent,this.getId());break;case"artist":case"curator":this.specificController=new p.MusicAuthorController(this.blockContent)}}enable(){this.reorderer&&this.reorderer.enable()}disable(){this.blockAutoList&&this.blockAutoList.destroy(),this.reorderer&&this.reorderer.disable()}emitEvent(e){if(this.listenEvents.includes(e))if(e===g.events.PLACEHOLDER_REMOVE)this.removeBlock();else this.reloadData()}initSearch(){const e=this.block.getElementsByClassName("ui_search");e.length&&Array.prototype.forEach.call(e,(e=>d.default.init(e)))}initListenEvents(){if(this.blockContent?.dataset.listenEvents)try{this.listenEvents=JSON.parse(this.blockContent?.dataset.listenEvents)}catch(e){}}onSectionInit(){this.blockItemsContainer&&this.blockItemsContainer.classList.contains(s.BLOCK_ITEMS_REORDERABLE)&&this.initListReorder("current"!==this.section.name)}hasBlockName(e){return this.blockContent&&this.blockContent.classList.contains(`${s.BLOCK_ELEMENT}__${e}`)}reloadData(){this.fetchSection(this.id,"").then((({blockItems:e,data:_})=>{if(this.setItems(y.createNodesFromItems(e)),_.playlists&&_.playlists.length){const e=(0,o.getAudioPlayer)();e&&e.addWithReplacePlaylists(_.playlists.filter(Boolean))}})).catch((()=>!0))}setFromBlockContent(){if(this.blockContent=this.block.classList.contains(s.BLOCK_CONTENT)?this.block:this.block.querySelector(`.${s.BLOCK_CONTENT}`),this.blockContent){this.id=this.blockContent.dataset.id||"",this.nextFrom=this.blockContent.dataset.next||"",this.dataType=this.blockContent.dataset.type||null;const e=this.blockContent.classList.toString().match(/CatalogBlock__layout--(.*)/);this.layoutName=e&&e[1]}}removeBlock(){this.destroy();const e=this.block.closest(`.${s.BLOCK_ELEMENT}`);let _=this.block;e instanceof HTMLElement&&1===e.childElementCount&&(_=e),_.remove()}clearList(){this.blockItemsContainer&&(this.blockItemsContainer.innerHTML="")}destroy(){this.blockAutoList&&this.blockAutoList.destroy(),this.reorderer&&this.reorderer.destroy(),this.specificController&&this.specificController.destroy()}hideLoader(){this.loader&&(this.loader.style.display="none")}showLoader(){this.loader&&(this.loader.style.display="")}setNextFrom(e){this.nextFrom=e,this.blockContent&&(this.blockContent.dataset.next=this.nextFrom)}setId(e){this.id=e,this.blockContent&&(this.blockContent.dataset.id=this.id),this.blockItemsContainer&&this.blockItemsContainer.dataset.playlistId&&(this.blockItemsContainer.dataset.playlistId=this.id)}setItems(e){if(this.blockItemsContainer&&this.dataType&&this.layoutName){new E.BlockItemsReplacer(this.blockItemsContainer,this.dataType,this.layoutName).replaceItems(e)}}resetItems(){this.blockItemsContainer&&(this.clearItems(),this.blockItemsContainer.append(...this.initialItems))}clearItems(){this.blockItemsContainer&&(this.blockItemsContainer.innerHTML="")}initAutoList(e=[]){let _=e;this.blockItemsContainer&&(this.blockAutoList&&this.blockAutoList.destroy(),this.blockAutoList=new i.default(this.blockItemsContainer,{scrollNode:!1,onRendered:()=>{(0,o.getAudioPlayer)().updateCurrentPlaying(),this.specificController&&this.specificController.onDataLoad()},onNoMore:()=>this.hideLoader(),onNeedRows:e=>{if(this.showLoader(),_.length){const t=_;return _=[],void e(t)}this.nextFrom?this.fetchNext().then((({blockItems:_,data:t})=>{this.setNextFrom(t.nextFrom),this.dataType===h.DataType.RadioStations&&t.playlist&&y.mergePlaylistFromPaginatedResponse(t.playlist),e(_)})).catch((()=>{})):e(null)}}))}updateListReorder(){this.reorderer&&this.reorderer.update()}initListReorder(e=!0){let _;switch(this.dataType){case h.DataType.MusicAudios:_=(_,t,i)=>this.onAudioBlockReorder(_,t,i,e);break;case h.DataType.MusicPlaylists:_=this.onPlaylistsBlockReorder.bind(this);break;default:_=()=>{}}this.reorderer=new n.default(this.blockItemsContainer,"",{onReorder:_.bind(this)})}onAudioBlockReorder(e,_,t,i){window.currentAudioPage(this.block).onAudioRowsReorder(!i,e,_,t)}onPlaylistsBlockReorder(e,_,t){window.currentAudioPage(this.block).onPlaylistsReorder(e,_,t)}static mergePlaylistFromPaginatedResponse(e){const _=(0,o.getAudioPlayer)(),t=_.getPlaylist(e.type,e.ownerId,e.id);_.mergePlaylistData(t,e)}initSortSelector(){const e=this.block.querySelector(`.${s.SORTER_ACTION}`);e&&(this.sortSelector=new l.BlockSorter(e,(e=>{P.ajax.post("/al_audio.php?act=replace_blocks",{replacement_ids:e},{onDone:e=>this.section.replaceBlocks(e.replacements,e.nextFrom,e.playlists)})})))}initGallery(){this.blockItemsContainer&&this.blockItemsContainer.classList.contains(s.GALLERY)&&(this.gallery=new r.UIGallery(this.blockItemsContainer,{scrollY:!1}))}static search(e,_,t,i){const o=y.findBlockById(e,i.target);o&&!o.fetchInProgress&&(t?o.fetchSection(_,"",{search_query:t}).then((({blockItems:e})=>{o.setItems(y.createNodesFromItems(e))})).catch((()=>!0)):o.resetItems())}static showMore(e,_){const t=y.findBlockById(e,_);t&&!t.fetchInProgress&&t.fetchNext().then((({blockItems:e,data:_})=>{t.setItems(y.createNodesFromItems(e)),t.nextFrom=_.nextFrom})).catch((()=>!0))}static findBlockById(e,_){const t=window.currentAudioPage(_).catalogController.currentSection;return t?t.getBlockById(e):null}static findBlockByElement(e){const _=(0,c.gpeByClass)("CatalogBlock__content",e),t=_?.dataset.id;return t||null}static createNodesFromItems(e){return e.map((e=>{const _=document.createElement("template");return _.innerHTML=e,_.content.firstElementChild})).filter((e=>!!e))}initHints(){if(this.block.dataset.catalogHintId){const e=this.section.getHintById(this.block.dataset.catalogHintId);if(e){const _=a.BaseController.getHint(this.block,e);if(_){const t=this.section.hintsToShow.findIndex((e=>_.id===e.id&&e.initialElement.parentElement===_.initialElement.parentElement));if(t>-1){const _=this.section.hintsToShow[t],i=_.initialElement.parentElement||_.initialElement,o=a.BaseController.getHint(i,e);o&&(this.section.hintsToShow[t]=o)}else this.section.hintsToShow.push(_)}delete this.block.dataset.catalogHintId}}const e=this.block.querySelectorAll("[data-catalog-hint-id]");if(e.length){const _={};e.forEach((e=>{e.dataset.catalogHintId&&(Array.isArray(_[e.dataset.catalogHintId])?_[e.dataset.catalogHintId].push(e):_[e.dataset.catalogHintId]=[e],delete e.dataset.catalogHintId)})),Object.entries(_).forEach((([e,_])=>{const t=this.section.getHintById(e);if(!t)return;let i;i=1===_.length?_[0]:this.block;const o=a.BaseController.getHint(i,t);o&&this.section.hintsToShow.push(o)}))}}constructor(e,_){super(),this.section=e,this.block=_,this.listenEvents=[],this.setFromBlockContent(),this.blockItemsContainer=_.querySelector(`.${s.BLOCK_ITEMS_CONTAINER}`),this.blockItemsContainer&&(this.initialItems=[...this.blockItemsContainer.children]),this.initSpecificBlockController(),this.initGallery(),this.loader=_.getElementsByClassName(s.AUTO_LIST_LOADER)[0],this.initSearch(),this.initSortSelector(),this.initHints(),this.initListenEvents()}}},3850:(e,_,t)=>{t.d(_,{BlockItemsReplacer:()=>s});var i=t(688344),o=t(26345);class s{replaceItems(e){switch(this.dataType){case i.DataType.MusicAudios:this.replaceItemsBase(e);break;case i.DataType.MusicPlaylists:this.replaceMusicPlaylists(e);break;case i.DataType.MusicOwners:this.replaceMusicOwners(e);break;default:this.replaceItemsBase(e)}}replaceMusicPlaylists(e){let _=e;this.layoutName===o.LayoutName.LargeSlider&&(_=e.slice(0,5)),this.replaceItemsBase(_)}replaceItemsBase(e){this.container.innerHTML="",this.container.append(...e)}replaceMusicOwners(e){const _=e[0];if(_){const e=_.querySelector(".MusicOwnerCell__actions");if(e){const _=this.container.querySelector(".MusicOwnerCell__actions");if(_)_.innerHTML=e.innerHTML;else{const _=this.container.querySelector(".MusicOwnerCell__after");_&&_.appendChild(e)}}}}constructor(e,_,t){this.container=e,this.dataType=_,this.layoutName=t}}},948057:(e,_,t)=>{t.d(_,{BlockSorter:()=>s});var i=t(925537),o=t(428374);class s{getConfig(){const e=this.element.querySelector(`.${i.SORTER_ACTION_DATA}`);if(!e)return null;const _=Array.from(e.querySelectorAll("li"));if(0===_.length)return null;const t={};return t.items=_.map((e=>{const _=e.dataset.id||"";return e.dataset.selected&&(t.selected=_),[_,e.innerText]})),t.withArrow=!0,e.remove(),t}constructor(e,_){this.element=e;const t=this.getConfig();this.dropdown=new o.InlineDropdown(e,{onSelect:_,...t})}}},855776:(e,_,t)=>{t.d(_,{CatalogController:()=>o});var i=t(978068);class o{setSection(e,_,t){this.sections[e]&&this.sections[e].getId()===t.sectionId?(this.currentSection=this.sections[e],this.enableSection(e)):(this.currentSection=new i.SectionController(_,t,this),this.sections[e]=this.currentSection)}disableSection(e){this.sections[e]&&this.sections[e].disable()}enableSection(e){this.sections[e]&&this.sections[e].enable()}emitEvent(e,_){Object.values(this.sections).forEach((t=>t.emitEvent(e,_)))}deleteSection(e){const _=this.sections[e];_&&(_.destroy(),delete this.sections[e])}destroy(){Object.entries(this.sections).forEach((([,e])=>{e.destroy()})),this.headerSection&&this.headerSection.destroy()}updateSectionReorder(){this.currentSection&&this.currentSection.updateReorder()}initBlocksManually(){this.currentSection=new i.SectionController(this.root,{nextFrom:"",isBlockPagination:!1,sectionId:"",name:""},this),this.currentSection.initBlocksManually()}constructor(e){this.sections={},this.root=e;const _=this.root.querySelector(".CatalogSection--header_section");_ instanceof HTMLElement&&(this.headerSection=new i.SectionController(_,{})),this.tabs=Array.from(this.root.querySelectorAll("._audio_section_tab .ui_tab"))}}},826332:(e,_,t)=>{t.d(_,{HighlightHint:()=>l});var i=t(963116),o=t(727076),s=t(402096),a=t(672277);class l extends o.Hint{show(){this.highlight=new s.default(this.initialElement,this.generateContent(),this.options),(0,a.disableBodyScroll)(),this.highlight.showTT()}hide(){this.highlight.hideTT(),(0,a.enableBodyScroll)(),super.hide()}constructor(e,_){super(i.HintType.Highlight,e),this.initialElement=_,this.options={highlight:!0,width:280,offset:[0,-17],scrollOffset:40,side:"bottom"},e.unskipable?this.options.ttOnHide=()=>{}:this.options.onBGClick=()=>this.hide()}}},727076:(e,_,t)=>{t.d(_,{Hint:()=>a});var i=t(102088),o=t(972332),s=t(761520);class a{hide(){this.onHide&&this.onHide(),s.ajax.post("al_index.php",{act:"help_hints_hide",hint_id:this.hintId,hash:this.hideHash})}generateContent(){let e=document.createElement("div");if(this.title&&(e.innerHTML+=`<div class="CatalogHint__title">${this.title}</div>`),this.text&&(e.innerHTML+=`<div class="CatalogHint__text">${this.text}</div>`),this.actions){const _=document.createElement("div");_.classList.add("CatalogHint__actions");let t=this.actions.map((e=>{const _=document.createElement("a");switch(_.classList.add("flat_button"),e.type){case"open_url":_.href=e.url,_.onclick=_=>{window.nav.go(e.url),this.hide(),(0,o.cancelEvent)(_)};break;case"switch_section":_.onclick=t=>{(0,o.cancelEvent)(t);window.currentAudioPage(_).catalogController.currentSection.switchSection(e.targetSectionId),this.hide()}}return _.innerHTML=e.label,_}));if(_.append(...t),this.tutorialSteps){const e=document.createElement("div");e.classList.add("CatalogHint__tutorialSteps"),e.innerHTML=(0,i.langStr)(i.getLang("audio_onboarding_tutorial_progress"),"step",this.tutorialSteps.current,"total_steps",this.tutorialSteps.total),_.append(e)}e.append(_)}return e}constructor(e,_){this.type=e,this.id=_.id,this.title=_.title,this.text=_.text,this.hintId=_.hintId,this.hideHash=_.hideHash,this.actions=_.actions,_.currentStep&&_.totalSteps&&(this.tutorialSteps={current:_.currentStep,total:_.totalSteps})}}},963116:(e,_,t)=>{var i;t.d(_,{HintType:()=>i}),function(e){e.Tooltip="tooltip",e.Highlight="highlight"}(i||(i={}))},459831:(e,_,t)=>{t.d(_,{TooltipHint:()=>a});var i=t(963116),o=t(727076),s=t(250598);class a extends o.Hint{show(){this.tooltip.show()}constructor(e,_){let t=_,o="center",a="top";(_.classList.contains("CatalogBlock__layout--header")||_.classList.contains("CatalogBlock__layout--header_extended"))&&(t=_.querySelector(".CatalogBlock__title")||_,o="left"),_.classList.contains("MusicAuthor__follow_btn")&&(o="right",a="bottom"),super(i.HintType.Tooltip,e),this.initialElement=_;const l={force_side:a,align:o,offset_left:0,offset_top:0,width:"250px",...e};this.tooltip=new s.ElementTooltip(t,{content:this.title||this.text||"",cls:`feature_intro_tt ${this.id} CatalogTooltip`,forceSide:l.force_side,align:l.align,width:l.width,offset:[l.offset_left,l.offset_top],autoShow:!1,onHide:()=>this.hide()})}}},466247:(e,_,t)=>{t.d(_,{MusicAuthorController:()=>o});var i=t(686408);class o{truncateName(){const e=this.blockContent.querySelector(".MusicAuthor_block__title");if(e instanceof HTMLElement){(0,i.truncateMultilineText)(e);parseInt(getComputedStyle(e).lineHeight)===e.clientHeight&&e.classList.add("MusicAuthor_block__title--singleLine"),e.classList.remove("MusicAuthor_block__title--hidden")}}destroy(){}onDataLoad(){}constructor(e){this.blockContent=e,this.truncateName()}}},978068:(e,_,t)=>{t.d(_,{SectionController:()=>d});var i=t(138586),o=t(983567),s=t(150681),a=t(351129),l=t(925537),n=t(155502),r=t(826332);class d extends n.BaseController{showHints(){if(this.hintsToShow.length){let e;const _=this.hintsToShow.filter((e=>e instanceof r.HighlightHint));_.length?(e=_[0],this.hintsToShow.splice(this.hintsToShow.indexOf(e),1),e.onHide=()=>this.showHints(),e.show()):this.hintsToShow.forEach((e=>e.show()))}}initBlocksManually(){this.initBlocks()}getSectionElement(){return this.sectionEl}enable(){this.initSectionAutoList(),this.blocks.forEach((e=>e.enable()))}disable(){this.sectionAutoList&&this.sectionAutoList.destroy(),this.blocks.forEach((e=>e.disable()))}emitEvent(e,_){this.blocks.forEach((t=>{_&&_!==t.getId()||t.emitEvent(e)}))}switchSection(e){const _=this.catalogController?.tabs;_&&_.forEach((_=>{_.dataset.sectionId===e&&_.click()}))}replaceBlocks(e,_,t){let i=!1;t&&this.addPlaylists(t),e.forEach((e=>{const _=e.fromIds.map((e=>this.getBlockById(e))).filter((e=>null!==e));let t=null;if(_.length&&_[_.length-1]?.block&&(t=_[_.length-1].block),!t)return;const o=a.BlockController.createNodesFromItems(e.toBlocks);o.forEach((e=>t?.insertAdjacentElement("beforebegin",e))),i=i||_.some((e=>e===this.paginatedBlockController)),_.forEach((e=>{e.block.remove(),e.destroy(),this.blocks=this.blocks.filter((_=>_!==e))}));const s=o.map((e=>new a.BlockController(this,e)));this.blocks.push(...s),this.hideShowMoreLoaders()})),"string"==typeof _&&this.setNextFrom(_),i&&(this.initPaginatedBlock(),_&&(this.isBlockPagination?this.initBlockAutoList([],this.nextFrom):this.sectionAutoList.isDone()&&this.initSectionAutoList()))}sectionInited(){this.blocks.forEach((e=>e.onSectionInit()))}initTabsHints(){const e=this.catalogController?.tabs;e&&e.forEach((e=>{if(e.dataset.catalogHintId){const _=this.getHintById(e.dataset.catalogHintId);if(_){const t=n.BaseController.getHint(e,_);t&&this.hintsToShow.push(t),delete e.dataset.catalogHintId}}}))}getHintById(e){return this.sectionData.hints&&this.sectionData.hints[e]||null}destroy(){this.sectionAutoList&&this.sectionAutoList.destroy(),this.blocks&&this.blocks.forEach((e=>e.destroy()))}getBlockById(e){return this.blocks&&this.blocks.find((_=>_.getId()===e))||null}reloadBlock(e){const _=this.findBlockByBlockName(e);_&&_.reloadData()}updateReorder(){this.blocks&&this.blocks.forEach((e=>{e.updateListReorder()}))}hideShowMoreLoaders(){this.blocks.forEach((e=>e.hideLoader()))}addPlaylists(e){e.forEach((e=>{e&&new i.AudioPlaylist(e)}))}setPagePlaylist(e){const _=window.currentAudioPage(this.sectionEl);let t=(0,o.getAudioPlayer)().getPlaylist(e.type,e.ownerId,e.id,"",e.blockId);t.mergeWith(e),t.getAudiosCount()||t.load(),_.setPagePlaylist(t)}setNextFrom(e){this.nextFrom=e,this.sectionEl&&(this.sectionEl.dataset.next=e)}initSectionAutoList(){this.sectionAutoList&&this.sectionAutoList.destroy(),this.sectionAutoList=new s.default(this.sectionEl,{fetchImmediate:!1,onNeedRows:e=>{if(this.isBlockPagination)return this.initBlockAutoList(),void e(null);this.nextFrom?(this.paginatedBlockController?.showLoader(),this.fetchNext().then((({blocks:_,data:t,blockItems:i})=>{if(this.setNextFrom(t.nextFrom),t.isBlockPagination||t.blockIds&&1===t.blockIds.length&&this.getBlockById(t.blockIds[0])){if(e(null),this.isBlockPagination=this.isBlockPagination||t.isBlockPagination,this.initBlockAutoList(i,this.nextFrom),t.playlist&&"search"===t.playlist.type){(0,o.getAudioPlayer)().getPlaylist().sendSearchStats("search_view")}}else t.playlists&&this.addPlaylists(t.playlists),e(_||null),this.initBlocks()})).catch((()=>{}))):e(null)}})}initBlocks(){this.blocks=[];const e=[];[...this.sectionEl.getElementsByClassName(l.BLOCK_ELEMENT)].forEach((_=>{_.classList.contains(l.BLOCK_DIVIDED)?_.querySelectorAll(`.${l.BLOCK_CONTENT}`).forEach((_=>e.push(_))):e.push(_)})),this.blocks=e.map((e=>new a.BlockController(this,e))),this.initPaginatedBlock()}initPaginatedBlock(){const e=this.sectionEl.querySelector(`.${l.PAGINATED_BLOCKS_CONTAINER}`);if(e){const _=[...e.getElementsByClassName(l.BLOCK_CONTENT)],t=_[_.length-1].dataset.id;t&&(this.paginatedBlockController=this.getBlockById(t))}else this.paginatedBlockController=this.blocks[this.blocks.length-1]}initBlockAutoList(e=[],_){this.paginatedBlockController&&(void 0!==_&&this.paginatedBlockController.setNextFrom(_),this.paginatedBlockController.initAutoList(e))}findBlockByBlockName(e){return this.blocks.find((_=>_.hasBlockName(e)))}constructor(e,_,t){super(),this.sectionData=_,this.catalogController=t,this.blocks=[],this.hintsToShow=[];const i=e.classList.contains(l.SECTION)?e:e.querySelector(`.${l.SECTION}`);i?(this.sectionEl=i,this.name=_.name,this.initTabsHints(),this.initBlocks(),this.nextFrom=void 0===this.sectionEl.dataset.next?_.nextFrom:this.sectionEl.dataset.next,this.id=_.sectionId,_.playlists&&_.playlists.length&&this.addPlaylists(_.playlists),_.playlist&&this.setPagePlaylist(_.playlist),this.isBlockPagination=this.sectionData.isBlockPagination,this.initSectionAutoList(),this.hideShowMoreLoaders(),this.sectionInited(),this.showHints()):this.sectionEl=e}}},688344:(e,_,t)=>{var i;t.d(_,{DataType:()=>i}),function(e){e.MusicAudios="music_audios",e.MusicPlaylists="music_playlists",e.MusicOwners="music_owners",e.RadioStations="radiostations"}(i||(i={}))},26345:(e,_,t)=>{var i;t.d(_,{LayoutName:()=>i}),function(e){e.LargeSlider="large_slider",e.List="list"}(i||(i={}))},925537:(e,_,t)=>{t.d(_,{AUTOPLAY_CONTAINER:()=>y,AUTOPLAY_DISABLED:()=>P,AUTOPLAY_HEADER:()=>g,AUTOPLAY_HEADER_WRAPPER:()=>p,AUTO_LIST_LOADER:()=>d,BLOCK_CONTENT:()=>u,BLOCK_DIVIDED:()=>r,BLOCK_ELEMENT:()=>l,BLOCK_ITEMS_CONTAINER:()=>s,BLOCK_ITEMS_REORDERABLE:()=>a,BLOCK_SEPARATOR:()=>n,GALLERY:()=>h,PAGINATED_BLOCKS_CONTAINER:()=>o,SECTION:()=>i,SORTER_ACTION:()=>c,SORTER_ACTION_DATA:()=>E});const i="CatalogSection",o="CatalogSection__paginatedBlocks",s="CatalogBlock__itemsContainer",a="CatalogBlock__itemsContainer--reorderable",l="CatalogBlock",n="CatalogBlock--separator",r="CatalogBlock--divided",d="CatalogBlock__autoListLoader",u="CatalogBlock__content",c="CatalogBlock__sorter",E="CatalogBlock__sortingData",h="ui_gallery",P="Autoplay--disabled",p="Autoplay--header__wrapper",g="Autoplay--header",y="Autoplay--container"},784818:(e,_,t)=>{t.d(_,{AutoplayBlock:()=>u});var i=t(392358),o=t(423015),s=t(909436),a=t(983567),l=t(925537),n=t(754866),r=t(260152),d=t(471925);class u{onNoMore(){this.uiScroll&&this.uiScroll.emitter.removeListener("more",this.onNeedRows)}init(e,_){if(this.container)throw new Error("AutoplayBlock already initialized");if(!this.autoplayQueue.hasMore&&0===this.autoplayQueue.list.length)return;this.container=e,this.uiScroll=_,this.offset=0,this.isPending=!1;const t=document.createElement("div");t.classList.add(l.BLOCK_ELEMENT,l.AUTOPLAY_CONTAINER),t.innerHTML=`<div class="${l.AUTOPLAY_HEADER_WRAPPER}">\n        <div>\n              <div class="${l.BLOCK_SEPARATOR}">\n                <div class="${l.BLOCK_CONTENT} CatalogBlock__layout--in_block_separator"></div>\n            </div>\n        </div>\n    </div>`,this.audioListContainer=t,t.querySelector(`.${l.AUTOPLAY_HEADER_WRAPPER}`)?.append(this.headerElement),this.renderHeader(),this.container.append(t);const i=this.autoplayQueue.service.$enabled.watch((e=>{e?this.enable():this.disable()}));this.onDestroyCallbacks.push(i)}destroy(){this.disable(),this.headerInitiator.isMounted()&&this.headerInitiator.unmount(),this.container&&(this.container=null,this.audioListContainer?.remove(),this.onDestroyCallbacks.forEach((e=>e())),this.onDestroyCallbacks=[],this.uiScroll?.emitter.removeAllListeners(),this.uiScroll=null)}enable(){if(this.enabled)return;this.audioListContainer?.classList.remove(l.AUTOPLAY_DISABLED),this.uiScroll?.emitter.addListener("more",this.onNeedRows),this.onDisableCallbacks.push((()=>{this.uiScroll?.emitter.removeListener("more",this.onNeedRows)}));const e=this.eventBus.subscribe(i.AudioPlayerEventType.PLAY_TRACK_FROM_AUTOPLAY,this.onAutoplayTrackStart);this.onDisableCallbacks.push(e.unsubscribe),this.enabled=!0,this.offset||this.onNeedRows()}disable(){this.onDisableCallbacks.forEach((e=>e())),this.onDisableCallbacks=[],this.audioListContainer?.classList.add(l.AUTOPLAY_DISABLED),this.enabled=!1}renderHeader(){this.headerInitiator.render({autoplayService:this.autoplayQueue.service})}constructor(){this.autoplayQueue=(0,a.getAudioPlayer)().getPlaylistQueue().autoplayQueue,this.eventBus=(0,a.getAudioPlayer)().getPlaylistQueue().eventBus,this.enabled=!1,this.onDisableCallbacks=[],this.onDestroyCallbacks=[],this.isPending=!1,this.offset=0,this.uiScroll=null,this.container=null,this.audioListContainer=null,this.onAutoplayTrackStart=e=>{const{autoplayQueue:_,container:t,audioListContainer:i}=this;if(!t||!i)return;const s=t.querySelector(".audio_page__audio_rows_list"),a=i.querySelector(`.${l.AUTOPLAY_HEADER_WRAPPER}`),r=(0,o.audioTupleToAudioObject)(e),d=i.querySelector(`[data-full-id="${r?.fullId}"]`);if(!(s&&a&&d&&d.parentNode))return;let u=Array.from(d.parentNode.childNodes);if(!_.hasMore&&0===_.list.length)return s.append(...u.slice(1)),void a.remove();const c=a.offsetHeight,E=d.offsetHeight,h=u.indexOf(d);u=u.slice(1,h+1),requestAnimationFrame((()=>{(0,n.setStyle)(a,{transform:`translateY(${h*E}px)`,transition:"transform  0.5s ease"}),u.forEach((e=>{(0,n.setStyle)(e,{transition:"transform  0.5s ease",transform:`translateY(-${c+18}px)`})}));const e=()=>{(0,n.setStyle)(a,{transition:null,transform:null}),u.forEach((e=>{(0,n.setStyle)(e,{transition:null,transform:null})})),s.append(...u),a.removeEventListener("transitionend",e)};a.addEventListener("transitionend",e)}))},this.onNeedRows=async()=>{try{if(this.isPending)return;this.isPending=!0;const e=this.audioListContainer;if(e){const _=await this.autoplayQueue.getNextAudios(this.offset);if(0===_.length&&!this.autoplayQueue.hasMore)return this.onNoMore();const t=_.map((e=>{const _=s.AudioUtils.drawAudio(e);_.trim();const t=document.createElement("div");return t.innerHTML=_,t.firstChild}));0!==t.length&&(e.append(...t),this.offset+=t.length),this.isPending=!1}}catch(e){this.isPending=!1,console.log(e)}};const e=document.createElement("div");e.classList.add(l.AUTOPLAY_HEADER),this.headerElement=e,this.headerInitiator=(0,r.createReactInitiator)(d.AutoplayHeaderApplication,e,{destroyAfterNavigation:!1})}}},130901:(e,_,t)=>{t.d(_,{AutoplayHeaderApplication:()=>n});var i=t(474848),o=t(293721),s=t(865708),a=t(753457),l=t(690737);function n({autoplayService:e}){const _=(0,o.useStore)(e.$toggleSupported),t=(0,o.useStore)(e.$enabled),n=(0,o.useStore)(e.setEnabledFx.pending);return(0,i.jsx)(s.AppRootProvider,{children:(0,i.jsx)(l.AutoplayHeader,{autoplaySwitch:_&&(0,i.jsx)(a.Switch,{checked:n?!t:t,disabled:n,onChange:_=>{e.setEnabledFx(_.target.checked)}})})})}},690737:(e,_,t)=>{t.d(_,{AutoplayHeader:()=>a});var i=t(474848),o=t(866467),s=t(133385);function a(e){return(0,i.jsxs)("div",{className:s.default.header,children:[(0,i.jsxs)("div",{className:s.default.content,children:[(0,i.jsx)("h2",{className:"CatalogBlock__title",children:o.getLang("audio_autoplay_title")}),(0,i.jsx)("div",{className:"CatalogBlock__subtitle",children:o.getLang("audio_autoplay_subtitle")})]}),(0,i.jsx)("div",{className:s.default.actions,children:e.autoplaySwitch})]})}},471925:(e,_,t)=>{t.d(_,{AutoplayHeaderApplication:()=>i.AutoplayHeaderApplication});var i=t(130901)},581789:(e,_,t)=>{t.d(_,{FullscreenBanner:()=>n});var i=t(761520),o=t(270959),s=t(241503),a=t(314309),l=t(317216);class n{static initiate(e){n.fetch(e).then((({banner:_,bannerId:t})=>_?new n(e,t,_):null)).catch((()=>null))}show(){this.box.show(),this.startView=this.productCollector.getCurrentTime()}hide(){this.box.hide(),this.sendViewStat()}sendViewStat(){const e={end_view:this.productCollector.getCurrentTime(),start_view:this.startView},_={type:l.EventItemType.AUDIO_FULLSCREEN_BANNER,id:this.bannerId,track_code:this.sectionId};this.viewCollector.logEvent(e,_)}static fetch(e){return new Promise(((_,t)=>{i.ajax.post("/audio?act=get_fullscreen_banner",{section_id:e},{onDone:e=>{e?.bannerId?_(e):t()},onFail:()=>(t(),!0)})}))}addEventListeners(){const e=this.box.bodyNode.querySelector(".FullscreenBanner__closeButton");e&&e.addEventListener("click",this.close.bind(this));this.box.bodyNode.querySelectorAll(".FullscreenBanner__button").forEach((e=>{e.addEventListener("click",(()=>{this.consume(e.dataset.reason||s.ConsumeReason.Click),setTimeout((()=>this.hide()))}))}))}close(){this.consume(s.ConsumeReason.Close),this.hide()}consume(e){i.ajax.post("/al_audio.php?act=consume_banner",{id:this.bannerId,type:"fullscreen",track_code:this.sectionId,reason:e})}constructor(e,_,t){this.sectionId=e,this.bannerId=_,this.productCollector=new a.ProductionStatCollector,this.viewCollector=new a.ViewStatCollector(this.productCollector),this.box=new o.MessageBox({bodyStyle:"padding: 0",width:655,containerClass:"FullscreenBanner",noControls:!0,onHide:()=>this.consume(s.ConsumeReason.Close)}),this.box.content(t),this.addEventListeners(),this.show()}}},51885:(e,_,t)=>{t.d(_,{AudioAdActionsModalApplication:()=>d});var i=t(474848),o=t(296540),s=t(507852),a=t(865708),l=t(961745),n=t(109507),r=t(545549);function d({target:e,ad:_,portalRoot:t=null,onClosed:d}){const[u,c]=(0,o.useState)((()=>{const o=_.choices.map(n.mapChoiceToActionChoice);return o.length?(0,i.jsx)(s.DropdownActionSheet,{usePortal:t??!1,shown:!0,onShownChange:e=>{e||c(null)},content:(0,i.jsx)(i.Fragment,{children:o.map((({label:e,action:_},t)=>(0,i.jsx)(s.DropdownActionSheet.Item,{onClick:_,children:e},t)))}),children:(0,i.jsx)(r.ForwardElementRef,{element:e})}):null}));return(0,l.useUpdateEffect)((()=>{u||d()}),[u]),(0,i.jsx)(a.AppRootProvider,{children:u})}},7971:(e,_,t)=>{t.d(_,{AudioAdActionsModalController:()=>a});var i=t(142278),o=t(51885);let s;class a{static ensure(){return s||(s=new a),s}open(e,_,t){this.mount(e,_,t)}close(e){e&&e!==this.currentTarget||this.unmount()}isOpen(e){return(!e||e===this.currentTarget)&&this.initiator.isMounted()}unmount(){this.initiator.unmount(),this.currentTarget=null}mount(e,_,t){this.isOpen(e)||(this.currentTarget=e),this.initiator.render({target:e,ad:_,portalRoot:t,onClosed:this.handleClosed})}constructor(){this.initiator=(0,i.createReactInitiator)(o.AudioAdActionsModalApplication),this.handleClosed=()=>{this.unmount()}}}},43090:(e,_,t)=>{t.d(_,{AudioMediascopeScreenCounter:()=>d});var i=t(434518),o=t(763812),s=t(331635),a=t(132028),l=t(558137),n=t(622934),r=(0,o._)("_counter");class d{start(){(0,i._)(this,r)[r].start()}stop(){(0,i._)(this,r)[r].stop()}constructor(e){Object.defineProperty(this,r,{writable:!0,value:void 0}),(0,i._)(this,r)[r]=(0,l.makeSharedState)("spa/audio/AudioMediascopeScreenCounter",(()=>e.ensureActivityCounter({type:"screen",events:{start:{code:"632221"},stop:{code:"652221"},heartbeat:{code:"642221",msInterval:3e4}}})),{version:1})()}}d=(0,s.__decorate)([a.scope.global(),(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",[void 0===n.Mediascope?Object:n.Mediascope])],d)},270879:(e,_,t)=>{t.d(_,{disableAudioSectionListeners:()=>u,enableAudioSectionListeners:()=>d});var i=t(317849),o=t(983567),s=t(558137);const a=(0,o.getAudioPlayer)(),l=new Set(["BUTTON","INPUT","SELECT","TEXTAREA"]),n=e=>{const{code:_,target:t}=e,i=document.activeElement,o="Space"!==_,s="audio"!==window.cur.module,l=c(t??null),n=c(i??null);o||s||l||n||(e.preventDefault(),function(){if(!a.getCurrentAudio())return;a.isPlaying()?a.pauseByButton():a.playByButton()}())},r=(0,s.makeSharedState)("audio/section/globalListenerHandler",(()=>n),{version:0})();function d(){(0,i.partConfigEnabled)("audio_global_listener_space_player_toggle")&&document.addEventListener("keydown",r)}function u(){document.removeEventListener("keydown",r)}function c(e){if(!e)return!1;const _=e.hasAttribute("onkeydown")||e.hasAttribute("onkeypress")||e.hasAttribute("onkeyup");if(l.has(e.tagName))return!0;if(_)return!0;return!("textbox"!==e.getAttribute("role"))||c(e.parentElement)}},460167:(e,_,t)=>{t.d(_,{AudioSectionEffects:()=>b});var i=t(434518),o=t(763812),s=t(331635),a=t(327813),l=t(132028),n=t(24516),r=t(809424),d=t(595980),u=t(470388),c=t(43090),E=t(270879),h=(0,o._)("_reactions"),P=(0,o._)("_leaveSectionCheckInterval"),p=(0,o._)("_startLeaveSectionCheckInterval"),g=(0,o._)("_stopLeaveSectionCheckInterval");let y=l.destroy;class b{[y](){this.deactivate(),(0,i._)(this,g)[g](),(0,i._)(this,h)[h].dispose()}activate(){this.isActive||((0,E.enableAudioSectionListeners)(),this.isMediascopeEnabled&&this.mediascopeCounter.start(),this.isActive=!0)}deactivate(){this.isActive&&((0,E.disableAudioSectionListeners)(),this.isMediascopeEnabled&&this.mediascopeCounter.stop(),this.isActive=!1)}get isMediascopeEnabled(){return this.userEnv.partConfigEnabled("audio_mediascope")}constructor(e,_,t,o){Object.defineProperty(this,p,{value:A}),Object.defineProperty(this,g,{value:D}),Object.defineProperty(this,h,{writable:!0,value:void 0}),Object.defineProperty(this,P,{writable:!0,value:void 0}),this.userEnv=e,this.metaData=_,this.mediascopeCounter=t,(0,i._)(this,h)[h]=new u.ReactionsAggregator,this.isActive=!1,(0,i._)(this,P)[P]=null,(0,a.makeObservable)(this),(0,i._)(this,h)[h].autorun((()=>{this.isActive&&o.isVisible?(0,i._)(this,p)[p]():(0,i._)(this,g)[g]()}))}}function A(){"undefined"!=typeof window&&((0,i._)(this,P)[P]&&clearInterval((0,i._)(this,P)[P]),(0,i._)(this,P)[P]=setInterval((()=>{"audio"!==this.metaData.get().module&&this.deactivate()}),5e3))}function D(){(0,i._)(this,P)[P]&&clearInterval((0,i._)(this,P)[P])}(0,s.__decorate)([a.observable],b.prototype,"isActive",void 0),(0,s.__decorate)([a.action,(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",[]),(0,s.__metadata)("design:returntype",void 0)],b.prototype,"activate",null),(0,s.__decorate)([a.action,(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",[]),(0,s.__metadata)("design:returntype",void 0)],b.prototype,"deactivate",null),b=(0,s.__decorate)([l.scope.global(),(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",[void 0===n.UserEnv?Object:n.UserEnv,void 0===r.MetaData?Object:r.MetaData,void 0===c.AudioMediascopeScreenCounter?Object:c.AudioMediascopeScreenCounter,void 0===d.PageVisibility?Object:d.PageVisibility])],b)},494596:(e,_,t)=>{t.d(_,{AudioOwnerProvider:()=>E});var i=t(331635),o=t(327813),s=t(132028),a=t(468073),l=t(955060),n=t(15238),r=t(670056),d=t(597979),u=t(129830),c=t(831884);class E{isSupported(e){return a.Ranges.isGroupId(e)||a.Ranges.isUserId(e)}get(e){if(a.Ranges.isGroupId(e)){const _=a.Ranges.convertOwnerIdToGroupId(e);return this.groups.get(_)}if(a.Ranges.isUserId(e))return this.users.get(e)}provide(e){switch(e.type){case d.AudioOwnerType.Group:return this.provideGroup(e);case d.AudioOwnerType.User:return this.provideUser(e)}}provideGroup(e){let _=this.groups.get(e.groupId);return _||(_=new n.AudioGroupOwner(e),this.groups.set(_.data.groupId,_)),_}provideUser(e){let _=this.users.get(e.userId);return _||(_=new r.AudioUserOwner(e),this.users.set(_.data.userId,_)),_}setCacheFromAPI(e){for(const _ of e.users??[])try{const e=(0,u.toAudioUserOwnerData)(_);this.provideUser(e)}catch(e){this.logger.log(e)}for(const _ of e.groups??[])try{const e=(0,c.toAudioGroupOwnerData)(_);this.provideGroup(e)}catch(e){this.logger.log(e)}}constructor(e){this.logger=e,this.users=new Map,this.groups=new Map,(0,o.makeObservable)(this)}}(0,i.__decorate)([o.observable.shallow],E.prototype,"users",void 0),(0,i.__decorate)([o.observable.shallow],E.prototype,"groups",void 0),(0,i.__decorate)([o.action,(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",["undefined"==typeof TAudioOwnerData?Object:TAudioOwnerData]),(0,i.__metadata)("design:returntype","undefined"==typeof TAudioOwner?Object:TAudioOwner)],E.prototype,"provide",null),(0,i.__decorate)([o.action,(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",["undefined"==typeof IAudioGroupOwnerData?Object:IAudioGroupOwnerData]),(0,i.__metadata)("design:returntype","undefined"==typeof IAudioGroupOwner?Object:IAudioGroupOwner)],E.prototype,"provideGroup",null),(0,i.__decorate)([o.action,(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",["undefined"==typeof IAudioUserOwnerData?Object:IAudioUserOwnerData]),(0,i.__metadata)("design:returntype","undefined"==typeof IAudioUserOwner?Object:IAudioUserOwner)],E.prototype,"provideUser",null),(0,i.__decorate)([o.action,(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",["undefined"==typeof IAudioOwnerCacheAPISource?Object:IAudioOwnerCacheAPISource]),(0,i.__metadata)("design:returntype",void 0)],E.prototype,"setCacheFromAPI",null),E=(0,i.__decorate)([s.scope.global(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[void 0===l.ErrorLogger?Object:l.ErrorLogger])],E)},597979:(e,_,t)=>{var i;t.d(_,{AudioOwnerType:()=>i}),function(e){e.Group="group",e.User="user"}(i||(i={}))},15238:(e,_,t)=>{t.d(_,{AudioGroupOwner:()=>n});var i=t(434518),o=t(763812),s=t(468073),a=t(597979),l=(0,o._)("_data");class n{get type(){return a.AudioOwnerType.Group}get data(){return(0,i._)(this,l)[l]}get id(){return s.Ranges.convertGroupIdToOwnerId(this.data.groupId)}constructor(e){Object.defineProperty(this,l,{writable:!0,value:void 0}),(0,i._)(this,l)[l]=e}}},670056:(e,_,t)=>{t.d(_,{AudioUserOwner:()=>l});var i=t(434518),o=t(763812),s=t(597979),a=(0,o._)("_data");class l{get type(){return s.AudioOwnerType.User}get data(){return(0,i._)(this,a)[a]}get id(){return this.data.userId}constructor(e){Object.defineProperty(this,a,{writable:!0,value:void 0}),(0,i._)(this,a)[a]=e}}},831884:(e,_,t)=>{t.d(_,{toAudioGroupOwnerData:()=>o});var i=t(597979);function o(e){const _=e.name,t=e.screen_name??null;return function(e,_){if(null==e)throw new Error(`${_} required for create AudioUserOwnerData`)}(_,"title"),{type:i.AudioOwnerType.Group,groupId:e.id,title:_,artwork:a(e),domain:t}}const s=[["photo_50",50],["photo_100",100],["photo_200",200],["photo_200_orig",200],["photo_400",400],["photo_400_orig",400]];function a(e){const _=[];if(!e)return _;for(const[t,i]of s){const o=e[t];o&&_.push({src:o,size:i})}return _}},129830:(e,_,t)=>{t.d(_,{toAudioUserOwnerData:()=>o});var i=t(597979);function o(e){const _=e.first_name??null,t=e.last_name??null,o=e.domain??null;if(!_&&!t)throw new Error("firstName or lastName required for AudioUserOwnerData");return{type:i.AudioOwnerType.User,userId:e.id,firstName:_,lastName:t,artwork:a(e),domain:o}}const s=[["photo_50",50],["photo_100",100],["photo_200",200],["photo_200_orig",200],["photo_400",400],["photo_400_orig",400]];function a(e){const _=[];if(!e)return _;for(const[t,i]of s){const o=e[t];o&&_.push({src:o,size:i})}return _}},99323:(e,_,t)=>{t.d(_,{MusicAlbumPlaylist:()=>l});var i=t(331635),o=t(327813),s=t(702567),a=t(282648);class l extends a.MusicPlaylist{get genres(){return this.data.genres}get releaseYear(){return this.data.releaseYear}get subtype(){return this.data.subtype}get authors(){return this.data.authors}get focusTrackIdentities(){return this.head.reduce(((e,_)=>(_.isFocusTrack&&e.push(_.identity),e)),[])}constructor(e){super(e),this.following=new s.MusicPlaylistFollowing({playlist:this,service:e.followingService}),(0,o.makeObservable)(this)}}(0,i.__decorate)([o.computed,(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[]),(0,i.__metadata)("design:returntype",void 0)],l.prototype,"focusTrackIdentities",null)},884996:(e,_,t)=>{t.d(_,{MusicChatPlaylist:()=>a});var i=t(327813),o=t(702567),s=t(282648);class a extends s.MusicPlaylist{constructor(e){super(e),this.following=new o.MusicPlaylistFollowing({playlist:this,service:e.followingService}),(0,i.makeObservable)(this)}}},423109:(e,_,t)=>{t.d(_,{MusicGeneratedPlaylist:()=>o});var i=t(282648);class o extends i.MusicPlaylist{get authors(){if(!(this.originalOwner??this.owner))return[]}}},282648:(e,_,t)=>{t.d(_,{MusicPlaylist:()=>E});var i=t(434518),o=t(763812),s=t(331635),a=t(327813),l=t(460183),n=t(70148),r=(0,o._)("_getItemsService"),d=(0,o._)("_getDuration"),u=(0,o._)("_ensureExtendedData"),c=(0,o._)("_getContextualAudioForItem");class E extends l.AudioList{get infinite(){return!1}get items(){return this.itemsService.items.filter((({identity:e})=>!this.trackProvider.corruptedIdentities.has(e)))}get head(){const e=[];for(const _ of this.items){const t=(0,i._)(this,c)[c](_);if(!t)return e;e.push(t)}return e}get isItemsInitialized(){return this.itemsService.isInitialized}get hasFetchingItems(){return this.itemsService.hasFetching}get isHeadFetching(){return this.items.some((({identity:e})=>this.trackProvider.isFetchingAudio(e)))}get isEmpty(){return 0===this.count&&0===this.length}audioAt(e){const _=this.items.at(e);if(_)return(0,i._)(this,c)[c](_)}get owner(){return this.audioOwnerProvider.get(this.identity.ownerId)??null}get originalOwner(){const e=this.originalIdentity;return e?this.audioOwnerProvider.get(e.ownerId)??null:null}get followedOwner(){const e=this.followedIdentity;return e?this.audioOwnerProvider.get(e.ownerId)??null:null}get originalIdentity(){const e=this.data.originalIdentity;return e?new n.OwnedIdentity(e):null}get followedIdentity(){const e=this.data.followedIdentity;return e?new n.OwnedIdentity(e):null}get subtitle(){return this.data.subtitle}get description(){return this.data.description}get artwork(){return this.data.artwork}get count(){return this.data.count}get plays(){return this.data.plays}get isExclusive(){return this.data.isExclusive}get isDiscoverable(){return this.data.isDiscoverable}get isExplicit(){return this.data.isExplicit}get permissions(){return this.data.permissions}get updateDate(){return this.data.updateDate}get duration(){return(0,i._)(this,d)[d]()}has(e){return this.itemsService.has(e)}async ensureExtendedData(){await(0,i._)(this,u)[u]()}async ensureItems(){return this.itemsService.ensure()}async fetchItems(){return this.itemsService.fetch()}async fetchAt(e,_={}){let{range:t,prefetch:i}=_;!t&&i&&(t=5);const o=this.getFetchAtIndexes(e,{..._,range:t}).map((e=>this.items.at(e)?.identity));return await this.trackProvider.ensureMany(o),this.assertFetchAtFetched(e,_),this.audioAtStrict(e)}fetchNext(e=100){return this.fetchNextByAt(e)}get itemsService(){return(0,i._)(this,r)[r]()}constructor(e){super(e),Object.defineProperty(this,c,{value:h}),Object.defineProperty(this,r,{writable:!0,value:void 0}),Object.defineProperty(this,d,{writable:!0,value:void 0}),Object.defineProperty(this,u,{writable:!0,value:void 0}),this.audioApi=e.audioApi,this.trackProvider=e.trackProvider,this.audioOwnerProvider=e.audioOwnerProvider,(0,i._)(this,r)[r]=e.getItemsService,(0,i._)(this,d)[d]=e.getDuration,(0,i._)(this,u)[u]=e.ensureExtendedData,(0,a.makeObservable)(this)}}function h(e){const{trackProvider:_}=this;return _.get(e.identity,{list:this,trackCode:e.trackCode})}(0,s.__decorate)([a.computed,(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",[]),(0,s.__metadata)("design:returntype",Object)],E.prototype,"items",null),(0,s.__decorate)([a.computed,(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",[]),(0,s.__metadata)("design:returntype",Object)],E.prototype,"head",null),(0,s.__decorate)([a.computed,(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",[]),(0,s.__metadata)("design:returntype",Boolean)],E.prototype,"isItemsInitialized",null),(0,s.__decorate)([a.computed,(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",[]),(0,s.__metadata)("design:returntype",Boolean)],E.prototype,"hasFetchingItems",null),(0,s.__decorate)([a.computed,(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",[]),(0,s.__metadata)("design:returntype",Boolean)],E.prototype,"isHeadFetching",null),(0,s.__decorate)([a.computed,(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",[]),(0,s.__metadata)("design:returntype",Boolean)],E.prototype,"isEmpty",null),(0,s.__decorate)([a.computed,(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",[]),(0,s.__metadata)("design:returntype",void 0)],E.prototype,"owner",null),(0,s.__decorate)([a.computed,(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",[]),(0,s.__metadata)("design:returntype",void 0)],E.prototype,"originalOwner",null),(0,s.__decorate)([a.computed,(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",[]),(0,s.__metadata)("design:returntype",void 0)],E.prototype,"followedOwner",null),(0,s.__decorate)([a.computed,(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",[]),(0,s.__metadata)("design:returntype",void 0)],E.prototype,"originalIdentity",null),(0,s.__decorate)([a.computed,(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",[]),(0,s.__metadata)("design:returntype",void 0)],E.prototype,"followedIdentity",null),(0,s.__decorate)([a.computed,(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",[]),(0,s.__metadata)("design:returntype",void 0)],E.prototype,"duration",null),(0,s.__decorate)([a.computed,(0,s.__metadata)("design:type",Function),(0,s.__metadata)("design:paramtypes",[]),(0,s.__metadata)("design:returntype","undefined"==typeof ItemsService?Object:ItemsService)],E.prototype,"itemsService",null)},638055:(e,_,t)=>{t.d(_,{AUDIO_LIST_TYPES:()=>i});const i=new Set(["album","generated","chat","ugc"])},797488:(e,_,t)=>{t.d(_,{isExperimentalAudioPlaylist:()=>o});var i=t(638055);function o(e){return i.AUDIO_LIST_TYPES.has(e.type)}},754882:(e,_,t)=>{t.d(_,{MusicUGCGroupPlaylist:()=>a});var i=t(327813),o=t(702567),s=t(282648);class a extends s.MusicPlaylist{get isCurator(){return this.data.isCurator}constructor(e){super(e),this.following=new o.MusicPlaylistFollowing({playlist:this,service:e.followingService}),(0,i.makeObservable)(this)}}},438866:(e,_,t)=>{t.d(_,{MusicUGCUserPlaylist:()=>a});var i=t(327813),o=t(702567),s=t(282648);class a extends s.MusicPlaylist{constructor(e){super(e),this.following=new o.MusicPlaylistFollowing({playlist:this,service:e.followingService}),(0,i.makeObservable)(this)}}},141180:(e,_,t)=>{t.d(_,{MyMusicPlaylist:()=>a});var i=t(331635),o=t(327813),s=t(282648);class a extends s.MusicPlaylist{get isDiscoverable(){return this._isDiscoverable}get isWriting(){return this._isWriting}async edit({isDiscoverable:e=!1}){this.authService.ensureUserId();const{identity:_}=this;if(e===this.isDiscoverable)return this;try{return this.markWriting(),await this.audioApi.editPlaylist({playlist_id:_.id,owner_id:_.ownerId,no_discover:e?0:1}),(0,o.runInAction)((()=>{this._isDiscoverable=e})),this}finally{this.unmarkWriting()}}checkToggling(e){return this.itemsService.checkToggling(e)}add(e){return this.itemsService.add(e)}remove(e){return this.itemsService.remove(e)}toggle(e,_){return this.itemsService.toggle(e,_)}markWriting(){this._isWriting=!0}unmarkWriting(){this._isWriting=!1}constructor(e){super(e),this._isWriting=!1,this.authService=e.authService,this._isDiscoverable=this.data.isDiscoverable,this.authService.assertAuthorized(),(0,o.makeObservable)(this)}}(0,i.__decorate)([o.observable],a.prototype,"_isWriting",void 0),(0,i.__decorate)([o.observable],a.prototype,"_isDiscoverable",void 0),(0,i.__decorate)([o.computed,(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[]),(0,i.__metadata)("design:returntype",void 0)],a.prototype,"isDiscoverable",null),(0,i.__decorate)([o.computed,(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[]),(0,i.__metadata)("design:returntype",void 0)],a.prototype,"isWriting",null),(0,i.__decorate)([o.action,(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",["undefined"==typeof IMyMusicPlaylistEditParams?Object:IMyMusicPlaylistEditParams]),(0,i.__metadata)("design:returntype",Promise)],a.prototype,"edit",null),(0,i.__decorate)([o.action,(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[]),(0,i.__metadata)("design:returntype",void 0)],a.prototype,"markWriting",null),(0,i.__decorate)([o.action,(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[]),(0,i.__metadata)("design:returntype",void 0)],a.prototype,"unmarkWriting",null)},617922:(e,_,t)=>{t.d(_,{GeneratedMusicPlaylistsIdsValidator:()=>i});class i{static checkIsGeneratedMusicPlaylist(e){return i.IDS_SET.has(e)}}i.AUDIO_PLAYLIST_DAILY_RECOMS_ID=-21,i.AUDIO_PLAYLIST_WEEKLY_RECOMS_ID=-22,i.AUDIO_PLAYLIST_FRESH_RECOMS_ID=-23,i.AUDIO_PLAYLIST_DISCOVERY_ID=-24,i.AUDIO_PLAYLIST_DIVIDED_DAILY_FIRST_RECOMS_ID=-25,i.AUDIO_PLAYLIST_DIVIDED_DAILY_SECOND_RECOMS_ID=-26,i.AUDIO_PLAYLIST_DIVIDED_DAILY_THIRD_RECOMS_ID=-27,i.AUDIO_PLAYLIST_DIVIDED_DAILY_FOURTH_RECOMS_ID=-28,i.AUDIO_PLAYLIST_DIVIDED_DAILY_FIFTH_RECOMS_ID=-29,i.AUDIO_PLAYLIST_SAD_MOOD_ID=-33,i.AUDIO_PLAYLIST_HAPPY_MOOD_ID=-34,i.AUDIO_PLAYLIST_ANGRY_MOOD_ID=-35,i.AUDIO_PLAYLIST_CALM_MOOD_ID=-36,i.AUDIO_PLAYLIST_NEW_YEAR_ID=-41,i.AUDIO_PLAYLIST_VALENTINES_DAY_ID=-42,i.IDS_SET=new Set([i.AUDIO_PLAYLIST_DAILY_RECOMS_ID,i.AUDIO_PLAYLIST_WEEKLY_RECOMS_ID,i.AUDIO_PLAYLIST_FRESH_RECOMS_ID,i.AUDIO_PLAYLIST_DISCOVERY_ID,i.AUDIO_PLAYLIST_DIVIDED_DAILY_FIRST_RECOMS_ID,i.AUDIO_PLAYLIST_DIVIDED_DAILY_SECOND_RECOMS_ID,i.AUDIO_PLAYLIST_DIVIDED_DAILY_THIRD_RECOMS_ID,i.AUDIO_PLAYLIST_DIVIDED_DAILY_FOURTH_RECOMS_ID,i.AUDIO_PLAYLIST_DIVIDED_DAILY_FIFTH_RECOMS_ID,i.AUDIO_PLAYLIST_SAD_MOOD_ID,i.AUDIO_PLAYLIST_HAPPY_MOOD_ID,i.AUDIO_PLAYLIST_ANGRY_MOOD_ID,i.AUDIO_PLAYLIST_CALM_MOOD_ID,i.AUDIO_PLAYLIST_NEW_YEAR_ID,i.AUDIO_PLAYLIST_VALENTINES_DAY_ID])},850380:(e,_,t)=>{function i(e){const{id:_,name:t}=e;return{id:_,name:t}}t.d(_,{toMusicGenre:()=>i})},256151:(e,_,t)=>{t.d(_,{MusicAlbumPlaylistSubtype:()=>i,MusicAlbumPlaylistSubtypeCodes:()=>s});var i,o=t(775182);!function(e){e.Album="album",e.EP="ep",e.Collection="collection",e.Single="single"}(i||(i={}));const s=[o.MusicPlaylistSubtypeCode[o.MusicPlaylistSubtype.Album],o.MusicPlaylistSubtypeCode[o.MusicPlaylistSubtype.EP],o.MusicPlaylistSubtypeCode[o.MusicPlaylistSubtype.Collection],o.MusicPlaylistSubtypeCode[o.MusicPlaylistSubtype.Single]]},75706:(e,_,t)=>{t.d(_,{toMusicAlbumPlaylistData:()=>u});var i=t(775182),o=t(319508),s=t(568952),a=t(850380),l=t(35215),n=t(797488),r=t(256151);const d=new Map([[i.MusicPlaylistSubtypeCode[i.MusicPlaylistSubtype.Album],r.MusicAlbumPlaylistSubtype.Album],[i.MusicPlaylistSubtypeCode[i.MusicPlaylistSubtype.EP],r.MusicAlbumPlaylistSubtype.EP],[i.MusicPlaylistSubtypeCode[i.MusicPlaylistSubtype.Collection],r.MusicAlbumPlaylistSubtype.Collection],[i.MusicPlaylistSubtypeCode[i.MusicPlaylistSubtype.Single],r.MusicAlbumPlaylistSubtype.Single]]);function u(e){const{year:_}=e;return{...(0,o.toMusicPlaylistData)(s.AudioListType.MusicAlbumPlaylist,e),releaseYear:_,type:s.AudioListType.MusicAlbumPlaylist,subtype:p(e),genres:c(e),authors:E(e)}}function c(e){const{genres:_}=e;return _?_.map(a.toMusicGenre):[]}function E(e){const{main_artists:_,featured_artists:t}=e;return{main:_?.map(h)??[],feat:t?.map(h)??[]}}function h(e){return{id:e.id,name:e.name,artwork:e.photo?.map(P)??[]}}function P(e){return{src:e.url,size:e.width??e.height??0}}function p(e){if((0,n.isExperimentalAudioPlaylist)(e)){const _=e.album?.type;switch(_){case"album":default:return r.MusicAlbumPlaylistSubtype.Album;case"ep":return r.MusicAlbumPlaylistSubtype.EP;case"collection":return r.MusicAlbumPlaylistSubtype.Collection;case"single":return r.MusicAlbumPlaylistSubtype.Single}}const _=e.type;return(0,l.isNumber)(_)&&d.has(_)?d.get(_):r.MusicAlbumPlaylistSubtype.Album}},135644:(e,_,t)=>{t.d(_,{toMusicChatPlaylistData:()=>s});var i=t(319508),o=t(568952);function s(e){return{...(0,i.toMusicPlaylistData)(o.AudioListType.MusicChatPlaylist,e),type:o.AudioListType.MusicChatPlaylist}}},445634:(e,_,t)=>{t.d(_,{toMusicGeneratedPlaylistData:()=>s});var i=t(319508),o=t(568952);function s(e){return{...(0,i.toMusicPlaylistData)(o.AudioListType.MusicGeneratedPlaylist,e),type:o.AudioListType.MusicGeneratedPlaylist}}},628592:(e,_,t)=>{t.d(_,{MusicPlaylistProvider:()=>S});var i=t(331635),o=t(327813),s=t(132028),a=t(70148),l=t(468073),n=t(346675),r=t(951652),d=t(26530),u=t(523417),c=t(568952),E=t(494596),h=t(99323),P=t(423109),p=t(754882),g=t(438866),y=t(884996),b=t(141180),A=t(797488),D=t(617922),M=t(735584),O=t(75706),C=t(256151),m=t(445634),w=t(69388),I=t(913372),L=t(685816),T=t(135644),B=t(824501),f=t(775182),v=t(781989),R=t(631027),U=t(344614),W=t(957264),K=t(826338);class S{static toEntityIdentity(e){return new a.OwnedIdentity(e)}static getContextKey(e){return e.ref}get events(){return this.emitter.listenable}get(e,_){const t=this.entities.get(e);if(!t)return;const i=t.get(S.getContextKey(_));if(i)return i;const o=this.data.get(e);return o?this.create(o,_):void 0}has(e){return this.data.has(e)}checkPending(e){return this.pendingPlaylists.has(e)}checkCopyingToMyMusic(e){return this.pendingCopiedToMyMusicPlaylists.has(e)}checkDeleting(e){return this.pendingDeletedPlaylists.has(e)}checkDeleted(e){return this.deletedPlaylists.has(e)}async ensure(e,_){const t=this.get(e,_);return t||this.fetch(e,_)}async ensureExtendedData(e,_){const t=this.get(e,_),i=this.durations.get(e);if(!t||"number"!=typeof i)return this.fetch(e,_)}create(e,_){const{audioApi:t,authService:i,trackProvider:o,followingService:s,audioOwnerProvider:a}=this,l=S.toEntityIdentity(e.identity),n=()=>this.durations.get(l),r=async()=>{await this.ensureExtendedData(l,_)};switch(this.cacheData(e),e.type){case c.AudioListType.MusicAlbumPlaylist:return this.cacheEntity(new h.MusicAlbumPlaylist({identity:l,getData:this.makeCachedDataGetter(l,e),getItemsService:this.makeItemsServiceGetter(l,_),context:_,audioApi:t,trackProvider:o,audioOwnerProvider:a,followingService:s,getDuration:n,ensureExtendedData:r}));case c.AudioListType.MusicGeneratedPlaylist:return this.cacheEntity(new P.MusicGeneratedPlaylist({identity:l,getData:this.makeCachedDataGetter(l,e),getItemsService:this.makeItemsServiceGetter(l,_),context:_,audioApi:t,trackProvider:o,audioOwnerProvider:a,getDuration:n,ensureExtendedData:r}));case c.AudioListType.MusicUGCGroupPlaylist:return this.cacheEntity(new p.MusicUGCGroupPlaylist({identity:l,getData:this.makeCachedDataGetter(l,e),getItemsService:this.makeItemsServiceGetter(l,_),context:_,audioApi:t,trackProvider:o,audioOwnerProvider:a,followingService:s,getDuration:n,ensureExtendedData:r}));case c.AudioListType.MusicUGCUserPlaylist:return this.cacheEntity(new g.MusicUGCUserPlaylist({identity:l,getData:this.makeCachedDataGetter(l,e),getItemsService:this.makeItemsServiceGetter(l,_),context:_,audioApi:t,trackProvider:o,audioOwnerProvider:a,followingService:s,getDuration:n,ensureExtendedData:r}));case c.AudioListType.MusicChatPlaylist:return this.cacheEntity(new y.MusicChatPlaylist({identity:l,getData:this.makeCachedDataGetter(l,e),getItemsService:this.makeItemsServiceGetter(l,_),context:_,audioApi:t,trackProvider:o,audioOwnerProvider:a,followingService:s,getDuration:n,ensureExtendedData:r}));case c.AudioListType.MyMusicPlaylist:return this.cacheEntity(new b.MyMusicPlaylist({identity:l,getData:this.makeCachedDataGetter(l,e),getItemsService:this.makeItemsServiceGetter(l,_),context:_,audioApi:t,trackProvider:o,audioOwnerProvider:a,authService:i,getDuration:n,ensureExtendedData:r}));default:return(0,u.expectNever)(e)}}cacheEntity(e){const{identity:_}=e;let t=this.entities.get(_);return t||(t=(0,o.observable)(new Map),this.entities.set(_,t)),t.set(S.getContextKey(e.context),e),e}cacheData(e){const{toEntityIdentity:_}=S,{identity:t,originalIdentity:i,followedIdentity:o}=e,s=_(t);if(this.data.set(s,e),i){const o=_(i);this.followingService.setCache(o,s),this.data.set(o,{...e,identity:i,followedIdentity:t})}if(o){const i=_(o);this.followingService.setCache(s,i),this.data.set(i,{...e,identity:o,originalIdentity:t})}}async fetch(e,_){try{this.markPending(e);const t=await this.audioApi.getPlaylistByIdExtended({playlist_id:e.id,owner_id:e.ownerId,extra_fields:"owner, duration"});return this.createFromAPIExtendedResponse(t,_)}finally{(0,o.runInAction)((()=>{this.unmarkPending(e)}))}}createFromAPI(e,_){const{authService:t}=this;if((0,A.isExperimentalAudioPlaylist)(e)){switch(e.type){case"album":return this.create((0,O.toMusicAlbumPlaylistData)(e),_);case"generated":return this.create((0,m.toMusicGeneratedPlaylistData)(e),_);case"chat":return this.create((0,T.toMusicChatPlaylistData)(e),_);case"ugc":if(l.Ranges.isGroupId(e.owner_id)||e.original?.owner_id&&l.Ranges.isGroupId(e.original?.owner_id))return this.create((0,w.toMusicUGCGroupPlaylistData)(e),_);if(e.owner_id===t.userId&&!e.original)return this.create((0,L.toMyMusicPlaylistData)(e),_);if(l.Ranges.isUserId(e.owner_id)||e.original?.owner_id&&l.Ranges.isUserId(e.original?.owner_id))return this.create((0,I.toMusicUGCUserPlaylistData)(e),_)}throw new Error("Unknown playlist type")}if(C.MusicAlbumPlaylistSubtypeCodes.includes(e.type))return this.create((0,O.toMusicAlbumPlaylistData)(e),_);if(D.GeneratedMusicPlaylistsIdsValidator.checkIsGeneratedMusicPlaylist(e.id))return this.create((0,m.toMusicGeneratedPlaylistData)(e),_);if(e.type===f.MusicPlaylistSubtypeCode[f.MusicPlaylistSubtype.Chat])return this.create((0,T.toMusicChatPlaylistData)(e),_);if(l.Ranges.isGroupId(e.owner_id)||e.original?.owner_id&&l.Ranges.isGroupId(e.original?.owner_id))return this.create((0,w.toMusicUGCGroupPlaylistData)(e),_);if(e.owner_id===t.userId&&!e.original)return this.create((0,L.toMyMusicPlaylistData)(e),_);if(l.Ranges.isUserId(e.owner_id)||e.original?.owner_id&&l.Ranges.isUserId(e.original?.owner_id))return this.create((0,I.toMusicUGCUserPlaylistData)(e),_);throw new Error("Unknown playlist type")}createFromAPIExtendedResponse(e,_){const{playlist:t,profiles:i,groups:o,duration:s}=e,a=S.toEntityIdentity((0,K.toMusicPlaylistIdentityData)(t));return"number"==typeof s&&this.durations.set(a,s),this.audioOwnerProvider.setCacheFromAPI({users:i,groups:o}),this.createFromAPI(e.playlist,_)}async copyToMyMusic(e,_){if(this.authService.ensureUserId(),!(0,v.isCopyableToMyMusicPlaylist)(e))throw new Error("Music playlist is not available for copying to my music");const{identity:t}=e;try{this.markCopyingToMyMusicPending(t);const i=await this.audioApi.savePlaylistAsCopy({owner_id:t.ownerId,playlist_id:t.id}),o=this.createFromAPI(i,_);if(!(0,R.isSpecificMusicPlaylist)(o,c.AudioListType.MyMusicPlaylist))throw new Error("Error creating copy of playlist in my music");return this.emitter.emit("copiedToMyMusic",{source:e,target:o}),o}finally{(0,o.runInAction)((()=>{this.unmarkCopyingToMyMusicPending(t)}))}}async delete(e){if(!(0,U.isDeletableMusicPlaylist)(e))throw new Error("Music playlist is not available for deletion");const{identity:_}=e;try{this.markDeletionPending(_),await this.audioApi.deletePlaylist({owner_id:_.ownerId,playlist_id:_.id}),this.markDeleted(e.identity),this.emitter.emit("deleted",{target:e})}finally{(0,o.runInAction)((()=>{this.unmarkDeletionPending(_)}))}}toEntityIdentity(e){return new a.OwnedIdentity(e)}markPending(e){this.pendingPlaylists.add(e)}unmarkPending(e){this.pendingPlaylists.delete(e)}markCopyingToMyMusicPending(e){this.pendingCopiedToMyMusicPlaylists.add(e)}unmarkCopyingToMyMusicPending(e){this.pendingCopiedToMyMusicPlaylists.delete(e)}markDeletionPending(e){this.pendingDeletedPlaylists.add(e)}unmarkDeletionPending(e){this.pendingDeletedPlaylists.delete(e)}markDeleted(e){this.deletedPlaylists.add(e)}makeCachedDataGetter(e,_){let t=_;return()=>{let _=this.data.get(e);return _&&(t=_),_??t}}makeItemsServiceGetter(e,_){return()=>this.playlistsItemsService.provide(e,_)}constructor(e,_,t,i,s,a){this.audioApi=e,this.authService=_,this.trackProvider=t,this.audioOwnerProvider=i,this.playlistsItemsService=a.playlistItemsServices,this.followingService=a.playlistsFollowing;const l=(0,W.ensureStuffing)(s);this.emitter=l.emitter,this.entities=l.entities,this.data=l.data,this.durations=l.durations,this.pendingPlaylists=l.pendingPlaylists,this.pendingCopiedToMyMusicPlaylists=l.pendingCopiedToMyMusicPlaylists,this.pendingDeletedPlaylists=l.pendingDeletedPlaylists,this.deletedPlaylists=l.deletedPlaylists,(0,o.makeAutoObservable)(this)}}S=(0,i.__decorate)([s.scope.global(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[void 0===n.AudioApi?Object:n.AudioApi,void 0===r.AuthService?Object:r.AuthService,void 0===M.MusicTrackProvider?Object:M.MusicTrackProvider,void 0===E.AudioOwnerProvider?Object:E.AudioOwnerProvider,void 0===d.EmitterFactory?Object:d.EmitterFactory,void 0===B.MusicService?Object:B.MusicService])],S)},957264:(e,_,t)=>{t.d(_,{ensureStuffing:()=>a});var i=t(558137),o=t(70916),s=t(74270);function a(e){const _=(0,i.makeSharedState)("domains/audio/MusicPlaylistProvider/stuffing",(()=>({})),{version:2})();return _.current||(_.current=function(e){return{entities:new o.ObservableIdentityMap,data:new o.ObservableIdentityMap,durations:new o.ObservableIdentityMap,pendingPlaylists:new s.ObservableIdentitySet,pendingCopiedToMyMusicPlaylists:new s.ObservableIdentitySet,pendingDeletedPlaylists:new s.ObservableIdentitySet,deletedPlaylists:new s.ObservableIdentitySet,emitter:e.create()}}(e)),_.current}},781989:(e,_,t)=>{t.d(_,{isCopyableToMyMusicPlaylist:()=>o});var i=t(775182);function o(e){return e.permissions.saveAsCopy&&i.CopyableMusicPlaylistsTypes.includes(e.type)}},344614:(e,_,t)=>{t.d(_,{isDeletableMusicPlaylist:()=>o});var i=t(775182);function o(e){return e.permissions.delete&&i.DeletableMusicPlaylistsTypes.includes(e.type)}},631027:(e,_,t)=>{t.d(_,{isSpecificMusicPlaylist:()=>o});var i=t(775182);function o(e,_){return _?Array.isArray(_)?_.includes(e.type):e.type===_:i.MusicPlaylistsTypes.includes(e.type)}},319508:(e,_,t)=>{t.d(_,{toMusicPlaylistData:()=>l});var i=t(588357),o=t(293658),s=t(775182),a=(t(35215),t(826338));new Map([[s.MusicPlaylistSubtypeCode[s.MusicPlaylistSubtype.NoAlbum],s.MusicPlaylistSubtype.NoAlbum],[s.MusicPlaylistSubtypeCode[s.MusicPlaylistSubtype.Album],s.MusicPlaylistSubtype.Album],[s.MusicPlaylistSubtypeCode[s.MusicPlaylistSubtype.EP],s.MusicPlaylistSubtype.EP],[s.MusicPlaylistSubtypeCode[s.MusicPlaylistSubtype.Collection],s.MusicPlaylistSubtype.Collection],[s.MusicPlaylistSubtypeCode[s.MusicPlaylistSubtype.Single],s.MusicPlaylistSubtype.Single],[s.MusicPlaylistSubtypeCode[s.MusicPlaylistSubtype.Chat],s.MusicPlaylistSubtype.Chat]]);function l(e,_){const{title:t,subtitle:o,description:s,count:l,plays:d,exclusive:u,is_explicit:c,no_discover:E,update_time:h,main_color:P}=_;return{type:e,contentType:i.AudioType.MusicTrack,identity:(0,a.toMusicPlaylistIdentityData)(_),originalIdentity:_.original?(0,a.toSpecificVersionMusicPlaylistIdentityData)(_.original):null,followedIdentity:_.followed?(0,a.toSpecificVersionMusicPlaylistIdentityData)(_.followed):null,title:t,subtitle:o,description:s,artwork:n(_,P),count:l,plays:d,isExclusive:u??!1,isExplicit:c??!1,isDiscoverable:!E,updateDate:new Date(1e3*h),permissions:r(_)}}function n(e,_){const t=e.photo;return t?(0,o.toAudioArtworkImages)(t,_):[]}function r(e){const _=e.permissions;return{play:_?.play??!1,share:_?.share??!1,edit:_?.edit??!1,follow:_?.follow??!1,delete:_?.delete??!1,saveAsCopy:_?.save_as_copy??!1}}},826338:(e,_,t)=>{function i(e){const{id:_,owner_id:t,access_key:i}=e;return{id:_,ownerId:t,accessKey:i}}function o(e){const{playlist_id:_,owner_id:t,access_key:i}=e;return{id:_,ownerId:t,accessKey:i}}t.d(_,{toMusicPlaylistIdentityData:()=>i,toSpecificVersionMusicPlaylistIdentityData:()=>o})},69388:(e,_,t)=>{t.d(_,{toMusicUGCGroupPlaylistData:()=>s});var i=t(319508),o=t(568952);function s(e){const{is_curator:_}=e;return{...(0,i.toMusicPlaylistData)(o.AudioListType.MusicUGCGroupPlaylist,e),type:o.AudioListType.MusicUGCGroupPlaylist,isCurator:_??!1}}},913372:(e,_,t)=>{t.d(_,{toMusicUGCUserPlaylistData:()=>s});var i=t(319508),o=t(568952);function s(e){return{...(0,i.toMusicPlaylistData)(o.AudioListType.MusicUGCUserPlaylist,e),type:o.AudioListType.MusicUGCUserPlaylist}}},685816:(e,_,t)=>{t.d(_,{toMyMusicPlaylistData:()=>s});var i=t(319508),o=t(568952);function s(e){return(0,i.toMusicPlaylistData)(o.AudioListType.MyMusicPlaylist,e)}},702567:(e,_,t)=>{t.d(_,{MusicPlaylistFollowing:()=>o});var i=t(327813);class o{get isMine(){return this.service.isMine(this.identity)}get state(){return this.service.has(this.identity)}get isPending(){return this.service.checkPending(this.identity)}async activate(){await this.service.follow(this.originalIdentity,{ref:this.ref})}async deactivate(){await this.service.unfollow(this.originalIdentity)}async toggle(e,_){const t=_??!this.state;await this[t?"deactivate":"activate"]()}get originalIdentity(){return this.playlist.originalIdentity??this.identity}get identity(){return this.playlist.identity}get ref(){return this.playlist.context.ref}constructor(e){this.playlist=e.playlist,this.service=e.service,(0,i.makeAutoObservable)(this)}}},595980:(e,_,t)=>{t.d(_,{PageVisibility:()=>l});var i=t(331635),o=t(327813),s=t(132028),a=t(939661);class l{get isVisible(){return this._isVisible}get visibility(){return this.isVisible}constructor(){this.setVisibility=(0,o.action)((e=>{this._isVisible=e})),this._observer=a.PageVisibilityObserver.ensure(),this._isVisible=this._observer.visibility,(0,o.makeAutoObservable)(this),this._observer.on("change",this.setVisibility)}}l=(0,i.__decorate)([s.scope.platform(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[])],l)},7034:(e,_,t)=>{t.d(_,{Icon20Users3Outline:()=>i});var i=(0,t(844990).makeIcon)("Icon20Users3Outline","users_3_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" id="users_3_outline_20"><path fill="currentColor" fill-rule="evenodd" d="M10 7.75a1.25 1.25 0 1 1 0-2.5 1.25 1.25 0 0 1 0 2.5M7.25 6.5a2.75 2.75 0 1 1 5.5 0 2.75 2.75 0 0 1-5.5 0m-.5 7.25c0-.416.231-.828.796-1.172C8.12 12.23 8.975 12 10 12s1.881.23 2.454.578c.565.344.796.756.796 1.172 0 .293-.1.444-.218.54-.142.113-.396.21-.782.21h-4.5c-.386 0-.64-.097-.781-.21-.12-.096-.219-.247-.219-.54M10 10.5c-1.225 0-2.369.27-3.234.797-.872.531-1.516 1.369-1.516 2.453 0 .707.276 1.306.781 1.71.484.387 1.105.54 1.719.54h4.5c.614 0 1.235-.153 1.719-.54.506-.404.781-1.003.781-1.71 0-1.084-.643-1.922-1.516-2.453-.865-.526-2.01-.797-3.234-.797m4.006-5.588a.75.75 0 0 1 .848-.637A2.5 2.5 0 0 1 14.5 9.25a.75.75 0 0 1 0-1.5 1 1 0 0 0 .143-1.99.75.75 0 0 1-.637-.848M15.749 10a.75.75 0 0 0 0 1.5c1.158 0 1.75.673 1.75 1.25a.86.86 0 0 1-.185.547.57.57 0 0 1-.464.203.75.75 0 0 0 0 1.5c1.428 0 2.15-1.21 2.15-2.25 0-1.712-1.607-2.75-3.251-2.75M5 10.75a.75.75 0 0 0-.75-.75C2.606 10 .999 11.038.999 12.75c0 1.04.722 2.25 2.15 2.25a.75.75 0 0 0 0-1.5.57.57 0 0 1-.465-.203.86.86 0 0 1-.185-.547c0-.577.592-1.25 1.751-1.25a.75.75 0 0 0 .75-.75m.142-6.474a.75.75 0 0 1 .214 1.484A1 1 0 0 0 5.5 7.75a.75.75 0 1 1 0 1.5 2.5 2.5 0 0 1-.358-4.975" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},68177:(e,_,t)=>{t.d(_,{Icon24Bookmark:()=>i});var i=(0,t(844990).makeIcon)("Icon24Bookmark","bookmark_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" id="bookmark_24"><path fill-rule="evenodd" d="M11.083 3h1.834c1.056 0 1.903 0 2.588.056.704.058 1.316.179 1.88.466a4.8 4.8 0 0 1 2.093 2.093c.287.564.409 1.176.466 1.88C20 8.18 20 9.027 20 10.083v7.615c0 .773 0 1.414-.046 1.914-.044.494-.144 1.026-.481 1.454a2.46 2.46 0 0 1-1.896.935c-.544.007-1.027-.238-1.447-.503-.423-.268-.933-.658-1.546-1.128l-1.617-1.24c-.607-.466-.714-.526-.797-.549a.66.66 0 0 0-.34 0c-.083.023-.19.083-.797.549l-1.617 1.24c-.613.47-1.123.86-1.546 1.128-.42.265-.903.51-1.447.503a2.46 2.46 0 0 1-1.896-.936c-.337-.427-.437-.96-.482-1.453C4 19.112 4 18.47 4 17.698v-7.615c0-1.056 0-1.903.056-2.588.057-.704.179-1.316.466-1.88a4.8 4.8 0 0 1 2.093-2.093c.564-.287 1.176-.408 1.88-.466C9.18 3 10.027 3 11.083 3" clip-rule="evenodd" /></symbol>',24,24,!1,void 0)},216447:(e,_,t)=>{t.d(_,{Icon24BookmarkCheckOutline:()=>i});var i=(0,t(844990).makeIcon)("Icon24BookmarkCheckOutline","bookmark_check_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" id="bookmark_check_outline_24"><path d="M8.641 4.85c.57-.047 1.293-.05 2.308-.05a.9.9 0 0 0 0-1.8c-.992 0-1.797.001-2.454.055-.704.058-1.316.179-1.88.466a4.8 4.8 0 0 0-2.093 2.093c-.287.564-.409 1.176-.466 1.88C4 8.179 4 9.027 4 10.082v7.616c0 .771 0 1.413.045 1.913.045.492.145 1.026.482 1.454A2.46 2.46 0 0 0 6.423 22c.545.007 1.029-.239 1.447-.503.424-.267.933-.658 1.546-1.128l1.617-1.24a13 13 0 0 1 .595-.44.7.7 0 0 1 .202-.109.66.66 0 0 1 .34 0c.042.012.09.033.202.108.113.076.291.208.595.44l1.618 1.241c.612.47 1.121.86 1.545 1.128.418.264.902.51 1.447.503a2.46 2.46 0 0 0 1.896-.935c.337-.428.437-.962.482-1.454.045-.5.045-1.142.045-1.914v-3.075a.9.9 0 0 0-1.8 0v3.075c0 .805-.002 1.352-.038 1.75a2.3 2.3 0 0 1-.067.411.4.4 0 0 1-.036.093.66.66 0 0 1-.506.249c.008 0-.017.003-.095-.027a2.3 2.3 0 0 1-.366-.198c-.339-.213-.774-.545-1.412-1.035l-1.618-1.24c-.302-.231-.52-.394-.684-.504a2.4 2.4 0 0 0-.743-.355 2.46 2.46 0 0 0-1.27 0 2.4 2.4 0 0 0-.743.355c-.164.11-.382.273-.684.504L8.32 18.94c-.638.49-1.073.822-1.412 1.035a2.3 2.3 0 0 1-.366.197.4.4 0 0 1-.096.028.66.66 0 0 1-.505-.25.4.4 0 0 1-.036-.092 2.3 2.3 0 0 1-.067-.41c-.036-.4-.038-.946-.038-1.751v-7.614c0-1.084.001-1.847.05-2.443.048-.592.14-.941.276-1.209a3 3 0 0 1 1.306-1.306c.268-.137.617-.228 1.21-.276Z" /><path fill-rule="evenodd" d="M18 1.999a5 5 0 1 0 0 10 5 5 0 0 0 0-10m2.78 3.22a.75.75 0 0 0-1.06 0l-2.47 2.47-.97-.97a.75.75 0 1 0-1.06 1.06l1.5 1.5a.75.75 0 0 0 1.06 0l3-3a.75.75 0 0 0 0-1.06" clip-rule="evenodd" /></symbol>',24,24,!1,void 0)},843250:(e,_,t)=>{t.d(_,{Icon24Broadcast:()=>i});var i=(0,t(844990).makeIcon)("Icon24Broadcast","broadcast_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="broadcast_24"><path fill="currentColor" d="M5.491 3.698a1 1 0 0 1-.033 1.414l-.033.03-.02.02A9.47 9.47 0 0 0 2.5 12a9.47 9.47 0 0 0 2.935 6.867 1 1 0 1 1-1.383 1.445A11.47 11.47 0 0 1 .5 12c0-3.163 1.284-6.123 3.516-8.276l.026-.025.035-.034a1 1 0 0 1 1.414.033m13.018 0a1 1 0 0 1 1.414-.033l.035.034.026.025A11.47 11.47 0 0 1 23.5 12c0 3.18-1.299 6.157-3.552 8.312a1 1 0 1 1-1.383-1.446A9.47 9.47 0 0 0 21.5 12a9.47 9.47 0 0 0-2.904-6.837l-.021-.02-.033-.031a1 1 0 0 1-.033-1.414M8.838 7.094a1 1 0 0 1-.057 1.413A4.73 4.73 0 0 0 7.25 12c0 1.345.56 2.598 1.53 3.492a1 1 0 0 1-1.356 1.47A6.73 6.73 0 0 1 5.25 12c0-1.91.799-3.694 2.175-4.963a1 1 0 0 1 1.413.057m6.324 0a1 1 0 0 1 1.413-.057A6.73 6.73 0 0 1 18.75 12c0 1.91-.798 3.693-2.174 4.962a1 1 0 1 1-1.356-1.47A4.73 4.73 0 0 0 16.75 12c0-1.345-.56-2.598-1.53-3.493a1 1 0 0 1-.058-1.413M12 9.75a2.25 2.25 0 1 1 0 4.5 2.25 2.25 0 0 1 0-4.5" /></symbol>',24,24,!1,void 0)},657967:(e,_,t)=>{t.d(_,{Icon24Repeat1Outline:()=>i});var i=(0,t(844990).makeIcon)("Icon24Repeat1Outline","repeat_1_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="repeat_1_outline_24"><g fill="currentColor"><path fill-rule="evenodd" d="M12.475 9.132a.9.9 0 0 1 .429.766V14.1a.9.9 0 0 1-1.8 0v-2.74a.9.9 0 0 1-.807-1.609l1.3-.656a.9.9 0 0 1 .878.037" clip-rule="evenodd" /><path d="M2.005 12c0-3.258 2.642-5.9 5.902-5.9h10.026l-.564-.564a.9.9 0 1 1 1.273-1.272l2.1 2.1a.9.9 0 0 1 0 1.272l-2.1 2.1a.9.9 0 0 1-1.273-1.272l.564-.564H7.907A4.1 4.1 0 0 0 3.805 12v.097a.9.9 0 0 1-1.8 0zM21.104 11.003a.9.9 0 0 1 .9.9V12c0 3.259-2.642 5.9-5.902 5.9H6.074l.564.564a.9.9 0 1 1-1.273 1.272l-2.101-2.1a.9.9 0 0 1 0-1.272l2.1-2.1a.9.9 0 0 1 1.274 1.272l-.564.564h10.029a4.1 4.1 0 0 0 4.101-4.1v-.097a.9.9 0 0 1 .9-.9" /></g></symbol>',24,24,!1,void 0)},14323:(e,_,t)=>{t.d(_,{Icon24RepeatOutline:()=>i});var i=(0,t(844990).makeIcon)("Icon24RepeatOutline","repeat_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="repeat_outline_24"><g fill="currentColor"><path d="M2.005 12c0-3.258 2.642-5.9 5.902-5.9h10.026l-.564-.564a.9.9 0 1 1 1.273-1.272l2.1 2.1a.9.9 0 0 1 0 1.272l-2.1 2.1a.9.9 0 0 1-1.273-1.272l.564-.564H7.907A4.1 4.1 0 0 0 3.805 12v.097a.9.9 0 0 1-1.8 0zM21.104 11.003a.9.9 0 0 1 .9.9V12c0 3.258-2.642 5.9-5.901 5.9H6.074l.564.564a.9.9 0 1 1-1.273 1.272l-2.101-2.1a.9.9 0 0 1 0-1.272l2.1-2.1a.9.9 0 0 1 1.274 1.272l-.564.564h10.029a4.1 4.1 0 0 0 4.101-4.1v-.097a.9.9 0 0 1 .9-.9" /></g></symbol>',24,24,!1,void 0)},677467:(e,_,t)=>{t.d(_,{Icon24ShuffleOutline:()=>i});var i=(0,t(844990).makeIcon)("Icon24ShuffleOutline","shuffle_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="shuffle_outline_24"><g fill="currentColor"><path d="M2.896 6.1a.9.9 0 0 0 0 1.8c2.631 0 4.501 1.612 6.384 3.705-1.007 1.183-1.951 2.278-2.973 3.107C5.23 15.586 4.14 16.1 2.901 16.1a.9.9 0 0 0 0 1.8c1.791 0 3.27-.76 4.54-1.79 1.097-.89 2.094-2.03 3.035-3.133.952 1.11 1.951 2.264 3.049 3.158 1.248 1.017 2.7 1.765 4.475 1.765h.927l-.563.564a.9.9 0 1 0 1.272 1.272l2.1-2.1a.9.9 0 0 0 0-1.272l-2.1-2.1a.9.9 0 1 0-1.272 1.272l.563.564H18c-1.224 0-2.286-.502-3.338-1.36-.997-.812-1.917-1.883-2.92-3.052l-.237-.275C9.396 8.962 6.865 6.1 2.896 6.1" /><path d="M12.318 8.408C13.805 7.16 15.701 6.1 18 6.1h.927l-.563-.564a.9.9 0 1 1 1.272-1.272l2.1 2.1a.9.9 0 0 1 0 1.272l-2.1 2.1a.9.9 0 0 1-1.272-1.272l.563-.564H18c-1.717 0-3.215.787-4.524 1.886a.9.9 0 1 1-1.158-1.378" /></g></symbol>',24,24,!1,void 0)},262203:(e,_,t)=>{t.d(_,{Icon24StarsOutline:()=>i});var i=(0,t(844990).makeIcon)("Icon24StarsOutline","stars_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="stars_outline_24"><g fill="currentColor"><path fill-rule="evenodd" d="M14.005 10.444c-.367.761-.836 1.532-1.432 2.128-.597.597-1.368 1.066-2.129 1.433.761.367 1.532.836 2.129 1.432.596.597 1.064 1.366 1.432 2.126.368-.76.836-1.53 1.433-2.126.596-.596 1.365-1.064 2.125-1.432-.76-.368-1.529-.836-2.125-1.433-.597-.596-1.065-1.367-1.433-2.128m-.946-2.463c-.434 1.28-1.02 2.579-1.76 3.319-.739.74-2.037 1.325-3.317 1.759a22 22 0 0 1-1.449.437l-.247.066c-.381.098-.381.788 0 .886l.247.066a25 25 0 0 1 1.449.437c1.28.434 2.578 1.02 3.318 1.76.74.739 1.325 2.033 1.759 3.31q.078.23.15.458a25 25 0 0 1 .353 1.233c.099.38.787.38.886 0a25 25 0 0 1 .504-1.692c.434-1.276 1.019-2.57 1.758-3.31s2.034-1.325 3.31-1.759q.231-.078.459-.15a25 25 0 0 1 1.233-.353c.381-.099.381-.787 0-.886a26 26 0 0 1-1.691-.503c-1.277-.435-2.571-1.02-3.31-1.76-.74-.739-1.326-2.037-1.76-3.317a25.117 25.117 0 0 1-.503-1.695c-.098-.382-.788-.382-.886 0a25 25 0 0 1-.503 1.694" clip-rule="evenodd" /><path d="M6.426 2.318a.47.47 0 0 0-.892 0l-.52 1.558a1.8 1.8 0 0 1-1.138 1.139l-1.558.52a.47.47 0 0 0 0 .89l1.554.519a1.8 1.8 0 0 1 1.14 1.145l.522 1.584a.47.47 0 0 0 .893 0l.52-1.58a1.8 1.8 0 0 1 1.146-1.147l1.58-.52a.47.47 0 0 0 0-.893l-1.584-.52a1.8 1.8 0 0 1-1.145-1.141z" /></g></symbol>',24,24,!1,void 0)},994492:(e,_,t)=>{t.d(_,{Icon24TextTtOutline:()=>i});var i=(0,t(844990).makeIcon)("Icon24TextTtOutline","text_tt_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="text_tt_outline_24"><g fill="currentColor"><path d="M7.1 6.8h1.8v11.3a.9.9 0 1 1-1.8 0zM2 5.9a.9.9 0 0 1 .9-.9h10.2a.9.9 0 1 1 0 1.8H2.9a.9.9 0 0 1-.9-.9M12 9.9a.9.9 0 0 1 .9-.9h8.2a.9.9 0 1 1 0 1.8h-8.2a.9.9 0 0 1-.9-.9" /><path d="M16.1 10.796h1.8V18.1a.9.9 0 1 1-1.8 0z" /></g></symbol>',24,24,!1,void 0)},346225:(e,_,t)=>{t.d(_,{Icon24ThumbsDown:()=>i});var i=(0,t(844990).makeIcon)("Icon24ThumbsDown","thumbs_down_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" id="thumbs_down_24"><path fill-rule="evenodd" d="M20.105 4a.896.896 0 0 0-.896.896v10.208a.896.896 0 1 0 1.791 0V4.896A.896.896 0 0 0 20.105 4m-3.496 11.818-1.954 4.089A1.922 1.922 0 0 1 11 19.078v-2.784a.294.294 0 0 0-.294-.294H6.002c-2.09 0-3.539-2.082-2.814-4.041l2.221-6A3 3 0 0 1 8.223 4H14a3 3 0 0 1 3 3v7.093a4 4 0 0 1-.39 1.725Z" clip-rule="evenodd" /></symbol>',24,24,!1,void 0)},339414:(e,_,t)=>{t.d(_,{Icon24ThumbsDownOutline:()=>i});var i=(0,t(844990).makeIcon)("Icon24ThumbsDownOutline","thumbs_down_outline_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" id="thumbs_down_outline_24"><path d="M20.1 3a.9.9 0 0 0-.9.9v10.2a.9.9 0 1 0 1.8 0V3.9a.9.9 0 0 0-.9-.9m-7.233 19a2.87 2.87 0 0 0 2.58-1.618l2.064-4.265A4.9 4.9 0 0 0 18 13.983V6.9A3.9 3.9 0 0 0 14.1 3H8.19a3.9 3.9 0 0 0-3.658 2.55l-2.287 6.2c-.94 2.547.945 5.25 3.66 5.25H10v2.133A2.867 2.867 0 0 0 12.867 22m.96-2.402a1.067 1.067 0 0 1-2.027-.465v-2.739c0-.66-.535-1.194-1.194-1.194H5.904a2.1 2.1 0 0 1-1.97-2.827l2.287-6.2A2.1 2.1 0 0 1 8.19 4.8h5.91c1.16 0 2.1.94 2.1 2.1v7.083a3.1 3.1 0 0 1-.31 1.35z" clip-rule="evenodd" /></symbol>',24,24,!1,void 0)},55379:(e,_,t)=>{t.d(_,{default:()=>i});const i={link:"AudioRecomsIconLink__link--osPr3"}},133385:(e,_,t)=>{t.d(_,{default:()=>i});const i={header:"styles__header--LA9ye",content:"styles__content--msthW",actions:"styles__actions--GNLVt"}}}]);try{stManager?.done("dist/web/chunks/058d4485.d5c1fc69.js")}catch(e){}