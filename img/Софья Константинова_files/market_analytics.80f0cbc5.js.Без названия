(()=>{"use strict";var e,t,r,i={667176:(e,t,r)=>{r.d(t,{EMPTY_SCREEN:()=>i});const i="other"},738875:(e,t,r)=>{r.d(t,{FAVE_PRODUCTS_SCREEN:()=>a,FAVE_SCREEN:()=>i});const i="fave",a="fave_products"},172866:(e,t,r)=>{r.d(t,{initMarketAnalytics:()=>f,trackMarketArea:()=>O,trackMarketEvent:()=>b});var i=r(949779),a=r(557139),s=r(738875),o=r(667176),n=r(170722),_=r(436185),c=r(471180),d=r(30259),m=r(801900),u=r(488385),l=r(417120),E=r(736471);const h=[];let I=!1;function T(e,t=0){const r=p(t);return!!r&&e.includes(r.event)}function p(e=0){return h.length>e?h[h.length-(1+e)]:null}function v(e){I||(window.addEventListener("beforeunload",(()=>{(0,u.observersStop)(),(0,l.flushMarketEvents)(e)})),I=!0)}function b(e){if(!function(e){const t=p();if(t){if(e===m.ECommGoodsEvent.CLOSE_ITEM&&t.event===m.ECommGoodsEvent.CLOSE_ITEM)return!1;if(e===m.ECommGoodsEvent.TRANSITION_TO_ITEM){if(T([m.ECommGoodsEvent.TRANSITION_TO_ITEM_LEFT,m.ECommGoodsEvent.TRANSITION_TO_ITEM_RIGHT]))return!1;if(T([m.ECommGoodsEvent.SWITCH_ITEM_VARIANT_1,m.ECommGoodsEvent.SWITCH_ITEM_VARIANT_2]))return!1}}return!0}(e.event))return;if(!e.event&&!e.table)return void(0,a.marketDebug)("error","event and table not specified",e);e.table||(Object.values(m.ECommGoodsEvent).includes(e.event)?e.table=m.AnalyticsEventTable.GOODS:Object.values(m.ECommOrdersEvent).includes(e.event)?e.table=m.AnalyticsEventTable.ORDERS:(0,a.marketDebug)("error","table not specified")),e.screen=e.screen?e.screen:window.MarketAnalyticsManager&&window.MarketAnalyticsManager.getScreen(),e.platform=e.platform?e.platform:"web",e.itemType=e.itemType?e.itemType:"",v(e.platform);const t=String(e.event),r=`${e.table}:${t}`;e.instant?(0,l.logMarketEventNow)(e.platform,r,e.ownerId,e.itemId,e.screen,e.albumId,e.time,e.duration,e.itemType):(0,l.logMarketEvent)(e.platform,r,e.ownerId,e.itemId,e.screen,e.albumId,e.time,e.duration,e.itemType),h.push(e),h.length>3&&h.shift()}function O(e,t=""){v(t),(0,l.flushMarketEvents)(t),(0,u.observersStop)(),(0,a.marketDebug)("warn","analytics: start tracking area",e);const r=({observerId:e,container:r,types:a,refSource:s,screen:d,customItemReachedCallback:u})=>{const l=E.MarketAnalyticsObserver.create({observerId:e,itemSelector:{types:a??"market_item"},isUnifyNodes:!0,isDynamicContent:!0,platform:t,container:r,getExtraItemParams:()=>({ref_source:s})});return l.itemReachedCallback=u??(e=>{t!==i.PLATFORM_MVK?n.viewAnalytics.logMarketItemView({view:{start_view:e.viewStart.toString(),end_view:e.viewEnd.toString()},screen:d||(0,_.getStatScreen)(),previous_screen:(0,c.getScreenPrev)()||o.EMPTY_SCREEN,ref_source:e.ref_source,params:{item_id:Number(e.itemId),owner_id:e.ownerId,search_query_id:e.searchQueryId,item_idx:Number(e.node.getAttribute("data-stat-id"))||0}}):b({event:"market_item"===e.type?m.ECommGoodsEvent.VIEW_ITEM:m.ECommGoodsEvent.VIEW_ALBUM,ownerId:e.ownerId,itemId:"market_item"===e.type?e.itemId:0,duration:e.duration,time:e.viewStart,albumId:"market_item"===e.type?0:e.itemId,platform:e.platform})}),l.watch(),l};switch(e){case m.AnalyticsArea.MARKET:const e=e=>{let r=0;if(void 0!==window.cur.aid&&(r=window.cur.aid),t!==i.PLATFORM_MVK){if("market_item"===e.type)n.viewAnalytics.logMarketItemView({view:{start_view:e.viewStart.toString(),end_view:e.viewEnd.toString()},screen:(0,_.getStatScreen)(),ref_source:e.ref_source,params:{item_id:Number(e.itemId),owner_id:e.ownerId,search_query_id:e.searchQueryId,item_idx:Number(e.node.getAttribute("data-stat-id"))||0}})}else b({event:"market_item"===e.type?m.ECommGoodsEvent.VIEW_ITEM:m.ECommGoodsEvent.VIEW_ALBUM,ownerId:e.ownerId,itemId:"market_item"===e.type?e.itemId:0,albumId:"market_item"===e.type?r:e.itemId,duration:e.duration,time:e.viewStart,platform:e.platform})},a=new URLSearchParams(window.location.search).has("section")?d.RefSource.COMMUNITY_GROUP_GOODS:d.RefSource.COMMUNITY_GOODS;r({observerId:"market_products",refSource:a,customItemReachedCallback:e});const o=r({observerId:"market_albums",types:"market_album",refSource:a,customItemReachedCallback:e});t!==i.PLATFORM_MVK&&(o.preCheckReachedCallback=e=>{const t=e.offsetTop,r=e.parentNode?.parentNode;return r&&t<r.offsetHeight});break;case m.AnalyticsArea.GROUP:r({observerId:"market_module",refSource:d.RefSource.COMMUNITY_SHOWCASE}),r({observerId:"group_wall",types:"market_item,market_album",refSource:d.RefSource.POST});break;case m.AnalyticsArea.USER_PROFILE:r({observerId:"user_wall",types:"market_item,market_album",refSource:d.RefSource.POST});break;case m.AnalyticsArea.BOOKMARKS:const c="product"===window.nav.objLoc.type;r({observerId:"bookmarks",refSource:d.RefSource.BOOKMARKS,screen:c?s.FAVE_PRODUCTS_SCREEN:s.FAVE_SCREEN});break;case m.AnalyticsArea.FEED:r({observerId:"feed",container:".feed_wrap",refSource:d.RefSource.POST});break;case m.AnalyticsArea.GLUBS:r({observerId:"glubs",container:".glubs-container",refSource:d.RefSource.GLUBS})}}function f(e,t,r,i){if(window.MarketAnalyticsManager)try{window.MarketAnalyticsManager.setScreen(e),window.MarketAnalyticsManager.setHash(r),window.MarketAnalyticsManager.setEnabled(i),window.MarketAnalytics.trackArea(t)}catch(e){console.error("cannot init market analytics",e)}else console.error("MarketAnalyticsManager is undefined")}},736471:(e,t,r)=>{r.d(t,{MarketAnalyticsObserver:()=>_});var i=r(557139),a=r(438276),s=r(807638),o=r(581197),n=r(949779);class _ extends s.NodeViewObserver{isReached(e){if(!(0,i.isElementVisible)(e))return!1;let t,r=this.gap;const a=e.closest("[data-stat-viewport]");if(a){const e=a.getBoundingClientRect();r={top:e.top,left:e.left},t={width:e.left+e.width,height:e.top+e.height}}return(0,i.isElementInViewport)(e,45,r,t)}static create(e){return new _(e.observerId,e.itemSelector,e?.container,e?.isUnifyNodes,e?.isDynamicContent,e?.platform,e?.getExtraItemParams)}static getViewportGap(e=""){const t={left:0,top:0};let r="";r=e===n.PLATFORM_MVK?"#vk_head":"#page_header_wrap,#market_search_input";return document.querySelectorAll(r).forEach((e=>{const r=(0,o.getElementSize)(e);t.top=t.top+r.height})),t}constructor(e,t,r="",i=!1,s=!1,o="",n){super(e,t,r,i,o,n),this.observerId=e,this.itemSelector=t,this.container=r,this.isUnifyNodes=i,this.isDynamicNodes=s,this.gap=null,s&&this.addMutators([new a.NodeMutationObserver]),this.gap=_.getViewportGap(this.getPlatform())}}},801900:(e,t,r)=>{var i,a,s,o;r.d(t,{AnalyticsArea:()=>i,AnalyticsEventTable:()=>a,ECommGoodsEvent:()=>s,ECommOrdersEvent:()=>o}),function(e){e.MARKET="market",e.GROUP="group",e.USER_PROFILE="user_profile",e.BOOKMARKS="bookmarks",e.FEED="feed",e.GLUBS="glubs"}(i||(i={})),function(e){e.GOODS="ecomm_goods",e.ORDERS="ecomm_orders"}(a||(a={})),function(e){e.TRANSITION_TO_ITEM="transition_to_item",e.TRANSITION_TO_ALBUM="transition_to_album",e.SWITCH_ITEM_VARIANT_1="switch_item_variant_1",e.SWITCH_ITEM_VARIANT_2="switch_item_variant_2",e.TRANSITION_TO_ITEM_LEFT="transition_to_item_left",e.TRANSITION_TO_ITEM_RIGHT="transition_to_item_right",e.VIEW_ITEM="view_item",e.VIEW_ALBUM="view_album",e.CLOSE_ITEM="close_item",e.TRANSITION_TO_OWNER="transition_to_owner",e.VIEW_ITEM_MEDIA="view_item_media",e.ADD_ITEM_TO_CART="add_item_to_cart",e.EXPAND_ITEM_DESCRIPTION="expand_item_description",e.ADD_ITEM_TO_BOOKMARKS="add_item_to_bookmarks",e.REMOVE_ITEM_FROM_BOOKMARKS="remove_item_from_bookmarks",e.EXPAND_COMMENTS="expand_comments",e.COMMENT="comment",e.OPEN_WIKI="open_wiki",e.SEND_MESSAGE_TO_OWNER="send_message_to_owner",e.SEND_MESSAGE_TO_OWNER_2="send_message_to_owner_2",e.OPEN_CHAT_WITH_OWNER="open_chat_with_owner",e.OPEN_CHAT_WITH_OWNER_2="open_chat_with_owner_2",e.LIKE_ITEM="like_item",e.UNLIKE_ITEM="unlike_item",e.SHARE_ITEM="share_item",e.CTA_LINK="cta_link",e.CTA_LINK_2="cta_link_2",e.CALL="call",e.CALL_2="call_2",e.CREATE_ITEM="create_item",e.CREATE_ALBUM="create_album",e.EDIT_ITEM="edit_item",e.EDIT_ALBUM="edit_album",e.DELETE_ITEM="delete_item",e.DELETE_ALBUM="delete_album",e.GROUP_ITEMS="group_items",e.ADD_PROPERTY="add_property",e.ADD_PROPERTY_VALUE="add_property_value",e.DELETE_PROPERTY="delete_property",e.DELETE_PROPERTY_VALUE="delete_property_value",e.TRANSITION_TO_EDIT_PROPERTIES="transition_to_edit_properties",e.TRANSITION_TO_EDIT_ALBUMS="transition_to_edit_albums",e.TRANSITION_TO_ADD_ALBUM="transition_to_add_album",e.TRANSITION_TO_ADD_ITEM="transition_to_add_item",e.TRANSITION_TO_EDIT_ITEM="transition_to_edit_item",e.TRANSITION_TO_DELETE_ALBUM="transition_to_delete_album",e.TRANSITION_TO_GROUP_ITEMS="transition_to_group_items",e.VIEW_FEEDBACK="view_feedback",e.OPEN_FEEDBACK_PHOTO="open_feedback_photo"}(s||(s={})),function(e){e.EVENT_MAKE_ORDER="make_order",e.CANCEL_ORDER="cancel_order",e.EXPAND_ORDER_INFO="expand_order_info",e.TRANSITION_TO_ORDERS="transition_to_orders",e.OPEN_MARKET_GROUP_ORDERS="open_market_group_orders",e.OPEN_MARKET_GROUP_ITEMS="open_market_group_items",e.OPEN_MARKET_GROUP_SETTINGS="open_market_group_settings",e.OPEN_MARKET_GROUP_DELIVERY="open_market_group_delivery",e.TRANSITION_TO_MARKET_SUPPORT="transition_to_market_support",e.OPEN_ORDER_INFO="open_order_info",e.ADD_TRACK_CODE="add_track_code",e.ADD_INTERNAL_COMMENT="add_internal_comment",e.CHANGE_ORDER_STATUS="change_order_status",e.OPEN_CHAT_WITH_CUSTOMER="open_chat_with_customer",e.SEND_MESSAGE_TO_CUSTOMER="send_message_to_customer",e.OPEN_ORDER_HISTORY="open_order_history",e.FILTER_ORDERS_BY_STATUS="filter_orders_by_status",e.EXPORT_ORDERS_DATA="export_orders_data"}(o||(o={}))},438276:(e,t,r)=>{r.d(t,{NodeMutationObserver:()=>i});class i{connectMutator(e){if(this.mutationObserver)throw new Error(`{Observer #${e.getObserverId()}} MutationObserver already connected to observer`);const t=document.querySelector(e.getContainerQuery());t instanceof HTMLElement&&(this.mutationObserver=new MutationObserver((t=>{t.forEach((t=>{if(t.addedNodes)for(let r=0;r<t.addedNodes.length;r++){const a=t.addedNodes[r];if(a instanceof HTMLElement){const t=i.resolveNodes(a,e).filter((e=>!!e));t&&(t.forEach((t=>{e.add(t)})),e.scan())}}}))})),this.mutationObserver.observe(t,{childList:!0,subtree:!0,attributes:!1,characterData:!1}))}disconnectMutator(e){e.isRunning()&&this.mutationObserver&&this.mutationObserver.disconnect()}static resolveNodes(e,t){let r=[];if(t.getSelectorQuery(!1).split(",").forEach((t=>{if(e.matches(t))return r.push(e),!1})),r.length<1){const i=e.querySelectorAll(t.getSelectorQuery(!1));r=Array.from(i)}return r}}},480071:(e,t,r)=>{r.d(t,{NodeObserver:()=>_});var i=r(740342),a=r(488385),s=r(436185);const o="data-stat-item",n="data-stat-id";class _{set debounceTimeout(e){this._debounceTimeout=e}set itemReachedCallback(e){this._itemReachedCallback=e}set preCheckReachedCallback(e){this._preCheckReachedCallback=e}getObserverId(){return this.observerId}getItemSelector(){return this.itemSelector}getPlatform(){return this.platform}add(e){this.nodes.push(e)}getTrackingItems(){return this.trackingItems}addMutators(e){this.mutatorList=this.mutatorList.concat(e)}isRunning(){return this.isWatching}watch(){this.isWatching||(this.update(),this.startObserving(),this.connectMutators(),this.isWatching=!0)}stop(){this.isWatching&&(this.trackUntracked(),this.stopObserving(),this.disconnectMutators(),this.isWatching=!1)}scan(){this.viewportScanner()}trackUntracked(){const e=this.getTrackingItems();for(let t in e)if(e[t]){const r=e[t];!r.isTracked&&r.isReached&&(this.track(r),this.persist(r))}}connectMutators(){this.mutatorList.forEach((e=>{e.connectMutator(this)}))}disconnectMutators(){this.mutatorList.forEach((e=>{e.disconnectMutator(this)}))}getContainerQuery(){const e=this.container.substr(0,1);if("#"===e||"."===e)return this.container;return`[data-stat-container="${this.container?this.container:this.observerId}"]`}getSelectorQuery(e=!0){const t=this.getContainerQuery();let r=[];return this.itemSelector.selectors?r=this.itemSelector.selectors.split(",").map((r=>e?`${t} ${r}`:r)):this.itemSelector.types&&(r=this.itemSelector.types.split(",").map((r=>e?`${t} [${o}^="${r}|"]`:`[${o}^="${r}|"]`))),r.join(",")}update(){const e=document.querySelectorAll(this.getSelectorQuery());this.nodes=Array.from(e)}static parseStatAttribute(e){const t=e.getAttribute(o),r=t?.split("|");return r?{type:r[0],ownerId:parseInt(r[1]),itemId:r[2]}:{type:"",ownerId:0,itemId:0}}getNodeKey(e,t){let r=String(t.itemId);if(this.isUnifyNodes){this.unifyNode(e);r=`${r}_${e.getAttribute(n)}`}return`${this.observerId}_${r}`}isItemReached(e){return!(void 0!==this._preCheckReachedCallback&&!this._preCheckReachedCallback(e))&&this.isReached(e)}filterItem(e){return!e.isTracked&&!e.isReached&&(this.isItemReached(e.node)?(this.track(e),this.persist(e),!1):(this.persist(e),!0))}track(e){e.isTracked||(e.viewEnd=Date.now(),e.duration=e.viewEnd-e.viewStart,this._itemReachedCallback(e),e.isReached=!1,e.isTracked=!0)}persist(e){this.trackingItems[e.key]=e}getTrackingItem(e){const t=_.parseStatAttribute(e);if(!t.type||!t.itemId)return null;const r=this.getNodeKey(e,t);return r?r in this.trackingItems?this.trackingItems[r]:this.createTrackingItem(e,t):null}createTrackingItem(e,t){const r=this.getNodeKey(e,t),i=this.getExtraItemParams&&this.getExtraItemParams()||{};return this.trackingItems[r]={...i,key:r,type:t.type,observerId:this.observerId,ownerId:t.ownerId,itemId:t.itemId,isTracked:!1,isReached:!1,viewStart:0,viewEnd:0,duration:0,node:e,viewTimer:0,data:{},platform:this.getPlatform(),city:(0,s.getStatCity)(),screen:i.screen||(0,s.getStatScreen)()},this.trackingItems[r]}getNextUnifyId(){return++this.uniqueNodeCounter}unifyNode(e){e.getAttribute(n)||e.setAttribute(n,String(this.getNextUnifyId()))}startObserving(){this.update(),this.viewportScanner=(0,i.debounce)((()=>{this.nodes=this.nodes.filter((e=>{const t=this.getTrackingItem(e);return!!t&&this.filterItem(t)}))}),this._debounceTimeout),this.scrollEventListener=()=>this.scan(),document.addEventListener("scroll",this.scrollEventListener,{passive:!0}),this.scan()}stopObserving(){document.removeEventListener("scroll",this.scrollEventListener),this.nodes=[],this.viewportScanner=()=>{},this.scrollEventListener=()=>{}}constructor(e,t,r="",i=!1,s="",o){if(this.observerId=e,this.itemSelector=t,this.container=r,this.isUnifyNodes=i,this.platform=s,this.getExtraItemParams=o,this.trackingItems={},this._debounceTimeout=20,this.uniqueNodeCounter=0,this.nodes=[],this.isWatching=!1,this.mutatorList=[],(0,a.observersRegister)(this),!this.itemSelector.types&&!this.itemSelector.selectors)throw new Error("Empty itemSelector definition");this.container||(this.container=this.observerId)}}},807638:(e,t,r)=>{r.d(t,{NodeViewObserver:()=>a});var i=r(480071);class a extends i.NodeObserver{filterItem(e){return!e.isTracked&&(e.isReached&&!this.isItemReached(e.node)?(this.track(e),this.persist(e),!1):(this.isItemReached(e.node)&&this.view(e),this.persist(e),!0))}view(e){e.isTracked||(e.isReached=!0,e.viewStart||(e.viewStart=Date.now()),e.viewTimer&&(clearTimeout(e.viewTimer),e.viewTimer=0),e.viewTimer=window.setTimeout((()=>{const t=e.node;!this.isItemReached(t)||function(e){const t=e.viewStart;return Date.now()-t>3e4}(e)?this.track(e):this.view(e)}),3e3))}track(e){e.viewTimer&&(clearTimeout(e.viewTimer),e.viewTimer=0),super.track(e)}}},488385:(e,t,r)=>{r.d(t,{observersRegister:()=>a,observersRescan:()=>o,observersStop:()=>s});const i={};function a(e){e.getObserverId()in i&&(i[e.getObserverId()].stop(),delete i[e.getObserverId()]),i[e.getObserverId()]=e}function s(){for(let e in i)if(i[e]){i[e].stop()}}function o(){for(let e in i)if(i[e]){i[e].scan()}}},135874:(e,t,r)=>{var i=r(636576),a=r(172866),s=r(417120),o=r(801900),n=r(170722),_=r(436185);window.vk?.stDomain&&(r.p=window.vk.stDomain+"/dist/");const c={trackArea:a.trackMarketArea,onMarketAlbumEdit:(e,t,r)=>{(0,a.trackMarketEvent)({table:o.AnalyticsEventTable.GOODS,event:r?o.ECommGoodsEvent.CREATE_ALBUM:o.ECommGoodsEvent.EDIT_ALBUM,ownerId:e,albumId:t,instant:!0})},setStorageData:s.setStorageData,logViewItemEvent:e=>{n.viewAnalytics.logMarketItemView({view:{start_view:"0",end_view:"0"},screen:(0,_.getStatScreen)(),ref_source:e.refSource,params:{item_id:e.itemId,owner_id:e.ownerId,item_idx:0,search_query_id:0}})},onMarketItemCardOpen:s.onMarketItemCardOpen};window.MarketAnalytics=c,requestIdleCallback((()=>{try{(0,i.statlogsValueEvent)("entries_requests",1,"market_analytics","web")}catch{}}),{timeout:5e3});try{stManager?.done(partConfigEnabled("web_static_manager_done_with_hash")?"dist/web/market_analytics.80f0cbc5.js":"dist/web/market_analytics.js")}catch(e){}}},a={};function __webpack_require__(e){var t=a[e];if(void 0!==t)return t.exports;var r=a[e]={exports:{}};return i[e].call(r.exports,r,r.exports,__webpack_require__),r.exports}__webpack_require__.m=i,e=[],__webpack_require__.O=(t,r,i,a)=>{if(!r){var s=1/0;for(c=0;c<e.length;c++){for(var[r,i,a]=e[c],o=!0,n=0;n<r.length;n++)(!1&a||s>=a)&&Object.keys(__webpack_require__.O).every((e=>__webpack_require__.O[e](r[n])))?r.splice(n--,1):(o=!1,a<s&&(s=a));if(o){e.splice(c--,1);var _=i();void 0!==_&&(t=_)}}return t}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[r,i,a]},__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},r=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,__webpack_require__.t=function(e,i){if(1&i&&(e=this(e)),8&i)return e;if("object"==typeof e&&e){if(4&i&&e.__esModule)return e;if(16&i&&"function"==typeof e.then)return e}var a=Object.create(null);__webpack_require__.r(a);var s={};t=t||[null,r({}),r([]),r(r)];for(var o=2&i&&e;"object"==typeof o&&!~t.indexOf(o);o=r(o))Object.getOwnPropertyNames(o).forEach((t=>s[t]=()=>e[t]));return s.default=()=>e,__webpack_require__.d(a,s),a},__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.e=()=>Promise.resolve(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.p="/dist/",(()=>{var e={11999:0};__webpack_require__.O.j=t=>0===e[t];var t=(t,r)=>{var i,a,[s,o,n]=r,_=0;if(s.some((t=>0!==e[t]))){for(i in o)__webpack_require__.o(o,i)&&(__webpack_require__.m[i]=o[i]);if(n)var c=n(__webpack_require__)}for(t&&t(r);_<s.length;_++)a=s[_],__webpack_require__.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return __webpack_require__.O(c)},r=self.webpackChunkvkweb=self.webpackChunkvkweb||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var s=__webpack_require__.O(void 0,[81765,23592],(()=>__webpack_require__(135874)));s=__webpack_require__.O(s)})();